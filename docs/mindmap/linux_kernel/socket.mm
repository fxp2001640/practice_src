<map version="0.9.0">
<!-- To view this file, download free mind mapping software FreeMind from http://freemind.sourceforge.net -->
<node CREATED="1301304353495" ID="ID_1039181564" MODIFIED="1447371233421" TEXT="socket">
<node CREATED="1301304513162" ID="ID_1760302583" MODIFIED="1359869996172" POSITION="right" TEXT="&#x6570;&#x636e;&#x7ed3;&#x6784;">
<node CREATED="1301304541500" FOLDED="true" ID="ID_787241903" MODIFIED="1447109351964" TEXT="struct socket">
<node CREATED="1301304569927" ID="ID_602936701" MODIFIED="1301304580745" TEXT="socket_state state"/>
<node CREATED="1301304594642" ID="ID_1774604564" MODIFIED="1301304599659" TEXT="type"/>
<node CREATED="1301304604083" ID="ID_1285204779" MODIFIED="1301304607373" TEXT="flags"/>
<node CREATED="1301304623149" ID="ID_129072438" MODIFIED="1301304631352" TEXT="struct fasync_struct *fasync_list"/>
<node CREATED="1301304646071" ID="ID_752985396" MODIFIED="1301304653651" TEXT="wait_queue_head_t wait"/>
<node CREATED="1301304673009" ID="ID_887090179" MODIFIED="1301304679674" TEXT="struct file *file"/>
<node CREATED="1301304693539" FOLDED="true" ID="ID_274261820" MODIFIED="1359870011508" TEXT="struct sock *sk">
<node CREATED="1301304840050" FOLDED="true" ID="ID_1710576249" MODIFIED="1301305051337" TEXT="struct sock_common sk_common">
<node CREATED="1301304892824" ID="ID_1378435369" MODIFIED="1301304899966" TEXT="struct hlist_node skc_node"/>
<node CREATED="1301304913569" ID="ID_1687496353" MODIFIED="1301304915977" TEXT="skc_refcnt"/>
<node CREATED="1301304926803" ID="ID_247574287" MODIFIED="1301304929101" TEXT="skc_hash"/>
<node CREATED="1301304940644" ID="ID_732910561" MODIFIED="1301304942998" TEXT="skc_family"/>
<node CREATED="1301304952413" ID="ID_1704958821" MODIFIED="1301304954089" TEXT="skc_state"/>
<node CREATED="1301304966519" ID="ID_1431661703" MODIFIED="1301304968293" TEXT="skc_reuse"/>
<node CREATED="1301304979944" ID="ID_1041369237" MODIFIED="1301304981942" TEXT="skc_bound_dev_if"/>
<node CREATED="1301305001178" ID="ID_382110928" MODIFIED="1301305007412" TEXT="struct hlist_node skc_bind_node"/>
<node CREATED="1301305024212" ID="ID_1015695885" MODIFIED="1301305031034" TEXT="struct proto *skc_prot"/>
<node CREATED="1301305042198" ID="ID_319066083" MODIFIED="1301305049362" TEXT="struct net *skc_net"/>
</node>
<node CREATED="1301305096548" ID="ID_1843779224" MODIFIED="1301305100131" TEXT="flags"/>
<node CREATED="1301305112773" ID="ID_1204710029" MODIFIED="1301305115133" TEXT="sk_protocol"/>
<node CREATED="1301305126583" ID="ID_23798007" MODIFIED="1301305129100" TEXT="sk_type"/>
<node CREATED="1301305139616" ID="ID_1333849877" MODIFIED="1301305142193" TEXT="sk_rcvbuf"/>
<node CREATED="1301305152161" ID="ID_396505758" MODIFIED="1301305154596" TEXT="sk_lock"/>
<node CREATED="1301305168667" ID="ID_218315006" MODIFIED="1301305171152" TEXT="sk_backlog"/>
<node CREATED="1301305196061" ID="ID_1335207860" MODIFIED="1301305203484" TEXT="wait_queue_head_t *sk_sleep"/>
<node CREATED="1301305215783" ID="ID_1207596090" MODIFIED="1301305221822" TEXT="struct dst_entry *sk_dst_cache"/>
<node CREATED="1301305262324" ID="ID_1390416779" MODIFIED="1301305268581" TEXT="struct xfrm_policy *sk_policy[2]"/>
<node CREATED="1301305283502" ID="ID_1044695300" MODIFIED="1301305286097" TEXT="sk_dst_lock"/>
<node CREATED="1301305300616" ID="ID_1968490973" MODIFIED="1301305302986" TEXT="sk_rmem_alloc"/>
<node CREATED="1301305311745" ID="ID_1929401358" MODIFIED="1301305313979" TEXT="sk_wmem_alloc"/>
<node CREATED="1301305322914" ID="ID_914674499" MODIFIED="1301305325365" TEXT="sk_omem_alloc"/>
<node CREATED="1301305335635" ID="ID_1240392309" MODIFIED="1301305338062" TEXT="sk_sndbuf"/>
<node CREATED="1301305352613" ID="ID_1089600133" MODIFIED="1301305359728" TEXT="struct sk_buff_head sk_receive_queue"/>
<node CREATED="1301305374103" ID="ID_1065062780" MODIFIED="1301305380816" TEXT="struct sk_buff_head sk_write_queue"/>
<node CREATED="1301305394297" ID="ID_718416998" MODIFIED="1301305416218" TEXT="struct sk_buff_head sk_async_wait_queue"/>
<node CREATED="1301305458352" ID="ID_779918258" MODIFIED="1301305891205" TEXT="sk_wmem_queued&#xa;sk_forward_alloc&#xa;sk_allocation;&#xa;sk_route_caps&#xa;sk_gso_type&#xa;sk_gso_max_size&#xa;sk_rcvlowat&#xa;sk_flags&#xa;sk_lingertime&#xa;struct sk_buff_head sk_error_queue&#xa;struct proto *sk_prot_creator&#xa;sk_callback_lock&#xa;sk_err&#x9;&#xa;sk_err_soft&#xa;sk_drops&#xa;sk_ack_backlog&#xa;sk_max_ack_backlog&#xa;sk_priority&#xa;struct ucred sk_peercred&#xa;sk_rcvtimeo&#xa;sk_sndtimeo&#xa;struct sk_filter *sk_filter&#xa;void *sk_protinfo; &#x9;&#xa;struct timer_list sk_timer&#xa;sk_stamp&#xa;struct socket&#x9;*sk_socket&#xa;void *sk_user_data&#xa;struct page *sk_sndmsg_page&#xa;struct sk_buff&#x9; *sk_send_head&#xa;sk_sndmsg_off&#xa;sk_write_pending&#xa;void *sk_security&#xa;sk_mark"/>
<node CREATED="1301305921790" ID="ID_1508760782" MODIFIED="1301306078272">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      void (*sk_state_change)(struct sock *sk)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1301305941648" ID="ID_385421882" MODIFIED="1301306071671">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      void (*sk_data_ready)(struct sock *sk, int bytes)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1301305956769" ID="ID_1348161765" MODIFIED="1301306063542">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      void (*sk_write_space)(struct sock *sk)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1301305971611" ID="ID_191472535" MODIFIED="1301306055566">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      void (*sk_error_report)(struct sock *sk)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1301305989964" ID="ID_1157471560" MODIFIED="1301306046834">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      int (*sk_backlog_rcv)(struct sock *sk, struct sk_buff *skb)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1301306006582" ID="ID_248439975" MODIFIED="1301306021984" TEXT="void (*sk_destruct)(struct sock *sk)"/>
</node>
<node CREATED="1301304717278" ID="ID_959004246" MODIFIED="1301304721326" TEXT="struct proto_ops&#x9;*ops"/>
</node>
<node CREATED="1321717544484" FOLDED="true" ID="ID_472883275" MODIFIED="1321718411722" TEXT="struct proto&#xa;include/net/sock.h">
<node CREATED="1321717584038" ID="ID_800203038" MODIFIED="1321717682728" TEXT="close&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717601475" ID="ID_453651116" MODIFIED="1321717678159" TEXT="connect&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717618096" ID="ID_470263692" MODIFIED="1321717673304" TEXT="disconnect&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717632058" ID="ID_1717827178" MODIFIED="1321717667875" TEXT="accept&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_265767880" MODIFIED="1321717661758" TEXT="ioctl&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_930189997" MODIFIED="1321717722763" TEXT="init&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_941247502" MODIFIED="1321717736568" TEXT="destroy&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_16945523" MODIFIED="1321717749544" TEXT="shutdown&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_648274115" MODIFIED="1321717762573" TEXT="setsockopt&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_1993532657" MODIFIED="1321717775533" TEXT="getsockopt&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_1080390418" MODIFIED="1321717789027" TEXT="compat_setsockopt&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_1389935420" MODIFIED="1321717802581" TEXT="compat_getsockopt&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_1258602980" MODIFIED="1321717818758" TEXT="sendmsg&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_1186175885" MODIFIED="1321717832160" TEXT="recvmsg&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_421217752" MODIFIED="1321717845912" TEXT="sendpage&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_711477973" MODIFIED="1321717860316" TEXT="bind&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_575539017" MODIFIED="1321717872223" TEXT="backlog_rcv&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_1497209990" MODIFIED="1321717895555" TEXT="hash&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_870017608" MODIFIED="1321717909079" TEXT="unhash&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_1143190693" MODIFIED="1321717922154" TEXT="get_port&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717646258" ID="ID_1186415331" MODIFIED="1321717938531" TEXT="inuse_idx"/>
<node CREATED="1321717646258" ID="ID_262861822" MODIFIED="1321717974283" TEXT="enter_memory_pressure&#x51fd;&#x6570;&#x6307;&#x9488;"/>
<node CREATED="1321717985256" ID="ID_1976681045" MODIFIED="1321717987641" TEXT="memory_allocated"/>
<node CREATED="1321717996720" ID="ID_1618613220" MODIFIED="1321717998224" TEXT="sockets_allocated"/>
<node CREATED="1321718010314" ID="ID_265206364" MODIFIED="1321718011915" TEXT="memory_pressure"/>
<node CREATED="1321718022538" ID="ID_1271674204" MODIFIED="1321718023469" TEXT="sysctl_mem"/>
<node CREATED="1321718032401" ID="ID_1581932907" MODIFIED="1321718033290" TEXT="sysctl_wmem"/>
<node CREATED="1321718043179" ID="ID_1944952352" MODIFIED="1321718044216" TEXT="sysctl_rmem"/>
<node CREATED="1321718053235" ID="ID_1076646800" MODIFIED="1321718054983" TEXT="max_header"/>
<node CREATED="1321718066580" ID="ID_1176670483" MODIFIED="1321718151609" TEXT="slab &#xff1a;&#x7528;&#x4e8e;&#x4e3a;&#x6bcf;&#x4e2a;socket&#x5206;&#x914d;struct sock&#x7ed3;&#x6784;&#x7684;&#x7f13;&#x5b58;&#x6c60;"/>
<node CREATED="1321718173324" ID="ID_1390122147" MODIFIED="1321718175408" TEXT="obj_size"/>
<node CREATED="1321718184764" ID="ID_967664813" MODIFIED="1321718186164" TEXT="slab_flags"/>
<node CREATED="1321718195884" ID="ID_721901878" MODIFIED="1321718197996" TEXT="orphan_count"/>
<node CREATED="1321718211962" ID="ID_70528106" MODIFIED="1321718219196" TEXT="struct request_sock_ops *rsk_prot"/>
<node CREATED="1321718229346" ID="ID_594073977" MODIFIED="1321718232025" TEXT="struct timewait_sock_ops *twsk_prot"/>
<node CREATED="1321718258836" FOLDED="true" ID="ID_478628425" MODIFIED="1359869954906" TEXT="&#x5171;&#x540c;&#x4f53; h">
<node CREATED="1321718281687" ID="ID_247318124" MODIFIED="1321718288589" TEXT="struct inet_hashinfo *hashinfo"/>
<node CREATED="1321718312378" ID="ID_1479031854" MODIFIED="1321718319089" TEXT="struct udp_table *udp_table"/>
<node CREATED="1321718331307" ID="ID_662971332" MODIFIED="1321718336782" TEXT="struct raw_hashinfo *raw_hash"/>
</node>
<node CREATED="1321718351653" ID="ID_1768925319" MODIFIED="1321718354027" TEXT="owner"/>
<node CREATED="1321718377113" ID="ID_846001718" MODIFIED="1321718379935" TEXT="name"/>
<node CREATED="1321718389239" ID="ID_1884270972" MODIFIED="1321718392055" TEXT="node"/>
<node CREATED="1321718399373" ID="ID_1673577831" MODIFIED="1321718400609" TEXT="socks"/>
</node>
</node>
<node CREATED="1301306386444" FOLDED="true" ID="ID_1789105370" MODIFIED="1447109334864" POSITION="left" TEXT="pppoe">
<node CREATED="1301306394317" FOLDED="true" ID="ID_4291155" MODIFIED="1447109333753" TEXT="&#x6570;&#x636e;&#x7ed3;&#x6784;">
<node CREATED="1301306475413" FOLDED="true" ID="ID_1748637046" MODIFIED="1301306646118" TEXT="struct pppoe_net">
<node CREATED="1301306499999" FOLDED="true" ID="ID_801859829" MODIFIED="1301306644694" TEXT="struct pppox_sock *hash_table">
<node CREATED="1301306540019" ID="ID_1046993678" MODIFIED="1301306563533">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct sock&#160;sk
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1301306576823" ID="ID_414401799" MODIFIED="1301306582724" TEXT="struct ppp_channel chan"/>
<node CREATED="1301306594729" ID="ID_210392065" MODIFIED="1301306599291" TEXT="next"/>
<node CREATED="1301306618915" ID="ID_430392287" MODIFIED="1301306621254" TEXT="struct pppoe_opt pppoe"/>
<node CREATED="1301306626124" ID="ID_1700429834" MODIFIED="1301306628775" TEXT="num"/>
</node>
<node CREATED="1301306515897" ID="ID_295613511" MODIFIED="1301306518248" TEXT="hash_lock"/>
</node>
</node>
<node CREATED="1301306410286" ID="ID_356548851" MODIFIED="1301306420154" TEXT="&#x5168;&#x5c40;&#x53d8;&#x91cf;"/>
</node>
<node CREATED="1321714248950" ID="ID_1022985528" MODIFIED="1447373213540" POSITION="left" TEXT="socket&#x5b9e;&#x4f8b;">
<node CREATED="1321714268614" FOLDED="true" ID="ID_204221327" MODIFIED="1333181577778" TEXT="family = PF_ISDN">
<node CREATED="1321714293857" FOLDED="true" ID="ID_1270902414" MODIFIED="1321715210358" TEXT="&#x521d;&#x59cb;&#x5316;">
<node CREATED="1321714305672" FOLDED="true" ID="ID_160029605" MODIFIED="1321715210357" TEXT="misdn_sock_init">
<node CREATED="1321714325425" ID="ID_197901531" MODIFIED="1321714327754" TEXT="sock_register(&amp;mISDN_sock_family_ops)"/>
</node>
</node>
<node CREATED="1321714332609" FOLDED="true" ID="ID_1525988937" MODIFIED="1321715210358" TEXT="&#x5168;&#x5c40;&#x53d8;&#x91cf;">
<node CREATED="1321714359125" FOLDED="true" ID="ID_522137808" MODIFIED="1321715210358" TEXT="struct net_proto_family mISDN_sock_family_ops">
<node CREATED="1321714388629" ID="ID_831240771" MODIFIED="1321714390277" TEXT=".create = mISDN_sock_create"/>
</node>
</node>
<node CREATED="1321714585477" FOLDED="true" ID="ID_123932689" MODIFIED="1359869954908" TEXT="type = SOCK_RAW">
<node CREATED="1321714615322" ID="ID_159363498" MODIFIED="1321714623045" TEXT="protocol = ISDN_P_BASE"/>
</node>
<node CREATED="1321714644808" FOLDED="true" ID="ID_1423407914" MODIFIED="1359869954908" TEXT="type = SOCK_DGRAM">
<node CREATED="1321714671211" ID="ID_1858342305" MODIFIED="1321714680559" TEXT="protocol = ISDN_P_TE_S0"/>
<node CREATED="1321714671211" ID="ID_1621380770" MODIFIED="1321714710621" TEXT="protocol = ISDN_P_NT_S0"/>
<node CREATED="1321714671211" ID="ID_188180697" MODIFIED="1321714726332" TEXT="protocol = ISDN_P_TE_E1"/>
<node CREATED="1321714671211" ID="ID_1331191826" MODIFIED="1321714741622" TEXT="protocol = ISDN_P_NT_E1"/>
<node CREATED="1321714671211" ID="ID_464123138" MODIFIED="1321714753307" TEXT="protocol = ISDN_P_LAPD_TE"/>
<node CREATED="1321714671211" ID="ID_461077567" MODIFIED="1321714769553" TEXT="protocol = ISDN_P_LAPD_NT"/>
<node CREATED="1321714671211" ID="ID_39739129" MODIFIED="1321714784804" TEXT="protocol = ISDN_P_B_RAW"/>
<node CREATED="1321714671211" ID="ID_452214451" MODIFIED="1321714798992" TEXT="protocol = ISDN_P_B_HDLC"/>
<node CREATED="1321714671211" ID="ID_1676021410" MODIFIED="1321714812938" TEXT="protocol = ISDN_P_B_X75SLP"/>
<node CREATED="1321714671211" ID="ID_377672487" MODIFIED="1321714831890" TEXT="protocol = ISDN_P_B_L2DTMF"/>
<node CREATED="1321714671211" ID="ID_1770727133" MODIFIED="1321714862555" TEXT="protocol = ISDN_P_B_L2DSP"/>
<node CREATED="1321714671211" ID="ID_1489637470" MODIFIED="1321714874920" TEXT="protocol = ISDN_P_B_L2DSPHDLC"/>
</node>
</node>
<node CREATED="1321715462705" FOLDED="true" ID="ID_87031507" MODIFIED="1359869991367" TEXT="family = PF_INET">
<node CREATED="1321715502491" FOLDED="true" ID="ID_1032202050" MODIFIED="1359869990278" TEXT="&#x521d;&#x59cb;&#x5316;">
<node CREATED="1321715510045" ID="ID_1519064078" MODIFIED="1321715513153" TEXT="inet_init"/>
</node>
<node CREATED="1321715559299" FOLDED="true" ID="ID_1005550539" MODIFIED="1359869954908" TEXT="&#x5168;&#x5c40;&#x53d8;&#x91cf;">
<node CREATED="1321715567088" FOLDED="true" ID="ID_586685779" MODIFIED="1359869954908" TEXT="struct net_proto_family inet_family_ops">
<node CREATED="1321715583227" FOLDED="true" ID="ID_137056227" MODIFIED="1359869954908" TEXT=".create = inet_create">
<node CREATED="1321716484539" ID="ID_1533614275" MODIFIED="1321716522473" TEXT="1, &#x5c06;socket&#x7684;&#x72b6;&#x6001;&#x8bbe;&#x4e3a;&#x672a;&#x8fde;&#x63a5;&#xa;(sock-&gt;state = SS_UNCONNECTED)"/>
<node CREATED="1321716573375" ID="ID_1818299764" MODIFIED="1321716699476" TEXT="2, &#x5728;&#x5168;&#x5c40;&#x53d8;&#x91cf;inetsw&#x4e2d;&#x67e5;&#x627e;&#x6b64;socket&#x5bf9;&#x5e94;&#x7684;type&#x548c;protocol&#xa;&#x6ce8;&#x610f;IPPROTO_IP&#x4ee3;&#x8868;&#x4efb;&#x610f;&#x7684;xxx"/>
<node CREATED="1321716720123" ID="ID_1459766217" MODIFIED="1321716771922" TEXT="3, &#x5982;&#x679c;&#x672a;&#x627e;&#x5230;&#x5219;&#x5c1d;&#x8bd5;&#x52a0;&#x8f7d;&#x76f8;&#x5e94;family,type,protocol&#x5bf9;&#x5e94;&#x7684;&#x5185;&#x6838;&#x6a21;&#x5757;"/>
<node CREATED="1321716839721" ID="ID_957293859" MODIFIED="1321716867409" TEXT="4, &#x68c0;&#x67e5;&#x7528;&#x6237;&#x662f;&#x5426;&#x6709;&#x6743;&#x9650;&#x521b;&#x5efa;&#x6b64;&#x79cd;socket"/>
<node CREATED="1321716974481" ID="ID_889321889" MODIFIED="1321716978538" TEXT="5, inet_netns_ok"/>
<node CREATED="1321717066007" ID="ID_1409227250" MODIFIED="1321717107486" TEXT="6, &#x5c06;socket&#x7684;ops&#x6307;&#x5411;&#x6240;&#x627e;&#x5230;&#x7684;&#x534f;&#x8bae;&#x7684;ops"/>
<node CREATED="1321718491733" FOLDED="true" ID="ID_1276563858" MODIFIED="1359869954908" TEXT="7, &#x8c03;&#x7528;sk_alloc&#x4e3a;socket&#x5206;&#x914d;struct sock&#x7ed3;&#x6784;&#xff0c;&#xa;    &#x5e76;&#x521d;&#x59cb;&#x5316;struct sock&#x7ed3;&#x6784;">
<node CREATED="1321718853754" ID="ID_1989003409" MODIFIED="1321718857581" TEXT="sk-&gt;sk_family = family"/>
<node CREATED="1321718870556" ID="ID_1722965251" MODIFIED="1321718896315" TEXT="sk-&gt;sk_prot = sk-&gt;sk_prot_creator = &#x6240;&#x627e;&#x5230;&#x7684;&#x534f;&#x8bae;"/>
<node CREATED="1321718918363" ID="ID_1564172112" MODIFIED="1321718920181" TEXT="sk-&gt;sk_net = net"/>
</node>
</node>
</node>
<node CREATED="1321716028934" ID="ID_13528575" MODIFIED="1321716386102" TEXT="struct list_head inetsw&#xa;&#x6b64;&#x53d8;&#x91cf;&#x7531;&#x5404;&#x534f;&#x8bae;&#x6a21;&#x5757;&#x8c03;&#x7528;&#xa;inet_register_protosw&#x6ce8;&#x518c;&#x5f62;&#x6210;"/>
</node>
<node CREATED="1321716144884" FOLDED="true" ID="ID_1637055350" MODIFIED="1359869954908" TEXT="&#x6570;&#x636e;&#x7ed3;&#x6784;">
<node CREATED="1321716151779" FOLDED="true" ID="ID_1666835336" MODIFIED="1359869954908" TEXT="struct inet_protosw">
<node CREATED="1321716172375" ID="ID_1933903034" MODIFIED="1321716174855" TEXT="list"/>
<node CREATED="1321716185435" ID="ID_396467709" MODIFIED="1321716208461" TEXT="type &#xff1a;socket&#x7684;&#x7c7b;&#x578b;"/>
<node CREATED="1321716219144" ID="ID_531227378" MODIFIED="1321716233076" TEXT="protocol &#xff1a;socket&#x6240;&#x5c5e;&#x534f;&#x8bae;"/>
<node CREATED="1321716246548" ID="ID_660828200" MODIFIED="1321716267755" TEXT="struct proto *prot"/>
<node CREATED="1321716284526" ID="ID_1485750992" MODIFIED="1321716286716" TEXT="struct proto_ops *ops"/>
<node CREATED="1321716303352" ID="ID_204495260" MODIFIED="1321716304503" TEXT="capability"/>
<node CREATED="1321716317579" ID="ID_1221113671" MODIFIED="1321716318831" TEXT="no_check"/>
<node CREATED="1321716329111" ID="ID_1335456009" MODIFIED="1321716331582" TEXT="flags"/>
</node>
</node>
</node>
<node CREATED="1333181307683" FOLDED="true" ID="ID_793131948" MODIFIED="1447373523628" TEXT="family = PF_NETLINK">
<node CREATED="1321714585477" ID="ID_182179662" MODIFIED="1333181552414" TEXT="type = SOCK_RAW"/>
<node CREATED="1321714644808" FOLDED="true" ID="ID_32120592" MODIFIED="1447373520188" TEXT="type = SOCK_DGRAM">
<node CREATED="1321714671211" FOLDED="true" ID="ID_554826509" MODIFIED="1447373515852" TEXT="protocol = NETLINK_ROUTE">
<node CREATED="1333266006210" FOLDED="true" ID="ID_716240912" MODIFIED="1447373496499" TEXT="rtnetlink_rcv">
<node CREATED="1333266016985" FOLDED="true" ID="ID_344238324" MODIFIED="1447373495188" TEXT="rtnetlink_rcv_msg">
<node CREATED="1333268600086" ID="ID_124962040" MODIFIED="1333268602788" TEXT="struct net *net = sock_net(skb-&gt;sk)"/>
<node CREATED="1333267795650" ID="ID_1116519245" MODIFIED="1333267846860" TEXT="&#x83b7;&#x53d6;family = struct rtgenmsg.rtgen_family"/>
<node CREATED="1333267849685" ID="ID_1611360666" MODIFIED="1333267878188" TEXT="&#x83b7;&#x53d6;type = struct nlmsghdr.nlmsg_type"/>
<node CREATED="1333267906052" ID="ID_515708581" MODIFIED="1333267977232" TEXT="&#x5c06;&#x5404;&#x4e2a;&#x5c5e;&#x6027;struct rtattr&#x7684;&#x6307;&#x9488;&#x586b;&#x5145;&#x5230;&#x5168;&#x5c40;&#x53d8;&#x91cf;struct rtattr **rta_buf&#x4e2d;"/>
<node CREATED="1333268066315" FOLDED="true" ID="ID_1823960482" MODIFIED="1333268621135" TEXT="&#x67e5;&#x627e;&#x5168;&#x5c40;&#x53d8;&#x91cf;struct rtnl_link rtnl_msg_handlers[family][type]&#x627e;&#x51fa;&#xa;(family, type)&#x5bf9;&#x5e94;&#x7684;&#x5904;&#x7406;&#x51fd;&#x6570;,&#x5e76;&#x8c03;&#x7528;&#x5b83;">
<node CREATED="1333268431404" ID="ID_1131980018" MODIFIED="1333268491963" TEXT="&#x5404;&#x5b50;&#x6a21;&#x5757;&#x53ef;&#x901a;&#x8fc7;&#x4ee5;&#x4e0b;API&#x6ce8;&#x518c;&#x5904;&#x7406;&#x51fd;&#x6570;&#xa;void rtnl_register(int protocol, int msgtype,&#xa;                            rtnl_doit_func doit, rtnl_dumpit_func dumpit)"/>
</node>
</node>
</node>
<node CREATED="1333269355933" FOLDED="true" ID="ID_378873029" MODIFIED="1447373500195" TEXT="rtnl_notify">
<node CREATED="1333269524728" FOLDED="true" ID="ID_464745196" MODIFIED="1447373499355" TEXT="nlmsg_notify">
<node CREATED="1333269549258" ID="ID_1835098952" LINK="#ID_785851494" MODIFIED="1333269557542" TEXT="nlmsg_unicast"/>
</node>
</node>
<node CREATED="1333269384388" FOLDED="true" ID="ID_190654028" MODIFIED="1447373503891" TEXT="rtnl_unicast">
<node CREATED="1333269490177" FOLDED="true" ID="ID_785851494" MODIFIED="1447373503204" TEXT="nlmsg_unicast">
<node CREATED="1333269506037" ID="ID_1629643041" MODIFIED="1333269508027" TEXT="netlink_unicast"/>
</node>
</node>
<node CREATED="1333266101434" FOLDED="true" ID="ID_1730070858" MODIFIED="1447373514947" TEXT="&#x6d88;&#x606f;&#x683c;&#x5f0f;">
<node CREATED="1333188839175" FOLDED="true" ID="ID_944212100" MODIFIED="1359869954912" TEXT="struct nlmsghdr">
<node CREATED="1333188863307" ID="ID_1907023535" MODIFIED="1333188990472" TEXT="__u32 nlmsg_len : &#x5305;&#x542b;&#x672c;&#x5934;&#x90e8;&#x7684;&#x6d88;&#x606f;&#x957f;&#x5ea6;"/>
<node CREATED="1333188863307" FOLDED="true" ID="ID_1263938969" MODIFIED="1333267612142" TEXT="__u16 nlmsg_type : &#x6d88;&#x606f;&#x7c7b;&#x578b;, netlink&#x6838;&#x5fc3;&#x4e0d;&#x89e3;&#x91ca;&#x6b64;&#x503c;">
<node CREATED="1333266182365" ID="ID_1743021419" MODIFIED="1333266184950" TEXT="RTM_BASE"/>
<node CREATED="1333266196706" ID="ID_1456386408" MODIFIED="1333266198454" TEXT="RTM_NEWLINK"/>
<node CREATED="1333266205951" ID="ID_310791413" MODIFIED="1333266207751" TEXT="RTM_DELLINK"/>
<node CREATED="1333266215309" ID="ID_1186965457" MODIFIED="1333266217134" TEXT="RTM_GETLINK"/>
<node CREATED="1333266224262" ID="ID_1669486817" MODIFIED="1333266226270" TEXT="RTM_SETLINK"/>
<node CREATED="1333266275433" ID="ID_318743001" MODIFIED="1333266277177" TEXT="RTM_NEWADDR"/>
<node CREATED="1333266285565" ID="ID_621091318" MODIFIED="1333266286345" TEXT="RTM_DELADDR"/>
<node CREATED="1333266293494" ID="ID_1954439067" MODIFIED="1333266294969" TEXT="RTM_GETADDR"/>
<node CREATED="1333267494072" ID="ID_1602413395" MODIFIED="1333267496095" TEXT="RTM_NEWROUTE"/>
<node CREATED="1333267502306" ID="ID_69057170" MODIFIED="1333267506446" TEXT="RTM_DELROUTE"/>
<node CREATED="1333267510329" ID="ID_864561303" MODIFIED="1333267512216" TEXT="RTM_GETROUTE"/>
<node CREATED="1333267519179" ID="ID_1265842308" MODIFIED="1333267519922" TEXT="RTM_NEWNEIGH"/>
<node CREATED="1333267525958" ID="ID_1641896771" MODIFIED="1333267527571" TEXT="RTM_DELNEIGH"/>
<node CREATED="1333267533939" ID="ID_1628961082" MODIFIED="1333267535629" TEXT="RTM_GETNEIGH"/>
</node>
<node CREATED="1333188863307" ID="ID_660393507" MODIFIED="1333188905570" TEXT="__u16 nlmsg_flags"/>
<node CREATED="1333188863307" ID="ID_1814240459" MODIFIED="1333189358288" TEXT="__u32 nlmsg_seq : &#x5e8f;&#x5217;&#x53f7;, netlink&#x6838;&#x5fc3;&#x4e0d;&#x89e3;&#x91ca;&#x6b64;&#x503c;"/>
<node CREATED="1333188863307" ID="ID_981147699" MODIFIED="1333189364277" TEXT="__u32 nlmsg_pid : &#x53d1;&#x9001;&#x65b9;&#x7684;&#x8fdb;&#x7a0b;ID, netlink&#x6838;&#x5fc3;&#x4e0d;&#x89e3;&#x91ca;&#x6b64;&#x503c;"/>
</node>
<node CREATED="1333266376678" FOLDED="true" ID="ID_1336638913" MODIFIED="1359869954913" TEXT="struct rtgenmsg">
<node CREATED="1333266397781" FOLDED="true" ID="ID_1332549195" MODIFIED="1333267704893" TEXT="unsigned char rtgen_family">
<node CREATED="1333267674149" ID="ID_1721530105" MODIFIED="1333267676065" TEXT="AF_INET"/>
<node CREATED="1333267685020" ID="ID_54765985" MODIFIED="1333267686356" TEXT="AF_INET6"/>
</node>
</node>
<node CREATED="1333267102975" FOLDED="true" ID="ID_1972210627" MODIFIED="1447373513628" TEXT="&#x591a;&#x4e2a;&#x5c5e;&#x6027; struct rtattr&#xa;&#x6bcf;&#x4e2a;&#x5c5e;&#x6027;&#x4e3a;TLV&#x683c;&#x5f0f;">
<node CREATED="1333267118217" ID="ID_834561005" MODIFIED="1333267128056" TEXT="unsigned short rta_len"/>
<node CREATED="1333188863307" FOLDED="true" ID="ID_219978278" MODIFIED="1447373512830" TEXT="unsigned short rta_type">
<node CREATED="1333266182365" ID="ID_1937609613" MODIFIED="1333266184950" TEXT="RTM_BASE"/>
<node CREATED="1333266196706" ID="ID_744894931" MODIFIED="1333266198454" TEXT="RTM_NEWLINK"/>
<node CREATED="1333266205951" ID="ID_726079005" MODIFIED="1333266207751" TEXT="RTM_DELLINK"/>
<node CREATED="1333266215309" ID="ID_689681493" MODIFIED="1333266217134" TEXT="RTM_GETLINK"/>
<node CREATED="1333266224262" ID="ID_60044519" MODIFIED="1333266226270" TEXT="RTM_SETLINK"/>
<node CREATED="1333266275433" ID="ID_894349460" MODIFIED="1333266277177" TEXT="RTM_NEWADDR"/>
<node CREATED="1333266285565" ID="ID_327291980" MODIFIED="1333266286345" TEXT="RTM_DELADDR"/>
<node CREATED="1333266293494" ID="ID_1761011529" MODIFIED="1333266294969" TEXT="RTM_GETADDR"/>
<node CREATED="1333267494072" ID="ID_422987790" MODIFIED="1333267496095" TEXT="RTM_NEWROUTE"/>
<node CREATED="1333267502306" ID="ID_1237075940" MODIFIED="1333267506446" TEXT="RTM_DELROUTE"/>
<node CREATED="1333267510329" ID="ID_29228008" MODIFIED="1333267512216" TEXT="RTM_GETROUTE"/>
<node CREATED="1333267519179" ID="ID_212007212" MODIFIED="1333267519922" TEXT="RTM_NEWNEIGH"/>
<node CREATED="1333267525958" ID="ID_1433001930" MODIFIED="1333267527571" TEXT="RTM_DELNEIGH"/>
<node CREATED="1333267533939" ID="ID_1649180507" MODIFIED="1333267535629" TEXT="RTM_GETNEIGH"/>
</node>
<node CREATED="1333267247194" ID="ID_913412629" MODIFIED="1333267386802" TEXT="value : &#x6839;&#x636e;rta_type&#x7684;&#x4e0d;&#x540c;&#x6709;&#x4e0d;&#x540c;&#x7684;&#x683c;&#x5f0f;"/>
</node>
</node>
</node>
<node CREATED="1321714671211" ID="ID_523237432" MODIFIED="1333181631919" TEXT="protocol = NETLINK_UNUSED"/>
<node CREATED="1321714671211" ID="ID_1796393997" MODIFIED="1333181647105" TEXT="protocol = NETLINK_USERSOCK"/>
<node CREATED="1321714671211" ID="ID_494474535" MODIFIED="1333181663165" TEXT="protocol = NETLINK_FIREWALL"/>
<node CREATED="1321714671211" ID="ID_193680092" MODIFIED="1333181679598" TEXT="protocol = NETLINK_INET_DIAG"/>
<node CREATED="1321714671211" ID="ID_811066562" MODIFIED="1333181691443" TEXT="protocol = NETLINK_NFLOG"/>
<node CREATED="1321714671211" ID="ID_1306659394" MODIFIED="1333181708773" TEXT="protocol = NETLINK_XFRM"/>
<node CREATED="1321714671211" ID="ID_459397230" MODIFIED="1333181724814" TEXT="protocol = NETLINK_FIB_LOOKUP"/>
<node CREATED="1321714671211" ID="ID_1830118510" MODIFIED="1333181742239" TEXT="protocol = NETLINK_NETFILTER"/>
<node CREATED="1321714671211" ID="ID_1536203949" MODIFIED="1333181758484" TEXT="protocol = NETLINK_IP6_FW"/>
<node CREATED="1321714671211" FOLDED="true" ID="ID_396222650" MODIFIED="1447373478651" TEXT="protocol = NETLINK_GENERIC">
<node CREATED="1333266101434" FOLDED="true" ID="ID_1114948451" MODIFIED="1447373370675" TEXT="&#x6d88;&#x606f;&#x683c;&#x5f0f;">
<node CREATED="1333188839175" FOLDED="true" ID="ID_687246074" MODIFIED="1359869954918" TEXT="struct nlmsghdr">
<node CREATED="1333188863307" ID="ID_324654687" MODIFIED="1333188990472" TEXT="__u32 nlmsg_len : &#x5305;&#x542b;&#x672c;&#x5934;&#x90e8;&#x7684;&#x6d88;&#x606f;&#x957f;&#x5ea6;"/>
<node CREATED="1333188863307" ID="ID_102929269" MODIFIED="1333608185670" TEXT="__u16 nlmsg_type : &#x6d88;&#x606f;&#x7c7b;&#x578b;, netlink&#x6838;&#x5fc3;&#x4e0d;&#x89e3;&#x91ca;&#x6b64;&#x503c;"/>
<node CREATED="1333188863307" ID="ID_885359444" MODIFIED="1333188905570" TEXT="__u16 nlmsg_flags"/>
<node CREATED="1333188863307" ID="ID_770188623" MODIFIED="1333189358288" TEXT="__u32 nlmsg_seq : &#x5e8f;&#x5217;&#x53f7;, netlink&#x6838;&#x5fc3;&#x4e0d;&#x89e3;&#x91ca;&#x6b64;&#x503c;"/>
<node CREATED="1333188863307" ID="ID_1276320576" MODIFIED="1333189364277" TEXT="__u32 nlmsg_pid : &#x53d1;&#x9001;&#x65b9;&#x7684;&#x8fdb;&#x7a0b;ID, netlink&#x6838;&#x5fc3;&#x4e0d;&#x89e3;&#x91ca;&#x6b64;&#x503c;"/>
</node>
<node CREATED="1333266376678" FOLDED="true" ID="ID_1538608890" MODIFIED="1359869954918" TEXT="struct genlmsghdr">
<node CREATED="1333266397781" ID="ID_1806382368" MODIFIED="1333595942652" TEXT="__u8 cmd"/>
<node CREATED="1333595961170" ID="ID_391688302" MODIFIED="1333595968306" TEXT="__u8 version"/>
<node CREATED="1333595981803" ID="ID_1991150620" MODIFIED="1333595988502" TEXT="__u16 reserved"/>
</node>
<node CREATED="1333609996937" ID="ID_146105160" MODIFIED="1333610095559" TEXT="user header : &#x957f;&#x5ea6;&#x7531;struct genl_family.hdrsize&#x51b3;&#x5b9a;"/>
<node CREATED="1333610007592" ID="ID_1175405587" MODIFIED="1333610112242" TEXT="struct nlattr : TLV&#x683c;&#x5f0f;&#x7684;&#x5c5e;&#x6027;"/>
</node>
<node CREATED="1333610351176" FOLDED="true" ID="ID_1917070584" MODIFIED="1447373405884" TEXT="&#x63a5;&#x6536;&#x6d88;&#x606f;">
<node CREATED="1333608358041" ID="ID_1521423688" MODIFIED="1447373373381" TEXT="genl_rcv">
<node CREATED="1333608375116" ID="ID_648258150" MODIFIED="1447373375024" TEXT="genl_rcv_msg">
<node CREATED="1333608401608" ID="ID_1931209392" MODIFIED="1333608442245" TEXT="&#x6839;&#x636e;&#x6d88;&#x606f;&#x4e2d;&#x7684;family&#x548c;cmd&#x627e;&#x5230;&#x5bf9;&#x5e94;&#x7684;struct genl_ops *ops"/>
<node CREATED="1333608480116" ID="ID_422184687" MODIFIED="1333608488840" TEXT="&#x8c03;&#x7528;security_netlink_recv&#x68c0;&#x67e5;&#x6743;&#x9650;"/>
<node CREATED="1333608571307" FOLDED="true" ID="ID_1450856818" MODIFIED="1447373401899" TEXT="&#x8c03;&#x7528;nlmsg_parse&#x89e3;&#x6790;&#x5c5e;&#x6027;,&#x5e76;&#x653e;&#x5165;&#x5c5e;&#x6027;&#x6570;&#x7ec4;struct genl_family.attrbuf">
<node CREATED="1333608885742" ID="ID_1940445800" MODIFIED="1333608888028" TEXT="nla_parse"/>
</node>
<node CREATED="1333608637970" ID="ID_1106454056" MODIFIED="1333608702029" TEXT="&#x8c03;&#x7528;&#x5bf9;&#x5e94;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;struct genl_ops.doit"/>
</node>
</node>
</node>
<node CREATED="1333610363706" FOLDED="true" ID="ID_449088705" MODIFIED="1447373438811" TEXT="&#x53d1;&#x9001;&#x6d88;&#x606f;">
<node CREATED="1333610561071" ID="ID_1597591741" MODIFIED="1333610643324" TEXT="&#x521b;&#x5efa;&#x6d88;&#x606f;:&#xa;struct sk_buff *skb = genlmsg_new(NLMSG_GOODSIZE, GFP_KERNEL);&#xa;&#x5f53;&#x4e0d;&#x786e;&#x5b9a;&#x5e94;&#x5206;&#x914d;&#x591a;&#x5927;&#x5185;&#x5b58;&#x65f6;&#x4f7f;&#x7528;NLMSG_GOODSIZE"/>
<node CREATED="1333610740640" ID="ID_161750592" MODIFIED="1333610805580" TEXT="&#x8c03;&#x7528;genlmsg_put&#x521b;&#x5efa;&#x6d88;&#x606f;&#x5934;:&#xa; void *genlmsg_put(struct sk_buff *skb, u32 pid, u32 seq,&#xa;                               struct genl_family *family, int flags, u8 cmd)"/>
<node CREATED="1333610923050" ID="ID_1830880209" LINK="#ID_1480436132" MODIFIED="1333611006426" TEXT="&#x8c03;&#x7528;&#x5c5e;&#x6027;&#x64cd;&#x4f5c;&#x51fd;&#x6570;&#x6dfb;&#x52a0;&#x5c5e;&#x6027;"/>
<node CREATED="1333611347413" ID="ID_1339962060" MODIFIED="1333611435860" TEXT="&#x8c03;&#x7528;int genlmsg_end(struct sk_buff *skb, void *hdr)&#x5b8c;&#x6210;&#x6d88;&#x606f;&#x521b;&#x5efa;&#xa;&#x6b64;&#x51fd;&#x6570;&#x6700;&#x7ec8;&#x8bbe;&#x7f6e;struct nlmsghdr.nlmsg_len"/>
<node CREATED="1333611670970" FOLDED="true" ID="ID_313130143" MODIFIED="1447373437580" TEXT="&#x5355;&#x64ad;&#x53d1;&#x9001;">
<node CREATED="1333611697143" ID="ID_1929916285" MODIFIED="1447373433653" TEXT="int genlmsg_unicast(struct sk_buff *skb, u32 pid)">
<node CREATED="1333611703166" ID="ID_1327127469" MODIFIED="1333611720673" TEXT="pid : &#x76ee;&#x7684;&#x8fdb;&#x7a0b;"/>
</node>
</node>
<node CREATED="1333611685453" FOLDED="true" ID="ID_1763205548" MODIFIED="1447373428468" TEXT="&#x7ec4;&#x64ad;&#x53d1;&#x9001;">
<node CREATED="1333611734930" ID="ID_1400978187" MODIFIED="1447373423606" TEXT="int genlmsg_multicast(struct sk_buff *skb, u32 pid, unsigned int group, gfp_t flags)">
<node CREATED="1333611753684" ID="ID_223542271" MODIFIED="1333611849885" TEXT="pid : &#x53d1;&#x9001;&#x8005;&#x81ea;&#x5df1;&#x7684;&#x8fdb;&#x7a0b;&#x53f7;,&#x4ee5;&#x907f;&#x514d;&#x73af;&#x56de;"/>
<node CREATED="1333611895928" ID="ID_497736855" MODIFIED="1333611909177" TEXT="group : &#x7ec4;&#x5730;&#x5740;"/>
</node>
</node>
</node>
<node CREATED="1333610378483" FOLDED="true" ID="ID_187499495" MODIFIED="1447373476035" TEXT="&#x6a21;&#x5757;&#x521d;&#x59cb;&#x5316;">
<node CREATED="1333596340162" FOLDED="true" ID="ID_454491367" MODIFIED="1447373458612" TEXT="int genl_register_family(struct genl_family *family)">
<node CREATED="1333596358744" FOLDED="true" ID="ID_1422525631" MODIFIED="1447373457141" TEXT="struct genl_family *family">
<node CREATED="1333596402116" ID="ID_467610263" MODIFIED="1333608116093" TEXT="unsigned int id : channel&#x53f7;,&#x5f53;&#x4f20;&#x5165;GENL_ID_GENERATE&#x65f6;&#x8868;&#x793a;&#x7531;&#x7cfb;&#x7edf;&#x5206;&#x914d;channel&#x53f7;&#xa;&#x5b83;&#x5bf9;&#x5e94;&#x4e86;&#x6d88;&#x606f;&#x683c;&#x5f0f;&#x4e2d;struct nlmsghdr.nlmsg_type&#x5b57;&#x6bb5;"/>
<node CREATED="1333596418687" ID="ID_1553702410" MODIFIED="1333605538857" TEXT="unsigned int hdrsize : &#x6a21;&#x5757;&#x79c1;&#x6709;&#x6570;&#x636e;&#x7684;&#x5927;&#x5c0f;"/>
<node CREATED="1333596437086" ID="ID_1189254685" MODIFIED="1333605567654" TEXT="char name[GENL_NAMSIZ] : &#x6a21;&#x5757;&#x540d;&#x79f0;"/>
<node CREATED="1333596457988" ID="ID_70823960" MODIFIED="1333605615923" TEXT="unsigned int version : &#x7248;&#x672c;&#x53f7;"/>
<node CREATED="1333596473961" ID="ID_1535345380" MODIFIED="1333605625012" TEXT="unsigned int maxattr : &#x5c5e;&#x6027;&#x6570;&#x91cf;"/>
<node CREATED="1333596490874" FOLDED="true" ID="ID_604938877" MODIFIED="1333605948903" TEXT="struct nlattr **attrbuf : &#x5c5e;&#x6027;&#x6570;&#x7ec4;,&#x6bcf;&#x4e2a;&#x6570;&#x7ec4;&#x5143;&#x7d20;&#x6307;&#x5411;&#x4e00;&#x4e2a;&#x5c5e;&#x6027;,&#x79c1;&#x6709;">
<node CREATED="1333267102975" FOLDED="true" ID="ID_1843650322" MODIFIED="1333605947935" TEXT="struct nlattr&#xa;&#x6bcf;&#x4e2a;&#x5c5e;&#x6027;&#x4e3a;TLV&#x683c;&#x5f0f;">
<node CREATED="1333267118217" ID="ID_1579230725" MODIFIED="1333605904490" TEXT="unsigned short nla_len"/>
<node CREATED="1333188863307" ID="ID_620982483" MODIFIED="1333605925048" TEXT="unsigned short nla_type"/>
<node CREATED="1333267247194" ID="ID_1520200611" MODIFIED="1333605923898" TEXT="value : &#x6839;&#x636e;nla_type&#x7684;&#x4e0d;&#x540c;&#x6709;&#x4e0d;&#x540c;&#x7684;&#x683c;&#x5f0f;"/>
</node>
</node>
<node CREATED="1333596515141" ID="ID_557358151" MODIFIED="1333605302385" TEXT="struct list_head ops_list : &#x79c1;&#x6709;,&#x7528;&#x4e8e;&#x94fe;&#x63a5;"/>
<node CREATED="1333596532779" ID="ID_1669510495" MODIFIED="1333606062899" TEXT="struct list_head family_list : &#x79c1;&#x6709;,&#x7528;&#x4e8e;&#x94fe;&#x63a5;&#x8fdb;&#x5168;&#x5c40;&#x53d8;&#x91cf;struct list_head family_ht[GENL_FAM_TAB_SIZE]"/>
<node CREATED="1333596547316" ID="ID_1595819610" MODIFIED="1333605312032" TEXT="struct list_head mcast_groups : &#x79c1;&#x6709;,&#x7528;&#x4e8e;&#x94fe;&#x63a5;"/>
</node>
</node>
<node CREATED="1333606314739" FOLDED="true" ID="ID_1862452029" MODIFIED="1447373474661" TEXT="int genl_register_ops(struct genl_family *family, struct genl_ops *ops)">
<node CREATED="1333606329490" ID="ID_1688318614" MODIFIED="1333606389903" TEXT="struct genl_family *family : &#x8c03;&#x7528;genl_register_family&#x6ce8;&#x518c;&#x8fc7;&#x7684;family"/>
<node CREATED="1333606342436" FOLDED="true" ID="ID_844121799" MODIFIED="1447373473316" TEXT="struct genl_ops *ops">
<node CREATED="1333606436499" ID="ID_574606924" MODIFIED="1333608165383" TEXT="u8 cmd : &#x6bcf;&#x4e2a;family&#x4e0b;&#x53ef;&#x4ee5;&#x6709;&#x5f88;&#x591a;cmd, &#x6b64;&#x53c2;&#x6570;&#x6307;&#x5b9a;&#x4e00;&#x4e2a;&#x7279;&#x5b9a;&#x7684;cmd&#x6240;&#x5bf9;&#x5e94;&#x7684;&#x64cd;&#x4f5c;&#xa;&#x5b83;&#x5bf9;&#x5e94;&#x4e86;&#x6d88;&#x606f;&#x683c;&#x5f0f;&#x4e2d;struct genlmsghdr.cmd&#x5b57;&#x6bb5;"/>
<node CREATED="1333606453090" FOLDED="true" ID="ID_1041449174" MODIFIED="1333607731764" TEXT="unsigned int flags : &#x6807;&#x5e1c;">
<node CREATED="1333607653747" ID="ID_993992" MODIFIED="1333607709300" TEXT="GENL_ADMIN_PERM : &#x6307;&#x5b9a;&#x64cd;&#x4f5c;&#x662f;&#x5426;&#x9700;&#x8981;root&#x6743;&#x9650;"/>
</node>
<node CREATED="1333606480850" FOLDED="true" ID="ID_1227263494" MODIFIED="1359869954919" TEXT="struct nla_policy *policy : &#x5c5e;&#x6027;&#x68c0;&#x67e5;&#x7b56;&#x7565;&#x6570;&#x7ec4;, &#x4e00;&#x822c;&#x4e3a;NULL">
<node CREATED="1333609138753" ID="ID_1866401017" MODIFIED="1333609152460" TEXT="u16 type"/>
<node CREATED="1333609162761" ID="ID_157080644" MODIFIED="1333609171486" TEXT="u16 len"/>
</node>
<node CREATED="1333606505924" FOLDED="true" ID="ID_1227224521" MODIFIED="1333613613316" TEXT="int (*doit)(struct sk_buff *skb, struct genl_info *info) : &#x6536;&#x5230;family, cmd&#x5bf9;&#x5e94;&#x7684;&#x6d88;&#x606f;&#x65f6;&#x8c03;&#x7528;&#x7684;&#x51fd;&#x6570;">
<node CREATED="1333609270104" FOLDED="true" ID="ID_322271681" MODIFIED="1359869954919" TEXT="struct genl_info *info">
<node CREATED="1333609316397" ID="ID_660516224" MODIFIED="1333609768089" TEXT="u32 snd_seq : &#x6d88;&#x606f;&#x683c;&#x5f0f;&#x4e2d;&#x7684;struct nlmsghdr.nlmsg_seq"/>
<node CREATED="1333609328867" ID="ID_344363033" MODIFIED="1333609811994" TEXT="u32 snd_pid : &#x6d88;&#x606f;&#x683c;&#x5f0f;&#x4e2d;&#x7684;struct nlmsghdr.nlmsg_pid"/>
<node CREATED="1333609343197" ID="ID_1641545548" MODIFIED="1333609696761" TEXT="struct nlmsghdr *nlhdr : &#x5934;&#x6307;&#x9488;"/>
<node CREATED="1333609365035" ID="ID_629302147" MODIFIED="1333609702444" TEXT="struct genlmsghdr *genlhdr : &#x5934;&#x6307;&#x9488;"/>
<node CREATED="1333609389051" ID="ID_1470734657" MODIFIED="1333609706987" TEXT="void *userhdr : &#x5934;&#x6307;&#x9488;"/>
<node CREATED="1333609409932" ID="ID_165146534" MODIFIED="1333609711458" TEXT="struct nlattr **attrs : &#x5934;&#x6307;&#x9488;"/>
</node>
</node>
<node CREATED="1333606552483" ID="ID_1707100699" MODIFIED="1333606567900" TEXT="int (*dumpit)(struct sk_buff *skb, struct netlink_callback *cb)"/>
<node CREATED="1333606583205" ID="ID_1202250937" MODIFIED="1333606593454" TEXT="int (*done)(struct netlink_callback *cb)"/>
<node CREATED="1333606604218" ID="ID_536985807" MODIFIED="1333607881396" TEXT="struct list_head ops_list : &#x7528;&#x4e8e;&#x94fe;&#x63a5;&#x8fdb;family-&gt;ops_list"/>
</node>
</node>
</node>
</node>
</node>
<node CREATED="1333264316740" FOLDED="true" ID="ID_113968523" MODIFIED="1447373349492" TEXT="&#x5728;&#x5185;&#x6838;&#x4e2d;&#x6536;&#x53d1;netlink&#x6d88;&#x606f;">
<node CREATED="1333264349311" FOLDED="true" ID="ID_870827458" MODIFIED="1447373255268" TEXT="struct sock * &#xa;netlink_kernel_create(struct net *net, &#xa;                                   int unit, &#xa;                                   unsigned int groups, &#xa;                                   void (*input)(struct sk_buff *skb),&#xa;                                   struct mutex *cb_mutex, &#xa;                                   struct module *module)">
<node CREATED="1333264486133" ID="ID_429877025" MODIFIED="1333264529361" TEXT="net : &#x7f51;&#x7edc;&#x547d;&#x540d;&#x7a7a;&#x95f4;,&#x4e00;&#x822c;&#x4e3a;init_net"/>
<node CREATED="1333264532049" ID="ID_1011720653" MODIFIED="1333264660352" TEXT="unit : &#x5373;socket&#x7684;protocol, &#xa;&#x82e5;&#x65e0;&#x5408;&#x9002;&#x534f;&#x8bae;&#x53f7;, &#x53ef;&#x4f7f;&#x7528;NETLINK_GENERIC"/>
<node CREATED="1333264672836" ID="ID_96256267" MODIFIED="1333264708620" TEXT="groups : &#x7ec4;&#x5730;&#x5740;,&#x6bcf;&#x4e2a;bit&#x4ee3;&#x8868;&#x4e00;&#x4e2a;&#x7ec4;"/>
<node CREATED="1333264717832" FOLDED="true" ID="ID_970393947" MODIFIED="1333269413651" TEXT="input : &#x6536;&#x5230;&#x6d88;&#x606f;&#x540e;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;">
<node CREATED="1333265883946" ID="ID_1608168165" MODIFIED="1333265958274" TEXT="&#x6b64;&#x51fd;&#x6570;&#x4e00;&#x822c;&#x901a;&#x8fc7;&#x8c03;&#x7528;&#xa;int netlink_rcv_skb(struct sk_buff *skb, int (*cb)(struct sk_buff *, struct nlmsghdr *))&#xa;&#x6765;&#x8c03;&#x7528;&#x771f;&#x6b63;&#x7684;&#x5904;&#x7406;&#x51fd;&#x6570;cb"/>
</node>
<node CREATED="1333264751938" ID="ID_424484788" MODIFIED="1333264803969" TEXT="cb_mutex : &#x4e92;&#x65a5;&#x9501;, &#x4e00;&#x822c;&#x4e3a;NULL"/>
<node CREATED="1333264804612" ID="ID_75761375" MODIFIED="1333264837789" TEXT="module : &#x5185;&#x6838;&#x6a21;&#x5757;,&#x4e00;&#x822c;&#x4e3a;THIS_MODULE"/>
</node>
<node CREATED="1333269898488" FOLDED="true" ID="ID_813121454" MODIFIED="1447373288171" TEXT="int nlmsg_multicast(struct sock *sk, &#xa;                               struct sk_buff *skb, &#xa;                               u32 pid, &#xa;                               unsigned int group, &#xa;                               gfp_t flags)">
<node CREATED="1333270105708" FOLDED="true" ID="ID_1687315358" MODIFIED="1447373287308" TEXT="int netlink_broadcast(struct sock *ssk, &#xa;                                   struct sk_buff *skb, &#xa;                                   u32 pid, &#x9;&#x9;      &#xa;                                   u32 group, &#xa;                                   gfp_t allocation)">
<node CREATED="1333270221960" ID="ID_214790005" MODIFIED="1333270257851" TEXT="ssk : &#x5373;&#x4e0a;&#x9762;netlink_kernel_create&#x8fd4;&#x56de;&#x7684;&#x503c;"/>
<node CREATED="1333270264228" ID="ID_943173522" MODIFIED="1333270338902" TEXT="skb : netlink&#x6d88;&#x606f;,&#x81f3;&#x5c11;&#x8981;&#x5305;&#x542b;&#x4e00;&#x4e2a;struct nlmsghdr&#x5934;&#x90e8;"/>
<node CREATED="1333270373099" ID="ID_1602787195" MODIFIED="1333270497435" TEXT="pid : &#x53d1;&#x9001;&#x8005;&#x7684;&#x8fdb;&#x7a0b;&#x53f7;,&#x5bf9;&#x4e8e;&#x5185;&#x6838;&#x800c;&#x8a00;&#x8fd9;&#x91cc;&#x90fd;&#x5e94;&#x586b;0"/>
<node CREATED="1333270499737" ID="ID_1983341881" MODIFIED="1333270519913" TEXT="group : &#x53d1;&#x9001;&#x5230;&#x7684;&#x76ee;&#x7684;&#x7ec4;&#x5730;&#x5740;"/>
<node CREATED="1333270558083" FOLDED="true" ID="ID_1877695667" MODIFIED="1333270776036" TEXT="allocation : &#x5185;&#x5b58;&#x5206;&#x914d;&#x5c5e;&#x6027;">
<node CREATED="1333270763339" ID="ID_35037528" MODIFIED="1333270764873" TEXT="GFP_ATOMIC"/>
<node CREATED="1333270772520" ID="ID_1676931552" MODIFIED="1333270773991" TEXT="GFP_KERNEL"/>
</node>
</node>
</node>
<node CREATED="1333270892454" FOLDED="true" ID="ID_1298909812" MODIFIED="1447373297859" TEXT="int nlmsg_unicast(struct sock *sk, &#xa;                             struct sk_buff *skb, &#xa;                             u32 pid)">
<node CREATED="1333270978638" FOLDED="true" ID="ID_1208293996" MODIFIED="1447373296804" TEXT="int netlink_unicast(struct sock *ssk, &#xa;                              struct sk_buff *skb,&#xa;                              u32 pid, &#xa;                              int nonblock)">
<node CREATED="1333270221960" ID="ID_86285549" MODIFIED="1333270257851" TEXT="ssk : &#x5373;&#x4e0a;&#x9762;netlink_kernel_create&#x8fd4;&#x56de;&#x7684;&#x503c;"/>
<node CREATED="1333270264228" ID="ID_323764694" MODIFIED="1333270338902" TEXT="skb : netlink&#x6d88;&#x606f;,&#x81f3;&#x5c11;&#x8981;&#x5305;&#x542b;&#x4e00;&#x4e2a;struct nlmsghdr&#x5934;&#x90e8;"/>
<node CREATED="1333270373099" ID="ID_504429741" MODIFIED="1333270497435" TEXT="pid : &#x53d1;&#x9001;&#x8005;&#x7684;&#x8fdb;&#x7a0b;&#x53f7;,&#x5bf9;&#x4e8e;&#x5185;&#x6838;&#x800c;&#x8a00;&#x8fd9;&#x91cc;&#x90fd;&#x5e94;&#x586b;0"/>
<node CREATED="1333271322682" ID="ID_1416531515" MODIFIED="1333271387656" TEXT="nonblock : &#x662f;&#x5426;&#x963b;&#x585e;, &#x4e00;&#x822c;&#x8bbe;&#x4e3a;MSG_DONTWAIT"/>
</node>
</node>
<node CREATED="1333271060141" FOLDED="true" ID="ID_1341056162" MODIFIED="1447373344827" TEXT="int nlmsg_notify(struct sock *sk, &#xa;                          struct sk_buff *skb, &#xa;                          u32 pid, &#x9;&#x9; &#xa;                          unsigned int group, &#xa;                          int report, &#xa;                          gfp_t flags)">
<node CREATED="1333271176584" ID="ID_1429078470" MODIFIED="1333271253226" TEXT="&#x5982;&#x679c;group&#x4e0d;&#x4e3a;0&#x5219;&#x8c03;&#x7528;nlmsg_multicast&#x7ec4;&#x64ad;&#x6b64;&#x6d88;&#x606f;"/>
<node CREATED="1333271176584" ID="ID_1490040749" MODIFIED="1333271262523" TEXT="&#x5982;&#x679c;report&#x4e0d;&#x4e3a;0&#x5219;&#x8c03;&#x7528;nlmsg_unicast&#x5355;&#x64ad;&#x6b64;&#x6d88;&#x606f;"/>
</node>
<node CREATED="1333610979476" FOLDED="true" ID="ID_1480436132" MODIFIED="1447373347579" TEXT="&#x5c5e;&#x6027;&#x64cd;&#x4f5c;&#x51fd;&#x6570;">
<node CREATED="1333611034329" ID="ID_1232796194" MODIFIED="1333611036436" TEXT="int nla_put_u8(struct sk_buff *skb, int attrtype, u8 value)"/>
<node CREATED="1333611048993" ID="ID_417861400" MODIFIED="1333611051669" TEXT="int nla_put_u16(struct sk_buff *skb, int attrtype, u16 value)"/>
<node CREATED="1333611064580" ID="ID_535801923" MODIFIED="1333611066660" TEXT="int nla_put_u32(struct sk_buff *skb, int attrtype, u32 value)"/>
<node CREATED="1333611077472" ID="ID_1263587800" MODIFIED="1333611079338" TEXT="int nla_put_u64(struct sk_buff *skb, int attrtype, u64 value)"/>
<node CREATED="1333611093810" ID="ID_247132460" MODIFIED="1333611106489" TEXT="int nla_put_string(struct sk_buff *skb, int attrtype, const char *str)"/>
</node>
</node>
</node>
</node>
<node CREATED="1447109638872" FOLDED="true" ID="ID_896292803" MODIFIED="1447661830916" POSITION="left" TEXT="netlink socket">
<node CREATED="1447109685432" FOLDED="true" ID="ID_1735728869" MODIFIED="1447399133322" TEXT="libnl&#x67b6;&#x6784;">
<node CREATED="1447109702622" FOLDED="true" ID="ID_852824824" MODIFIED="1447112202091">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_socket_arch_1.JPG" />
  </body>
</html></richcontent>
<node CREATED="1447109746242" ID="ID_1560100884" MODIFIED="1447109749282" TEXT="libnl">
<node CREATED="1447109767082" ID="ID_158464784" MODIFIED="1447109989856">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#36825;&#26159;&#19968;&#20010;&#26680;&#24515;&#24211;&#65292;&#23454;&#29616;&#20102;&#19968;&#20123;&#22522;&#30784;&#21151;&#33021;&#65292;&#22914;socket&#21019;&#24314;&#65292;&#28040;&#24687;&#26500;&#36896;&#21644;&#35299;&#26512;&#65292;&#25910;&#21457;&#25968;&#25454;&#12290;
    </p>
    <p>
      &#36825;&#20010;&#24211;&#34987;&#20445;&#25345;&#24471;&#23613;&#37327;&#23567;&#65292;&#20854;&#23427;&#20960;&#20010;&#24211;&#20381;&#36182;&#20110;&#36825;&#20010;&#26680;&#24515;&#24211;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447110004457" ID="ID_1225199542" MODIFIED="1447110014757" TEXT="libnl-route">
<node CREATED="1447110078378" ID="ID_111410823" MODIFIED="1447110227159">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#36825;&#26159;NETLINK_ROUTE&#21327;&#35758;&#26063;&#30456;&#20851;&#30340;&#37197;&#32622;&#25509;&#21475;&#65292;
    </p>
    <p>
      &#21253;&#21547;&#20102;&#32593;&#32476;&#25509;&#21475;&#65292;&#36335;&#30001;&#65292;&#22320;&#22336;&#65292;&#37051;&#23621;&#65292;QOS&#27969;&#25511;&#31561;&#21151;&#33021;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447110015277" ID="ID_277595059" MODIFIED="1447110022847" TEXT="libnl-genl">
<node CREATED="1447110258039" ID="ID_6954466" MODIFIED="1447110286450" TEXT="&#x901a;&#x7528;netlink&#x534f;&#x8bae;&#xff0c;&#x5b83;&#x662f;netlink&#x534f;&#x8bae;&#x7684;&#x4e00;&#x4e2a;&#x6269;&#x5c55;&#x7248;&#x672c;"/>
</node>
<node CREATED="1447110023687" ID="ID_1865233646" MODIFIED="1447110029587" TEXT="libnl-nf">
<node CREATED="1447110323820" ID="ID_1078397854" MODIFIED="1447110393461">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#36825;&#26159;netfilter&#21644;&#30417;&#25511;&#30456;&#20851;&#30340;&#37197;&#32622;&#25509;&#21475;&#65292;
    </p>
    <p>
      &#21253;&#21547;&#20102;conntrack, log, queue&#31561;&#21151;&#33021;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node CREATED="1447109441104" FOLDED="true" ID="ID_1683196359" MODIFIED="1447488986447" TEXT="&#x6570;&#x636e;&#x7ed3;&#x6784;">
<node CREATED="1333186431775" FOLDED="true" ID="ID_964361784" MODIFIED="1447488432530" TEXT="struct sockaddr_nl">
<node CREATED="1333186447668" ID="ID_647485439" MODIFIED="1333186453932" TEXT="sa_family_t nl_family"/>
<node CREATED="1333187561319" ID="ID_552534772" MODIFIED="1333187586264" TEXT="unsigned short nl_pad : &#x586b;&#x5145;"/>
<node CREATED="1333187609630" ID="ID_983044465" MODIFIED="1333187753330" TEXT="__u32 nl_pid : &#x5185;&#x6838;&#x7a7a;&#x95f4;&#x53d1;&#x5f80;&#x7528;&#x6237;&#x7a7a;&#x95f4;&#x65f6;&#x4e3a;&#x76ee;&#x6807;&#x8fdb;&#x7a0b;&#x7684;ID, &#x7528;&#x6237;&#x7a7a;&#x95f4;&#x53d1;&#x5f80;&#x5185;&#x6838;&#x7a7a;&#x95f4;&#x65f6;&#x6b64;&#x503c;&#x5e94;&#x4e3a;0"/>
<node CREATED="1333188167819" ID="ID_1677826537" MODIFIED="1333188270302" TEXT="__u32 nl_groups : &#x76ee;&#x6807;&#x7ec4;&#x5730;&#x5740;, &#x6bcf;&#x4e2a;bit&#x4ee3;&#x8868;&#x4e00;&#x4e2a;&#x7ec4;,&#x53ef;&#x4ee5;&#x6709;&#x591a;&#x4e2a;bit&#x7f6e;1,&#x8868;&#x793a;&#x53d1;&#x5f80;&#x591a;&#x4e2a;&#x7ec4;"/>
</node>
<node CREATED="1447483706020" FOLDED="true" ID="ID_1965075058" MODIFIED="1447488785150" TEXT="struct nl_sock">
<node CREATED="1447484025021" ID="ID_1217904643" LINK="#ID_1314785051" MODIFIED="1447484938074">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#29992;&#25143;&#19981;&#24212;&#35813;&#30452;&#25509;&#35775;&#38382;struct nl_sock&#65292;&#32780;&#26159;&#24212;&#35813;&#36890;&#36807;socket&#23646;&#24615;&#25509;&#21475;&#26469;&#25805;&#20316;&#23427;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447483838160" ID="ID_1569283362" MODIFIED="1447485126317">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct sockaddr_nl&#160;s_local
    </p>
    <p>
      nl_pid&#21363;&#20026;local port&#65292;nl_groups&#19981;&#29992;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447483882229" ID="ID_73471868" MODIFIED="1447485170290">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct sockaddr_nl s_peer
    </p>
    <p>
      nl_pid&#21363;&#20026;peer port&#65292;nl_groups&#21363;&#20026;peer groups
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447483891549" ID="ID_1567677668" MODIFIED="1447485190962">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      int s_fd
    </p>
    <p>
      socket&#23545;&#24212;&#30340;&#25991;&#20214;&#21477;&#26564;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447483900869" ID="ID_1100152029" MODIFIED="1447485210568">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      int s_proto
    </p>
    <p>
      netlink family
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447483911992" ID="ID_1205679008" MODIFIED="1447485244516">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      unsigned int s_seq_next
    </p>
    <p>
      &#21457;&#36865;&#28040;&#24687;&#26102;&#23558;&#35201;&#29992;&#21040;&#30340;&#19979;&#19968;&#20010;&#24207;&#21015;&#21495;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447483928628" ID="ID_200786592" MODIFIED="1447485273690">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      unsigned int s_seq_expect
    </p>
    <p>
      &#25509;&#25910;&#28040;&#24687;&#26102;&#26399;&#24453;&#30340;&#19979;&#19968;&#20010;&#24207;&#21015;&#21495;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447483942633" FOLDED="true" ID="ID_1931349183" MODIFIED="1447485381876" TEXT="int s_flags">
<node CREATED="1447485339485" ID="ID_563876704" MODIFIED="1447485340876" TEXT="NL_SOCK_BUFSIZE_SET"/>
<node CREATED="1447485349549" ID="ID_1362374654" MODIFIED="1447485350235" TEXT="NL_SOCK_PASSCRED"/>
<node CREATED="1447485358661" ID="ID_523537717" MODIFIED="1447485359301" TEXT="NL_OWN_PORT"/>
<node CREATED="1447485368322" ID="ID_1330462345" MODIFIED="1447485368955" TEXT="NL_MSG_PEEK"/>
<node CREATED="1447485377716" ID="ID_419631038" MODIFIED="1447485378380" TEXT="NL_NO_AUTO_ACK"/>
</node>
<node CREATED="1447483965459" ID="ID_1022505457" MODIFIED="1447485521487">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct nl_cb *s_cb
    </p>
    <p>
      &#25910;&#21457;&#28040;&#24687;&#26102;&#29992;&#25143;&#21487;&#20197;&#25913;&#21464;&#31995;&#32479;&#34892;&#20026;&#65292;&#23450;&#21046;&#33258;&#24049;&#30340;&#34892;&#20026;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447483974610" ID="ID_1983246183" MODIFIED="1447485746741">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      size_t s_bufsize
    </p>
    <p>
      &#25509;&#25910;&#32531;&#20914;&#21306;&#22823;&#23567;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447483719045" FOLDED="true" ID="ID_1638791613" MODIFIED="1447488985440" TEXT="struct nl_msg">
<node CREATED="1447488788688" ID="ID_1998731349" LINK="#ID_566454624" MODIFIED="1447488860887" TEXT="&#x7528;&#x6237;&#x4e0d;&#x5e94;&#x76f4;&#x63a5;&#x8bbf;&#x95ee;struct nl_msg&#xff0c;&#x800c;&#x662f;&#x5e94;&#x8be5;&#x4f7f;&#x7528;&#x76f8;&#x5e94;&#x7684;&#x5c01;&#x88c5;&#x6216;&#x89e3;&#x6790;API&#x6765;&#x8bbf;&#x95ee;&#x5b83;"/>
</node>
<node CREATED="1333188839175" FOLDED="true" ID="ID_863637129" MODIFIED="1447488692635" TEXT="struct nlmsghdr">
<node CREATED="1447115658963" ID="ID_1777536876" MODIFIED="1447115687683">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_message_format_1.JPG" />
  </body>
</html></richcontent>
<node CREATED="1333188863307" ID="ID_1808431219" MODIFIED="1447115779173" TEXT="__u32 nlmsg_len : &#x6d88;&#x606f;&#x603b;&#x957f;&#x5ea6;&#xff0c;&#x5305;&#x542b;&#x672c;&#x5934;&#x90e8;"/>
<node CREATED="1333188863307" FOLDED="true" ID="ID_439566454" MODIFIED="1447483110658">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      __u16 nlmsg_type : &#28040;&#24687;&#31867;&#22411;
    </p>
    <p>
      &#26377;&#19968;&#20123;&#26631;&#20934;&#30340;&#28040;&#24687;&#31867;&#22411;&#65292;&#21508;&#20010;&#21327;&#35758;&#26063;&#20063;&#21487;&#20197;&#23450;&#20041;&#33258;&#24049;&#30340;&#28040;&#24687;&#31867;&#22411;
    </p>
    <p>
      &#20294;&#23567;&#20110;<code>NLMSG_MIN_TYPE</code>&#30340;&#20540;&#26159;&#34987;&#20445;&#30041;&#30340;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447117309499" ID="ID_188679608" MODIFIED="1447117310747" TEXT="NLMSG_NOOP">
<node CREATED="1447117319038" ID="ID_1475868871" MODIFIED="1447117355402" TEXT="&#x65e0;&#x64cd;&#x4f5c;&#xff0c;&#x6b64;&#x65f6;&#x6d88;&#x606f;&#x5e94;&#x88ab;&#x91ca;&#x653e;"/>
</node>
<node CREATED="1447117851225" ID="ID_803678032" MODIFIED="1447117852145" TEXT="NLMSG_ERROR">
<node CREATED="1447117881809" ID="ID_24157248" MODIFIED="1447117886224" TEXT="&#x9519;&#x8bef;&#x6d88;&#x606f;">
<node CREATED="1447120227854" ID="ID_1834292841" MODIFIED="1447120239429">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_message_format_2.JPG" />
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447120268718" ID="ID_779927135" MODIFIED="1447120301915" TEXT="ACK&#x6d88;&#x606f;&#x4e5f;&#x4f7f;&#x7528;&#x7edf;&#x4e00;&#x683c;&#x5f0f;&#xff0c;&#x4f46;&#x662f;Error Code&#x4e3a;0"/>
</node>
<node CREATED="1447117887698" ID="ID_685055438" MODIFIED="1447117889133" TEXT="NLMSG_DONE">
<node CREATED="1447117890482" ID="ID_662454110" MODIFIED="1447119738707" TEXT="&#x5f53;&#x6570;&#x636e;&#x88ab;&#x5206;&#x4e3a;&#x591a;&#x4e2a;netlink&#x6d88;&#x606f;&#x65f6;&#xff0c;&#x8fd9;&#x4e2a;&#x7c7b;&#x578b;&#x8868;&#x793a;&#x6b64;&#x6d88;&#x606f;&#x65f6;&#x6574;&#x4e2a;&#x6570;&#x636e;&#x7684;&#x6700;&#x540e;&#x4e00;&#x4e2a;&#x6d88;&#x606f;"/>
</node>
<node CREATED="1447119764564" ID="ID_1627942209" MODIFIED="1447119766639" TEXT="NLMSG_OVERRUN"/>
</node>
<node CREATED="1333188863307" FOLDED="true" ID="ID_1624069777" MODIFIED="1447120611502" TEXT="__u16 nlmsg_flags">
<node CREATED="1447117267581" ID="ID_956701369" MODIFIED="1447117268798" TEXT="NLM_F_REQUEST">
<node CREATED="1447120328092" ID="ID_347138435" MODIFIED="1447120333115" TEXT="&#x8bf7;&#x6c42;"/>
</node>
<node CREATED="1447120347819" ID="ID_595937961" MODIFIED="1447120349286" TEXT="NLM_F_MULTI">
<node CREATED="1447120350401" ID="ID_525656097" MODIFIED="1447120379994" TEXT="&#x5206;&#x6bb5;&#x6d88;&#x606f;&#xff0c;&#x5373;&#x6570;&#x636e;&#x88ab;&#x5206;&#x6210;&#x4e86;&#x591a;&#x4e2a;netlink&#x6d88;&#x606f;"/>
</node>
<node CREATED="1447120097102" ID="ID_469427816" MODIFIED="1447120099192" TEXT="NLM_F_ACK ">
<node CREATED="1447120104769" ID="ID_266912009" MODIFIED="1447120150010" TEXT="&#x5f53;&#x53d1;&#x51fa;&#x6d88;&#x606f;&#x7684;&#x4eba;&#x5e0c;&#x671b;&#x5f97;&#x5230;&#x4e00;&#x4e2a;&#x660e;&#x786e;&#x7684;&#x56de;&#x5e94;&#x65f6;&#x53ef;&#x4ee5;&#x7f6e;&#x4e0a;&#x6b64;&#x6807;&#x8bc6;"/>
</node>
<node CREATED="1447120397661" ID="ID_540639688" MODIFIED="1447120398738" TEXT="NLM_F_ECHO">
<node CREATED="1447120399915" ID="ID_1035012942" MODIFIED="1447120426560" TEXT="&#x5e0c;&#x671b;&#x5bf9;&#x7aef;&#x5c06;&#x539f;&#x5305;&#x53cd;&#x5f39;&#x56de;&#x6765;"/>
</node>
<node CREATED="1447120537145" ID="ID_597654513" MODIFIED="1447120537753" TEXT="NLM_F_ROOT"/>
<node CREATED="1447120547932" ID="ID_882298480" MODIFIED="1447120548478" TEXT="NLM_F_MATCH"/>
<node CREATED="1447120558236" ID="ID_1600509007" MODIFIED="1447120558829" TEXT="NLM_F_ATOMIC"/>
<node CREATED="1447120566574" ID="ID_1428596286" MODIFIED="1447120567089" TEXT="NLM_F_DUMP"/>
<node CREATED="1447120576722" ID="ID_1342450607" MODIFIED="1447120580731" TEXT="NLM_F_REPLACE"/>
<node CREATED="1447120587837" ID="ID_13256923" MODIFIED="1447120588414" TEXT="NLM_F_EXCL"/>
<node CREATED="1447120596815" ID="ID_1514249767" MODIFIED="1447120597408" TEXT="NLM_F_CREATE"/>
<node CREATED="1447120606089" ID="ID_1416304190" MODIFIED="1447120610161" TEXT="NLM_F_APPEND"/>
</node>
<node CREATED="1333188863307" ID="ID_387675527" MODIFIED="1447115988244" TEXT="__u32 nlmsg_seq : &#x5e8f;&#x5217;&#x53f7;, &#x7528;&#x4e8e;&#x68c0;&#x6d4b;&#x9519;&#x8bef;">
<node CREATED="1447117142710" ID="ID_1156621162" MODIFIED="1447117192272" TEXT="&#x4e00;&#x822c;&#x8bf7;&#x6c42;&#x4e0e;&#x5e94;&#x7b54;&#x662f;&#x9700;&#x8981;&#x5e8f;&#x5217;&#x53f7;&#x7684;&#xff0c;&#x6b64;&#x65f6;&#x5e8f;&#x5217;&#x53f7;&#x7528;&#x4e8e;&#x5339;&#x914d;&#x8bf7;&#x6c42;&#x4e0e;&#x5e94;&#x7b54;"/>
<node CREATED="1447117197084" ID="ID_1277178755" MODIFIED="1447117241248" TEXT="&#x4f46;&#x662f;&#x5bf9;&#x4e8e;notification&#x5219;&#x4e00;&#x822c;&#x4e0d;&#x9700;&#x8981;&#x5e8f;&#x5217;&#x53f7;&#xff0c;&#x56e0;&#x4e3a;&#x6b64;&#x65f6;&#x4e0d;&#x671f;&#x671b;&#x4f1a;&#x6709;&#x4e00;&#x4e2a;&#x5e94;&#x7b54;"/>
</node>
<node CREATED="1333188863307" ID="ID_98613947" MODIFIED="1447483143782">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      __u32 nlmsg_pid : &#25351;&#23450;&#28040;&#24687;&#30340;&#21457;&#36865;&#26041;&#65292;&#19968;&#33324;&#26159;&#22312;&#21457;&#36865;&#26041;&#30340;&#36827;&#31243;ID&#30340;&#22522;&#30784;&#19978;&#21152;&#19978;&#20559;&#31227;&#24471;&#21040;&#12290;&#29992;&#20110;&#36991;&#20813;&#23558;&#28040;&#24687;&#29615;&#22238;&#32473;&#33258;&#24049;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1447483411488" FOLDED="true" ID="ID_324020403" MODIFIED="1447488696427" TEXT="struct nlattr">
<node CREATED="1447483462421" ID="ID_883546828" MODIFIED="1447483506695">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      __u16 nla_len
    </p>
    <p>
      &#23646;&#24615;&#38271;&#24230;&#65292;&#21253;&#21547;&#23646;&#24615;&#22836;&#37096;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447483462421" ID="ID_1314994287" MODIFIED="1447483519871">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      __u16 nla_type
    </p>
    <p>
      &#23646;&#24615;&#30340;&#31867;&#22411;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447483571749" FOLDED="true" ID="ID_1258061790" MODIFIED="1447488981333" TEXT="struct nla_policy">
<node CREATED="1447483573742" FOLDED="true" ID="ID_1563850479" MODIFIED="1447488977102" TEXT="uint16_t type">
<node CREATED="1447488904800" ID="ID_275035603" MODIFIED="1447488905629" TEXT="NLA_UNSPEC"/>
<node CREATED="1447488913202" ID="ID_487173593" MODIFIED="1447488913797" TEXT="NLA_U8"/>
<node CREATED="1447488923127" ID="ID_1595458816" MODIFIED="1447488923779" TEXT="NLA_U16"/>
<node CREATED="1447488933780" ID="ID_1233109377" MODIFIED="1447488934721" TEXT="NLA_U32"/>
<node CREATED="1447488942791" ID="ID_580665419" MODIFIED="1447488943455" TEXT="NLA_U64"/>
<node CREATED="1447488951954" ID="ID_326921006" MODIFIED="1447488952648" TEXT="NLA_STRING"/>
<node CREATED="1447488959787" ID="ID_1539324677" MODIFIED="1447488960431" TEXT="NLA_FLAG"/>
<node CREATED="1447488967378" ID="ID_637505722" MODIFIED="1447488967852" TEXT="NLA_MSECS"/>
<node CREATED="1447488974855" ID="ID_1685441365" MODIFIED="1447488975296" TEXT="NLA_NESTED"/>
</node>
<node CREATED="1447483573742" ID="ID_565801397" MODIFIED="1447483595818" TEXT="uint16_t minlen"/>
<node CREATED="1447483573742" ID="ID_1353865597" MODIFIED="1447483610951" TEXT="uint16_t maxlen"/>
</node>
</node>
<node CREATED="1386396635724" FOLDED="true" ID="ID_604040373" MODIFIED="1447569316478">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      netlink socket
    </p>
    <p>
      &#29992;&#25143;&#23618;&#25509;&#21475;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447484204065" FOLDED="true" ID="ID_1314785051" MODIFIED="1447489510448" TEXT="netlink socket&#x64cd;&#x4f5c;">
<node CREATED="1386396690023" ID="ID_1966234570" MODIFIED="1447484262798">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#21019;&#24314;netlink socket
    </p>
    <p>
      struct nl_sock *nl_socket_alloc(void)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1386396984940" ID="ID_1109854427" MODIFIED="1447484657557">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#36830;&#25509;&#21040;&#21327;&#35758;
    </p>
    <p>
      int nl_connect(struct nl_sock *sk, int&#160;protocol)&#160;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1386396721476" ID="ID_501663606" MODIFIED="1447484299769">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#37322;&#25918;netlink socket
    </p>
    <p>
      void nl_socket_free(struct nl_sock *sk)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1386396761200" FOLDED="true" ID="ID_730676721" MODIFIED="1447486631958">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#33719;&#21462;&#19979;&#19968;&#20010;&#24207;&#21015;&#21495;
    </p>
    <p>
      unsigned int nl_socket_use_seq(struct nl_sock *sk)
    </p>
  </body>
</html></richcontent>
<node CREATED="1386396764368" ID="ID_853807882" MODIFIED="1386396798137" TEXT="&#x5728;&#x6b64;socket&#x4e0a;&#x53d1;&#x9001;netlink message&#x65f6;&#x4f7f;&#x7528;seq"/>
</node>
<node CREATED="1386396810620" ID="ID_514969513" MODIFIED="1447484556251">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#20851;&#38381;&#24207;&#21015;&#21495;&#26816;&#26597;&#65292;&#21363;&#22312;&#27492;socket&#19978;&#21457;&#36865;netlink message&#26102;&#19981;&#20351;&#29992;seq&#65292;&#21363;seq&#20026;0
    </p>
    <p>
      void nl_socket_disable_seq_check(struct nl_sock *sk)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1386398273188" FOLDED="true" ID="ID_1528948823" MODIFIED="1447486629757">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#33719;&#21462;nl_socket&#23545;&#24212;&#30340;&#25991;&#20214;&#21477;&#26564;&#65292;&#29992;&#20110;&#35835;&#20889;&#21644;&#36718;&#35810;(select)
    </p>
    <p>
      int nl_socket_get_fd(const struct nl_sock *sk)
    </p>
  </body>
</html></richcontent>
<node CREATED="1386398277956" ID="ID_350645644" MODIFIED="1386398321036" TEXT="nl_sock&#x662f;&#x57fa;&#x4e8e;socket&#x7684;,&#x56e0;&#x6b64;&#x53ef;&#x4ee5;&#x53d6;&#x51fa;fd&#x7528;&#x4e8e;&#x8fdb;&#x884c;&#x5176;&#x4ed6;&#x8bbe;&#x7f6e;"/>
</node>
<node CREATED="1447485758352" ID="ID_950749096" MODIFIED="1447485797042">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#35774;&#32622;&#25509;&#25910;&#32531;&#20914;&#21306;&#22823;&#23567;
    </p>
    <p>
      int nl_socket_set_msg_buf_size(struct nl_sock *sk, size_t bufsize)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447486464711" FOLDED="true" ID="ID_1718555960" MODIFIED="1447486626372">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#23558;socket&#35774;&#20026;&#38750;&#38459;&#22622;&#27169;&#24335;
    </p>
    <p>
      void nl_socket_enable_msg_peek(struct nl_sock *sk)
    </p>
  </body>
</html></richcontent>
<node CREATED="1447486611344" ID="ID_1852708586" MODIFIED="1447486624045" TEXT="socket&#x9ed8;&#x8ba4;&#x4e3a;&#x963b;&#x585e;&#x6a21;&#x5f0f;"/>
</node>
<node CREATED="1447486515002" FOLDED="true" ID="ID_1172689261" MODIFIED="1447489165661">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#31105;&#27490;&#28040;&#24687;&#26597;&#25506;
    </p>
    <p>
      void nl_socket_disable_msg_peek(struct nl_sock *sk)
    </p>
  </body>
</html></richcontent>
<node CREATED="1447486546830" ID="ID_1455746089" MODIFIED="1447486579766" TEXT="&#x6d88;&#x606f;&#x67e5;&#x63a2;&#x662f;&#x6307;&#x4ec5;&#x4ec5;&#x67e5;&#x770b;&#x6d88;&#x606f;&#x7684;&#x5927;&#x5c0f;&#x5e76;&#x4e0d;&#x771f;&#x6b63;&#x8bfb;&#x53d6;&#x6d88;&#x606f;"/>
<node CREATED="1447486592169" ID="ID_990001955" MODIFIED="1447486605334" TEXT="&#x6d88;&#x606f;&#x67e5;&#x63a2;&#x9ed8;&#x8ba4;&#x662f;&#x6253;&#x5f00;&#x7684;"/>
</node>
<node CREATED="1447140139142" ID="ID_1314077463" MODIFIED="1447489508541">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#31105;&#27490;&#33258;&#21160;&#22238;&#22797;
    </p>
    <p>
      void nl_socket_disable_auto_ack(struct nl_sock *sk)
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447484598288" FOLDED="true" ID="ID_1693329896" MODIFIED="1447489460486" TEXT="&#x5bfb;&#x5740;&#x64cd;&#x4f5c;">
<node CREATED="1447485842838" FOLDED="true" ID="ID_1464116845" MODIFIED="1447489420645">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#35774;&#32622;local port
    </p>
    <p>
      void nl_socket_set_local_port(struct nl_sock *sk, uint32_t port)
    </p>
  </body>
</html></richcontent>
<node CREATED="1447485875279" ID="ID_237313268" MODIFIED="1447489411765">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#23427;&#26159;&#27492;netlink socket&#30340;&#26631;&#35782;&#65292;local port&#23558;&#34987;&#22635;&#20837;netlink&#28040;&#24687;&#22836;&#37096;&#30340;port&#23383;&#27573;&#65292;&#21363;struct nlmsghdr *nlh -&gt;nlmsg_pid&#23383;&#27573;&#12290;
    </p>
    <p>
      
    </p>
    <p>
      &#19968;&#33324;&#26469;&#35828;&#65292;&#29992;&#25143;&#19981;&#38656;&#35201;&#33258;&#24049;&#35774;&#32622;local port&#65292;&#31995;&#32479;&#20250;&#23558;&#36827;&#31243;pid&#36827;&#34892;&#19968;&#23450;&#20559;&#31227;&#26500;&#25104;local port&#65292;&#36825;&#26679;&#19968;&#20010;&#36827;&#31243;&#21487;&#20197;&#25171;&#24320;&#22810;&#20010;netlink socket&#12290;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447486348242" ID="ID_1100304418" MODIFIED="1447486385016" TEXT="&#x7528;&#x4e8e;&#x53d1;&#x9001;&#x65f6;&#x907f;&#x514d;&#x56de;&#x73af;"/>
</node>
<node CREATED="1447486086195" FOLDED="true" ID="ID_678786076" MODIFIED="1447489308642">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#35774;&#32622;peer port
    </p>
    <p>
      void nl_socket_set_peer_port(struct nl_sock *sk, uint32_t port)
    </p>
  </body>
</html></richcontent>
<node CREATED="1447139793055" ID="ID_285046749" MODIFIED="1447140024749">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#19982;&#27492;netlink socket&#36890;&#20449;&#30340;&#23545;&#31471;netlink socket&#30340;&#26631;&#35782;&#65292;&#29992;&#20110;&#23547;&#22336;
    </p>
    <p>
      &#22914;&#26524;&#19981;&#25351;&#23450;&#65292;&#21017;&#26159;&#19982;&#21516;&#21327;&#35758;&#26063;&#30340;&#20869;&#26680;&#20013;&#30340;netlink socket&#36890;&#20449;&#65292;&#36825;&#26159;&#20856;&#22411;&#24773;&#20917;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447486128767" ID="ID_926015465" MODIFIED="1447486188052" TEXT="&#x7528;&#x6237;&#x7a7a;&#x95f4;&#x7a0b;&#x5e8f;&#x4e00;&#x822c;&#x4e0e;&#x5185;&#x6838;&#x901a;&#x4fe1;&#xff0c;&#x5185;&#x6838;&#x7684;port&#x4e3a;0&#xff0c;&#x6240;&#x4ee5;&#x7528;&#x6237;&#x7a7a;&#x95f4;&#x7a0b;&#x5e8f;&#x4e00;&#x822c;&#x4e0d;&#x7528;&#x8bbe;&#x7f6e;peer port"/>
<node CREATED="1447486348242" ID="ID_1241910060" MODIFIED="1447486360708" TEXT="&#x7528;&#x4e8e;&#x53d1;&#x9001;&#x65f6;&#x5bfb;&#x5740;"/>
</node>
<node CREATED="1447486238099" FOLDED="true" ID="ID_1412300652" MODIFIED="1447489291153">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#35774;&#32622;peer groups
    </p>
    <p>
      void nl_socket_set_peer_groups(struct nl_sock *sk, uint32_t groups)
    </p>
  </body>
</html></richcontent>
<node CREATED="1447375617129" ID="ID_651573817" MODIFIED="1447375677646" TEXT="&#x4ece;&#x6b64;socket&#x4e0a;&#x53d1;&#x9001;&#x6d88;&#x606f;&#x65f6;&#x7684;&#x76ee;&#x7684;&#x7ec4;"/>
<node CREATED="1447486128767" ID="ID_1198725162" MODIFIED="1447486317019" TEXT="&#x7528;&#x6237;&#x7a7a;&#x95f4;&#x7a0b;&#x5e8f;&#x4e00;&#x822c;&#x4e0e;&#x5185;&#x6838;&#x901a;&#x4fe1;&#xff0c;&#x6d88;&#x606f;&#x662f;&#x5355;&#x64ad;&#x53d1;&#x9001;&#xff0c;&#x6240;&#x4ee5;&#x7528;&#x6237;&#x7a7a;&#x95f4;&#x7a0b;&#x5e8f;&#x4e00;&#x822c;&#x4e0d;&#x7528;&#x8bbe;&#x7f6e;peer groups"/>
<node CREATED="1447486348242" ID="ID_1670534806" MODIFIED="1447486360708" TEXT="&#x7528;&#x4e8e;&#x53d1;&#x9001;&#x65f6;&#x5bfb;&#x5740;"/>
</node>
<node CREATED="1447486749566" FOLDED="true" ID="ID_1134230120" MODIFIED="1447487222683">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#26681;&#25454;&#21517;&#23383;&#26597;&#25214;generic netlink family(or channel)
    </p>
    <p>
      int genl_ctrl_resolve(struct nl_sock *sk, const char *name)
    </p>
  </body>
</html></richcontent>
<node CREATED="1447486916914" ID="ID_1760293708" MODIFIED="1447487148204">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      generic netlink family&#23545;&#24212;&#20102;netlink&#28040;&#24687;&#22836;&#37096;&#20013;&#30340;type&#23383;&#27573;&#65292;&#23427;&#26159;&#19968;&#20010;&#25968;&#23383;&#12290;
    </p>
    <p>
      &#19968;&#33324;&#26469;&#35828;&#23427;&#26159;&#20869;&#26680;&#27169;&#22359;&#22312;&#27880;&#20876;generic netlink family&#26102;&#21160;&#24577;&#29983;&#25104;&#30340;&#65292;&#26080;&#27861;&#39044;&#20808;&#24471;&#30693;&#12290;
    </p>
    <p>
      &#25152;&#20197;&#36825;&#37324;&#38656;&#35201;&#20351;&#29992;&#39044;&#20808;&#30693;&#36947;&#30340;&#21517;&#23383;&#21435;&#35299;&#26512;&#20986;&#21160;&#24577;&#29983;&#25104;&#30340;&#25968;&#23383;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447486806976" FOLDED="true" ID="ID_1951898454" MODIFIED="1447487223804">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#26681;&#25454;&#21517;&#23383;&#26597;&#25214;generic netlink family(or channel)&#25152;&#22312;&#30340;&#32452;
    </p>
    <p>
      int genl_ctrl_resolve_grp(struct nl_sock *sk, const char *family_name, const char *grp_name)
    </p>
  </body>
</html></richcontent>
<node CREATED="1447486916914" ID="ID_764461555" MODIFIED="1447487218998">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      group&#26159;&#19968;&#20010;&#25968;&#23383;&#65292;&#19968;&#33324;&#26469;&#35828;&#23427;&#26159;&#20869;&#26680;&#27169;&#22359;&#22312;&#27880;&#20876;generic netlink family&#26102;&#21160;&#24577;&#29983;&#25104;&#30340;&#65292;&#26080;&#27861;&#39044;&#20808;&#24471;&#30693;&#12290;
    </p>
    <p>
      &#25152;&#20197;&#36825;&#37324;&#38656;&#35201;&#20351;&#29992;&#39044;&#20808;&#30693;&#36947;&#30340;&#21517;&#23383;&#21435;&#35299;&#26512;&#20986;&#21160;&#24577;&#29983;&#25104;&#30340;&#25968;&#23383;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1386396880901" ID="ID_942702565" MODIFIED="1447484697067">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#21152;&#20837;&#32452;
    </p>
    <p>
      int nl_socket_add_memberships(struct nl_sock *sk, int group, ...)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1386396890756" ID="ID_469335525" MODIFIED="1447484723542">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#31163;&#24320;&#32452;
    </p>
    <p>
      int nl_socket_drop_memberships(struct nl_sock *sk, int group, ...)
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1386400200226" FOLDED="true" ID="ID_262299953" MODIFIED="1447569304437" TEXT="&#x63a5;&#x6536;&#x6d88;&#x606f;">
<node CREATED="1386400207969" ID="ID_1133626065" MODIFIED="1447487833049">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      int nl_recvmsgs_default&#160;&#160;(struct nl_sock *sk)
    </p>
  </body>
</html></richcontent>
<node CREATED="1447184440680" ID="ID_1428567125" MODIFIED="1447184470961">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_message_program_mode_3.JPG" />
  </body>
</html></richcontent>
<node CREATED="1447488079493" ID="ID_952079013" LINK="#ID_1797552211" MODIFIED="1447488192000" TEXT="&#x5728;&#x6536;&#x5305;&#x8fc7;&#x7a0b;&#x4e2d;&#xff0c;&#x7528;&#x6237;&#x53ef;&#x4ee5;&#x7528;&#x81ea;&#x5df1;&#x7684;&#x51fd;&#x6570;&#x53d6;&#x4ee3;&#x7cfb;&#x7edf;&#x9ed8;&#x8ba4;&#x7684;&#x51fd;&#x6570;&#x4ee5;&#x5b9a;&#x5236;&#x81ea;&#x5df1;&#x7684;&#x884c;&#x4e3a;"/>
<node CREATED="1447488198610" ID="ID_1255218674" LINK="#ID_291436361" MODIFIED="1447488471807" TEXT="&#x5982;&#x679c;&#x4f7f;&#x7528;&#x7cfb;&#x7edf;&#x9ed8;&#x8ba4;&#x51fd;&#x6570;&#xff0c;&#x5219;&#x5728;&#x5904;&#x7406;&#x6536;&#x5305;&#x8fc7;&#x7a0b;&#x4e2d;&#xff0c;&#x4f1a;&#x5728;&#x7279;&#x5b9a;&#x7684;&#x9636;&#x6bb5;&#x8c03;&#x7528;&#x7279;&#x5b9a;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;&#xff0c;&#x7528;&#x6237;&#x53ef;&#x4ee5;&#x6307;&#x5b9a;&#x8fd9;&#x4e9b;&#x56de;&#x8c03;&#x51fd;&#x6570;"/>
</node>
</node>
</node>
<node CREATED="1386398946550" FOLDED="true" ID="ID_1092655751" MODIFIED="1447488660118" TEXT="&#x53d1;&#x9001;&#x6d88;&#x606f;">
<node CREATED="1386399042125" ID="ID_1030760164" MODIFIED="1386399191258">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      int nl_send_auto&#160;&#160;(struct nl_sock *sk, struct nl_msg *msg)
    </p>
    <p>
      &#27492;&#20989;&#25968;&#22312;&#35843;&#29992;nl_complete_msg(sk, msg)&#23436;&#25104;&#26500;&#36896;&#28040;&#24687;&#21518;&#35843;&#29992;nl_send
    </p>
    <p>
      &#21487;&#20197;&#35843;&#29992;nl_cb_overwrite_send()&#26469;&#35774;&#32622;&#35753;nl_send_auto&#35843;&#29992;&#21035;&#30340;&#21457;&#36865;&#20989;&#25968;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447142132266" ID="ID_1476287673" MODIFIED="1447142146683">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_message_program_mode_2.JPG" />
  </body>
</html></richcontent>
<node CREATED="1447488079493" ID="ID_1922570690" LINK="#ID_1797552211" MODIFIED="1447488601124" TEXT="&#x5728;&#x53d1;&#x5305;&#x8fc7;&#x7a0b;&#x4e2d;&#xff0c;&#x7528;&#x6237;&#x53ef;&#x4ee5;&#x7528;&#x81ea;&#x5df1;&#x7684;&#x51fd;&#x6570;&#x53d6;&#x4ee3;&#x7cfb;&#x7edf;&#x9ed8;&#x8ba4;&#x7684;&#x51fd;&#x6570;&#x4ee5;&#x5b9a;&#x5236;&#x81ea;&#x5df1;&#x7684;&#x884c;&#x4e3a;"/>
<node CREATED="1447488198610" ID="ID_509725721" LINK="#ID_291436361" MODIFIED="1447488618424" TEXT="&#x5982;&#x679c;&#x4f7f;&#x7528;&#x7cfb;&#x7edf;&#x9ed8;&#x8ba4;&#x51fd;&#x6570;&#xff0c;&#x5219;&#x5728;&#x5904;&#x7406;&#x53d1;&#x5305;&#x8fc7;&#x7a0b;&#x4e2d;&#xff0c;&#x4f1a;&#x5728;&#x7279;&#x5b9a;&#x7684;&#x9636;&#x6bb5;&#x8c03;&#x7528;&#x7279;&#x5b9a;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;&#xff0c;&#x7528;&#x6237;&#x53ef;&#x4ee5;&#x6307;&#x5b9a;&#x8fd9;&#x4e9b;&#x56de;&#x8c03;&#x51fd;&#x6570;">
<node CREATED="1386399268632" ID="ID_1054649213" MODIFIED="1447142195066">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      int nl_sendmsg&#160;&#160;(struct nl_sock *sk, struct nl_msg *msg, struct msghdr *hdr)
    </p>
    <p>
      &#27492;&#20989;&#25968;&#23558;&#35843;&#29992;nl_sock&#20013;&#31867;&#22411;&#20026;NL_CB_MSG_OUT&#30340;&#22238;&#35843;&#20989;&#25968;&#20197;&#23545;&#25968;&#25454;&#21253;&#20570;&#26368;&#21518;&#30340;&#22788;&#29702;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node CREATED="1386399419290" ID="ID_114253284" MODIFIED="1447142244237">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      int nl_sendto(struct nl_sock *sk, void *buf, size_t size)
    </p>
    <p>
      &#27492;&#20989;&#25968;&#19981;&#23545;&#28040;&#24687;&#20570;&#20219;&#20309;&#22788;&#29702;,&#30452;&#25509;&#21457;&#36865;&#32473;&#24213;&#23618;&#30340;socket&#65306;sendto()
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1386399504851" ID="ID_1810500505" MODIFIED="1386399506302" TEXT="int &#x9;nl_send_simple  (struct nl_sock *sk, int type, int flags, void *buf, size_t size)">
<node CREATED="1386399512242" ID="ID_848761397" LINK="#ID_1030760164" MODIFIED="1386399527673" TEXT="nl_send_auto"/>
</node>
<node CREATED="1386399796919" ID="ID_862924916" MODIFIED="1386399903000">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      void nl_send_auto_complete (struct nl_sock *sk, struct nl_msg *msg)
    </p>
    <p>
      &#26159;nl_send_auto&#30340;&#21035;&#21517;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447485640139" FOLDED="true" ID="ID_1797552211" MODIFIED="1447488406735" TEXT="&#x6536;&#x53d1;&#x6d88;&#x606f;&#x65f6;&#x5b9a;&#x5236;&#x7528;&#x6237;&#x81ea;&#x5df1;&#x7684;&#x884c;&#x4e3a;">
<node CREATED="1447487584435" ID="ID_444383972" LINK="#ID_1428567125" MODIFIED="1447487873068">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      void nl_cb_overwrite_recvmsgs(struct nl_cb *cb,
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;int (*func)(struct nl_sock *, struct nl_cb *))
    </p>
  </body>
</html></richcontent>
<node CREATED="1447487842300" ID="ID_98833522" MODIFIED="1447487861726" TEXT="&#x8ba9;nl_recvmsgs_default&#x8c03;&#x7528;&#x522b;&#x7684;&#x63a5;&#x6536;&#x51fd;&#x6570; &#x800c;&#x4e0d;&#x662f;nl_recvmsgs"/>
</node>
<node CREATED="1447487637550" ID="ID_1328324359" MODIFIED="1447487670458">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      void nl_cb_overwrite_recv(struct nl_cb *cb,
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;int (*func)(struct nl_sock *, struct sockaddr_nl *,
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; unsigned char **, struct ucred **))
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447487708490" ID="ID_1622074165" MODIFIED="1447487714452">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      void nl_cb_overwrite_send(struct nl_cb *cb,
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;int (*func)(struct nl_sock *, struct nl_msg *))
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1386397318221" FOLDED="true" ID="ID_291436361" MODIFIED="1447488458029">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#25351;&#23450;&#25910;&#21457;&#19981;&#21516;&#38454;&#27573;&#30340;&#22238;&#35843;&#20989;&#25968;
    </p>
    <p>
      &#27599;&#20010;netlink socket&#37117;&#20851;&#32852;&#20102;&#19968;&#20010;struct nl_cb *cb,
    </p>
    <p>
      &#23427;&#26159;&#19968;&#20010;callback&#38598;&#21512;,&#34920;&#31034;&#19981;&#21516;&#24773;&#20917;&#19979;&#38656;&#35201;&#35843;&#29992;&#30340;callback
    </p>
    <p>
      &#26377;&#20960;&#31181;&#26041;&#24335;&#23558;&#19968;&#20010;struct nl_cb *cb&#20851;&#32852;&#21040;netlink socket
    </p>
  </body>
</html></richcontent>
<node CREATED="1386397511387" ID="ID_1302522621" MODIFIED="1386397561897">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct nl_cb *nl_socket_get_cb(const struct nl_sock *sk)
    </p>
    <p>
      void nl_socket_set_cb(struct nl_sock *sk, struct nl_cb *cb)
    </p>
    <p>
      &#27492;&#31181;&#26041;&#24335;&#39318;&#20808;&#21021;&#22987;&#21270;&#22909;struct nl_cb&#20877;&#23558;&#20854;&#20851;&#32852;&#21040;socket
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1386397574933" FOLDED="true" ID="ID_703184826" MODIFIED="1447488455861" TEXT="int nl_socket_modify_cb(struct nl_sock *sk, &#xa;                                      enum nl_cb_type type, &#xa;                                      enum nl_cb_kind kind,&#xa;                                      nl_recvmsg_msg_cb_t func, &#xa;                                      void *arg)&#xa;&#x6b64;&#x79cd;&#x65b9;&#x5f0f;&#x9690;&#x5f0f;&#x8bbe;&#x7f6e;socket&#x67d0;&#x79cd;&#x7c7b;&#x578b;&#x7684;callback">
<node CREATED="1447137361398" FOLDED="true" ID="ID_284837182" MODIFIED="1447184324328" TEXT="enum nl_cb_type">
<node CREATED="1447137384281" ID="ID_902464772" MODIFIED="1447137385122" TEXT="NL_CB_VALID ">
<node CREATED="1447137988179" ID="ID_1533441673" MODIFIED="1447138027197" TEXT="netlink&#x6d88;&#x606f;&#x7ecf;&#x68c0;&#x67e5;&#x5408;&#x6cd5;&#x65f6;&#x5e94;&#x8be5;&#x8c03;&#x7528;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;"/>
</node>
<node CREATED="1447137398072" ID="ID_909298955" MODIFIED="1447137400576" TEXT="NL_CB_FINISH">
<node CREATED="1447137426376" ID="ID_112510785" MODIFIED="1447137480682" TEXT="&#x6570;&#x636e;&#x88ab;&#x5206;&#x4e3a;&#x591a;&#x4e2a;netlink&#x6d88;&#x606f;&#x65f6;&#xff0c;&#x6536;&#x5230;&#x6700;&#x540e;&#x6d88;&#x606f;&#x65f6;&#x5e94;&#x8be5;&#x8c03;&#x7528;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;"/>
</node>
<node CREATED="1447137511841" ID="ID_460450611" MODIFIED="1447137513387" TEXT="NL_CB_OVERRUN"/>
<node CREATED="1447137532503" ID="ID_1518332287" MODIFIED="1447137533597" TEXT="NL_CB_SKIPPED"/>
<node CREATED="1447137546956" ID="ID_498490601" MODIFIED="1447137547957" TEXT="NL_CB_ACK ">
<node CREATED="1447137553500" ID="ID_699932281" MODIFIED="1447137574843" TEXT="&#x6536;&#x5230;ACK&#x6d88;&#x606f;&#x65f6;&#x5e94;&#x8be5;&#x8c03;&#x7528;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;"/>
</node>
<node CREATED="1447137595223" ID="ID_1483886838" MODIFIED="1447137601434" TEXT="NL_CB_MSG_IN">
<node CREATED="1447137610160" ID="ID_970214508" MODIFIED="1447137672546">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#25910;&#21040;&#27599;&#20010;&#28040;&#24687;&#26102;&#24212;&#35813;&#35843;&#29992;&#30340;&#22238;&#35843;&#20989;&#25968;&#65292;
    </p>
    <p>
      &#27880;&#24847;&#22312;&#36825;&#20010;&#28857;&#28040;&#24687;&#30340;&#21512;&#27861;&#24615;&#36824;&#27809;&#26377;&#24471;&#21040;&#26816;&#26597;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447137693737" ID="ID_878654832" MODIFIED="1447137696063" TEXT="NL_CB_MSG_OUT">
<node CREATED="1447137697411" ID="ID_1620882921" MODIFIED="1447137720391" TEXT="&#x53d1;&#x9001;&#x6d88;&#x606f;&#x65f6;&#x5e94;&#x8be5;&#x8c03;&#x7528;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;"/>
</node>
<node CREATED="1447137740271" ID="ID_654055931" MODIFIED="1447137747075" TEXT="NL_CB_INVALID">
<node CREATED="1447137747845" ID="ID_1136428040" MODIFIED="1447137767690" TEXT="&#x63a5;&#x6536;&#x5230;&#x9519;&#x8bef;&#x6d88;&#x606f;&#x65f6;&#x5e94;&#x8be5;&#x8c03;&#x7528;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;"/>
</node>
<node CREATED="1447137781487" ID="ID_1254144812" MODIFIED="1447137783283" TEXT="NL_CB_SEQ_CHECK ">
<node CREATED="1447137786377" ID="ID_283608629" MODIFIED="1447137881149" TEXT="&#x82e5;&#x6b64;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x88ab;&#x8bbe;&#x7f6e;&#xff0c;&#x4e14;&#x5e8f;&#x5217;&#x53f7;&#x68c0;&#x67e5;&#x6ca1;&#x6709;&#x88ab;disable&#xff0c;&#xa;&#x5219;&#x6536;&#x5305;&#x65f6;&#x8c03;&#x7528;&#x6b64;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x68c0;&#x67e5;&#x5e8f;&#x5217;&#x53f7;&#x800c;&#x4e0d;&#x662f;&#x8c03;&#x7528;&#x7cfb;&#x7edf;&#x9ed8;&#x8ba4;&#x7684;&#x68c0;&#x67e5;&#x51fd;&#x6570;"/>
</node>
<node CREATED="1447137905226" ID="ID_578079003" MODIFIED="1447137905837" TEXT="NL_CB_SEND_ACK">
<node CREATED="1447137553500" ID="ID_1352909304" MODIFIED="1447184137354" TEXT="&#x6536;&#x5230;&#x7684;&#x6d88;&#x606f;&#x9700;&#x8981;&#x53d1;&#x9001;ACK&#xff0c;&#x4e5f;&#x5c31;&#x662f;&#x6d88;&#x606f;&#x4e2d;NLM_F_ACK&#x88ab;&#x7f6e;&#x4f4d;&#xff0c;&#x6b64;&#x65f6;&#x5e94;&#x8be5;&#x8c03;&#x7528;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;"/>
</node>
<node CREATED="1447137915280" ID="ID_1989261536" MODIFIED="1447137915844" TEXT="NL_CB_DUMP_INTR"/>
</node>
<node CREATED="1447138160060" FOLDED="true" ID="ID_1001661892" MODIFIED="1447138215442" TEXT="enum nl_cb_kind">
<node CREATED="1447138177556" ID="ID_1306374909" MODIFIED="1447138178837" TEXT="NL_CB_DEFAULT"/>
<node CREATED="1447138191151" ID="ID_422611671" MODIFIED="1447138191964" TEXT="NL_CB_VERBOSE"/>
<node CREATED="1447138202999" ID="ID_1208070761" MODIFIED="1447138203703" TEXT="NL_CB_DEBUG "/>
<node CREATED="1447138212414" ID="ID_1865196762" MODIFIED="1447138213040" TEXT="NL_CB_CUSTOM"/>
</node>
</node>
<node CREATED="1386397788513" ID="ID_1597520290" MODIFIED="1386397850486">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      int nl_recvmsgs&#160;&#160;(struct nl_sock *sk, struct nl_cb *cb)
    </p>
    <p>
      &#27492;&#31181;&#26041;&#24335;&#22312;&#25910;&#21253;&#26102;&#20851;&#32852;struct nl_cb *cb,&#23646;&#20110;&#19968;&#27425;&#24615;&#26377;&#25928;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1447112206621" FOLDED="true" ID="ID_1447533157" MODIFIED="1447489005194" TEXT="netlink&#x5bfb;&#x5740;">
<node CREATED="1447112217841" ID="ID_1641137340" MODIFIED="1447112229201">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_addressing_1.JPG" />
  </body>
</html></richcontent>
<node CREATED="1447112231901" ID="ID_20849100" MODIFIED="1447112259141" TEXT="user space to kernel">
<node CREATED="1447112354082" ID="ID_1336603295" MODIFIED="1447112369692">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_addressing_2.JPG" />
  </body>
</html></richcontent>
<node CREATED="1447113560543" ID="ID_306082717" MODIFIED="1447113611243" TEXT="&#x7528;&#x6237;&#x7a7a;&#x95f4;&#x7a0b;&#x5e8f;&#x5411;&#x5185;&#x6838;&#x53d1;&#x51fa;&#x4e00;&#x4e2a;&#x8bf7;&#x6c42;&#xff0c;&#x7136;&#x540e;&#x5185;&#x6838;&#x505a;&#x51fa;&#x5e94;&#x7b54;"/>
</node>
</node>
<node CREATED="1447112261251" ID="ID_1156305464" MODIFIED="1447112269721" TEXT="user space to user space">
<node CREATED="1447112373372" ID="ID_188463582" MODIFIED="1447112387102">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_addressing_3.JPG" />
  </body>
</html></richcontent>
<node CREATED="1447113831393" ID="ID_1004268814" MODIFIED="1447113954583">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#29992;&#25143;&#31354;&#38388;&#31243;&#24207;&#20043;&#38388;&#36827;&#34892;&#36890;&#20449;&#12290;
    </p>
    <p>
      &#36825;&#31181;&#36890;&#20449;&#19981;&#20165;&#38480;&#20110;2&#20010;&#36827;&#31243;&#20043;&#38388;&#65292;&#20063;&#21487;&#20197;&#36890;&#36807;&#24191;&#25773;&#23558;&#19968;&#20010;&#28040;&#24687;&#21457;&#36865;&#21040;&#19968;&#20010;&#32452;&#20869;&#30340;&#22810;&#20010;&#36827;&#31243;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1447112291522" ID="ID_704690108" MODIFIED="1447112292182" TEXT="User space listening to kernel notifications">
<node CREATED="1447112389952" ID="ID_1122888208" MODIFIED="1447112408692">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_addressing_4.JPG" />
  </body>
</html></richcontent>
<node CREATED="1447114621823" ID="ID_747179548" MODIFIED="1447114738203" TEXT="&#x53e6;&#x4e00;&#x79cd;&#x5e38;&#x89c1;&#x7684;&#x60c5;&#x5f62;&#x662f;&#x7528;&#x6237;&#x7a7a;&#x95f4;&#x8fdb;&#x7a0b;&#x76d1;&#x542c;&#x5185;&#x6838;&#x4e8b;&#x4ef6;&#x4ee5;&#x505a;&#x51fa;&#x53cd;&#x5e94;&#xff0c;&#x6b64;&#x65f6;&#x7528;&#x6237;&#x7a7a;&#x95f4;&#x8fdb;&#x7a0b;&#x4e00;&#x822c;&#x9700;&#x8981;&#x52a0;&#x5165;&#x4e00;&#x4e2a;&#x7279;&#x5b9a;&#x7ec4;&#x3002;&#xa;&#x5185;&#x6838;&#x4f1a;&#x5c06;&#x7279;&#x5b9a;&#x4e8b;&#x4ef6;&#x53d1;&#x9001;&#x5230;&#x8fd9;&#x4e2a;&#x7ec4;&#x3002;"/>
</node>
</node>
</node>
<node CREATED="1447113678733" ID="ID_537290" MODIFIED="1447113772583" TEXT="&#x5bfb;&#x5740;&#x65f6;&#x7528;&#x8fdb;&#x7a0b;&#x7684;pid&#x4f5c;&#x4e3a;&#x76ee;&#x7684;&#x5730;&#x5740;&#xff0c;0&#x8868;&#x793a;&#x5185;&#x6838;&#x3002;&#x6bcf;&#x4e2a;&#x534f;&#x8bae;&#x65cf;&#x7684;&#x5bfb;&#x5740;&#x7a7a;&#x95f4;&#x76f8;&#x4e92;&#x72ec;&#x7acb;&#x3002;"/>
</node>
<node CREATED="1447120658263" FOLDED="true" ID="ID_939087658" MODIFIED="1447576772229" TEXT="&#x7528;&#x6237;&#x7a7a;&#x95f4;&#x7f16;&#x7a0b;&#x6a21;&#x578b;">
<node CREATED="1447120711998" ID="ID_951580674" MODIFIED="1447375023936">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_message_program_mode_1.JPG" />
  </body>
</html></richcontent>
<node CREATED="1447139030160" ID="ID_1869597033" MODIFIED="1447139203603">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#20026;netlink&#28040;&#24687;&#35774;&#32622;&#22238;&#35843;&#20989;&#25968;&#26102;&#65306;
    </p>
    <p>
      type&#19968;&#33324;&#35774;&#32622;&#20026;NL_CB_VALID&#65292;&#34920;&#31034;&#28040;&#24687;&#21512;&#27861;&#26102;&#35843;&#29992;&#27492;&#22238;&#35843;&#20989;&#25968;
    </p>
    <p>
      kind&#19968;&#33324;&#35774;&#32622;&#20026;NL_CB_CUSTOM&#65292;&#34920;&#31034;&#35843;&#29992;&#36825;&#37324;&#25351;&#23450;&#30340;&#22238;&#35843;&#20989;&#25968;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447139487005" ID="ID_1529574460" MODIFIED="1447489022372" TEXT="socket &#x9664;&#x4e86;&#x5e8f;&#x5217;&#x53f7;&#xff0c;&#x975e;&#x963b;&#x585e;&#xff0c;&#x7f13;&#x51b2;&#x533a;&#x5927;&#x5c0f;&#x4e4b;&#x5916;&#x7684;&#x5176;&#x5b83;&#x5c5e;&#x6027;">
<node CREATED="1447139623124" ID="ID_1274954137" MODIFIED="1447139630334" TEXT="local port"/>
<node CREATED="1447139783719" ID="ID_152555000" MODIFIED="1447139790554" TEXT="peer port"/>
<node CREATED="1447375558983" ID="ID_1366997562" MODIFIED="1447375566528" TEXT="peer groups"/>
<node CREATED="1447140093403" ID="ID_1354155245" MODIFIED="1447140102905" TEXT="auto-ack"/>
<node CREATED="1447140159898" ID="ID_1116342906" MODIFIED="1447140162724" TEXT="Message Peeking"/>
</node>
</node>
<node CREATED="1447312745977" FOLDED="true" ID="ID_1819801107" MODIFIED="1447576220181">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#25910;&#21253;&#32534;&#31243;&#27169;&#22411;
    </p>
    <p>
      &#21363;&#29992;&#25143;&#36890;&#36807;
    </p>
    <p>
      int nl_socket_modify_cb(struct nl_sock *sk, enum nl_cb_type type, enum nl_cb_kind kind, nl_recvmsg_msg_cb_t func, void *arg)
    </p>
    <p>
      &#35774;&#32622;&#30340;&#22238;&#35843;&#20989;&#25968; int nl_recvmsg_msg_cb(struct nl_msg *msg, void *arg) &#30340;&#32534;&#31243;&#27169;&#22411;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447314364101" ID="ID_1105550118" MODIFIED="1447314570960">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_message_rx_program_mode_1.JPG" />
  </body>
</html></richcontent>
<node CREATED="1447314368867" ID="ID_1624079908" MODIFIED="1447314618618">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PROTOCOL_SPECIFIC_HEADER_LEN
    </p>
    <p>
      &#21327;&#35758;&#22836;&#37096;&#30340;&#38271;&#24230;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447314631369" ID="ID_1028478312" MODIFIED="1447314638453">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      typedef struct {
    </p>
    <p>
      int field_1;
    </p>
    <p>
      int field_n;
    </p>
    <p>
      } my_second_struct;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1447317098743" FOLDED="true" ID="ID_437299065" MODIFIED="1447576769843" TEXT="&#x53d1;&#x5305;&#x7f16;&#x7a0b;&#x6a21;&#x578b;">
<node CREATED="1447317109468" ID="ID_486167788" MODIFIED="1447576225958">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_message_tx_program_mode_1.JPG" />
  </body>
</html></richcontent>
<node CREATED="1447317137618" ID="ID_1966486111" MODIFIED="1447317175060">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      MY_MSG_TYPE
    </p>
    <p>
      netlink&#20449;&#24687;&#31867;&#22411;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447317203271" FOLDED="true" ID="ID_1905926969" MODIFIED="1447576702904">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PROTOCOL_SPECIFIC_HEADER_LEN
    </p>
    <p>
      &#21327;&#35758;&#22836;&#37096;&#38271;&#24230;&#65292;&#21363;sizeof(my_protocol_header)
    </p>
  </body>
</html></richcontent>
<node CREATED="1447317272184" ID="ID_1747267875" MODIFIED="1447317274760" TEXT="my_protocol_header">
<node CREATED="1447317278307" ID="ID_1379963103" MODIFIED="1447317284159" TEXT="field_1"/>
<node CREATED="1447317284898" ID="ID_372581212" MODIFIED="1447317291218" TEXT="field_2"/>
</node>
</node>
<node CREATED="1447314631369" ID="ID_472012349" MODIFIED="1447314638453">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      typedef struct {
    </p>
    <p>
      int field_1;
    </p>
    <p>
      int field_n;
    </p>
    <p>
      } my_second_struct;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node CREATED="1447203637812" FOLDED="true" ID="ID_566454624" MODIFIED="1447574389372" TEXT="&#x5305;&#x7684;&#x5c01;&#x88c5;&#x4e0e;&#x89e3;&#x6790;">
<node CREATED="1447203918455" ID="ID_705233795" MODIFIED="1447210661718">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_message_pad_1.JPG" />
  </body>
</html></richcontent>
<node CREATED="1447203913821" ID="ID_1987509154" MODIFIED="1447203917664" TEXT="&#x586b;&#x5145;"/>
<node CREATED="1447205090511" FOLDED="true" ID="ID_645575809" MODIFIED="1447569204212">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#33719;&#21462;&#19979;&#19968;&#20010;netlink&#28040;&#24687;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447205513719" ID="ID_1400094278" MODIFIED="1447205652735">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      int nlmsg_valid_hdr(const struct nlmsghdr *hdr, int payloadlen);
    </p>
    <p>
      int nlmsg_ok(const struct nlmsghdr *hdr, int remaining);
    </p>
    <p>
      &#36825;&#20004;&#20010;API&#29992;&#20110;&#26816;&#26597;hdr&#25351;&#21521;&#30340;&#20301;&#32622;&#26159;&#21542;&#21253;&#21547;&#19968;&#20010;&#21512;&#27861;&#30340;netlink message&#65292;&#36825;&#20027;&#35201;&#26159;&#36827;&#34892;&#38271;&#24230;&#26816;&#26597;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447205363896" ID="ID_63178160" MODIFIED="1447205372818">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct nlmsghdr *nlmsg_next(struct nlmsghdr *hdr, int *remaining)
    </p>
    <p>
      &#19968;&#20010;&#21253;&#37324;&#38754;&#21487;&#33021;&#26377;&#22810;&#20010;netlink message&#65292;&#27492;API&#29992;&#20110;&#33719;&#21462;&#19979;&#19968;&#20010;netlink message
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447205701443" ID="ID_190083395" MODIFIED="1447205786224">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#36941;&#21382;&#27599;&#19968;&#20010;&#28040;&#24687;
    </p>
    <p>
      nlmsg_for_each(hdr, stream, length) {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/*do task here*/
    </p>
    <p>
      }
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447252962415" FOLDED="true" ID="ID_1174550450" MODIFIED="1447569212757" TEXT="netlink&#x6d88;&#x606f;&#x8d1f;&#x8f7d;">
<node CREATED="1447253008963" ID="ID_149209814" MODIFIED="1447253360357">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      void *nlmsg_data(const struct nlmsghdr *nlh)
    </p>
    <p>
      &#32473;&#23450;netlink&#28040;&#24687;&#22836;&#37096;&#65292;&#35745;&#31639;&#20986;&#36127;&#36733;&#24320;&#22987;&#20301;&#32622;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447253101458" ID="ID_1633619371" MODIFIED="1447253381860">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      void *nlmsg_tail(const struct nlmsghdr *nlh)
    </p>
    <p>
      &#32473;&#23450;netlink&#28040;&#24687;&#22836;&#37096;&#65292;&#35745;&#31639;&#20986;&#36127;&#36733;&#32467;&#26463;&#20301;&#32622;&#65292;&#21487;&#33021;&#21253;&#21547;&#20102;&#22635;&#20805;&#37096;&#20998;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447253204269" ID="ID_1321275983" MODIFIED="1447253370739">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;int nlmsg_datalen(const struct nlmsghdr *nlh)
    </p>
    <p>
      &#32473;&#23450;netlink &#28040;&#24687;&#22836;&#37096;&#65292;&#35745;&#31639;&#20986;&#36127;&#36733;&#38271;&#24230;&#65292;&#24182;&#19981;&#21253;&#21547;&#36127;&#36733;&#21069;&#38754;&#21644;&#21518;&#38754;&#30340;&#22635;&#20805;&#37096;&#20998;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447253503252" FOLDED="true" ID="ID_154556985" MODIFIED="1447569215095" TEXT="&#x534f;&#x8bae;&#x5934;&#x90e8;">
<node CREATED="1447253517575" ID="ID_607908403" MODIFIED="1447253564653" TEXT="&#x4e00;&#x822c;&#x534f;&#x8bae;&#x4f1a;&#x6709;&#x81ea;&#x5df1;&#x7279;&#x5b9a;&#x7684;&#x5934;&#x90e8;&#xff0c;&#x4f46;&#x4e5f;&#x53ef;&#x80fd;&#x6ca1;&#x6709;"/>
</node>
<node CREATED="1447253580468" FOLDED="true" ID="ID_1144004297" MODIFIED="1447572551207" TEXT="&#x5c5e;&#x6027;">
<node CREATED="1447253587510" ID="ID_1682688896" MODIFIED="1447253656352" TEXT="&#x534f;&#x8bae;&#x5934;&#x90e8;&#x4e4b;&#x540e;&#x4e00;&#x822c;&#x5c31;&#x662f;&#x63a5;&#x8fde;&#x7740;&#x7684;&#x591a;&#x4e2a;&#x5c5e;&#x6027;&#xff0c;&#x6bcf;&#x4e2a;&#x5c5e;&#x6027;&#x6709;&#x4e00;&#x4e2a;&#x5c5e;&#x6027;&#x5934;&#x90e8;&#x548c;&#x4e00;&#x4e2a;&#x5c5e;&#x6027;&#x8d1f;&#x8f7d;"/>
<node CREATED="1447253676458" FOLDED="true" ID="ID_900250275" MODIFIED="1447257508152">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct nlattr nla
    </p>
    <p>
      &#23646;&#24615;&#22836;&#37096;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447253696270" ID="ID_132995211" MODIFIED="1447253862836">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      length
    </p>
    <p>
      &#21253;&#21547;&#23646;&#24615;&#22836;&#37096;&#65292;&#23646;&#24615;&#36127;&#36733;&#20197;&#21450;&#20013;&#38388;&#22635;&#20805;&#30340;&#25972;&#20010;&#23646;&#24615;&#30340;&#38271;&#24230;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447253707148" ID="ID_869760533" MODIFIED="1447253741539">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      type
    </p>
    <p>
      &#23646;&#24615;&#31867;&#22411;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447253927988" ID="ID_1178913628" MODIFIED="1447257593660">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct nlattr *nlmsg_attrdata(const struct nlmsghdr *hdr, int hdrlen)
    </p>
    <p>
      &#32473;&#23450;netlink&#28040;&#24687;&#22836;&#37096;&#21644;&#21327;&#35758;&#22836;&#37096;&#38271;&#24230;&#65292;&#35745;&#31639;&#20986;&#31532;&#19968;&#20010;&#23646;&#24615;&#22836;&#37096;&#30340;&#24320;&#22987;&#20301;&#32622;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447257667287" ID="ID_574770821" MODIFIED="1447257729266">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct nlattr *nla_next(const struct nlattr *attr, int *remaining)
    </p>
    <p>
      &#32473;&#23450;&#19968;&#20010;&#23646;&#24615;&#65292;&#35745;&#31639;&#20986;&#19979;&#19968;&#20010;&#23646;&#24615;&#30340;&#24320;&#22987;&#20301;&#32622;&#65292;&#21487;&#33021;&#20250;&#36820;&#22238;&#31354;&#65292;&#21462;&#20915;&#20110;&#26159;&#21542;&#26377;&#36275;&#22815;&#30340;&#31354;&#38388;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447257766765" ID="ID_1666538403" MODIFIED="1447257847902">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      int nla_ok(const struct nlattr *attr, int remaining)
    </p>
    <p>
      &#25928;&#26524;&#31867;&#20284;&#20110;nla_next&#65292;&#26412;&#20989;&#25968;&#35745;&#31639;&#19968;&#20010;&#23646;&#24615;&#20043;&#21518;&#26159;&#21542;&#36824;&#26377;&#36275;&#22815;&#31354;&#38388;&#23481;&#32435;&#19979;&#19968;&#20010;&#23646;&#24615;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447254053721" ID="ID_1991670906" MODIFIED="1447254222017">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      int nlmsg_attrlen(const struct nlmsghdr *hdr, int hdrlen)
    </p>
    <p>
      &#32473;&#23450;netlink&#28040;&#24687;&#22836;&#37096;&#21644;&#21327;&#35758;&#22836;&#37096;&#38271;&#24230;&#65292;&#35745;&#31639;&#20986;&#25152;&#26377;&#23646;&#24615;&#30340;&#38271;&#24230;&#65292;&#20174;&#31532;&#19968;&#20010;&#23646;&#24615;&#22836;&#37096;&#24320;&#22987;&#65292;&#21040;&#26368;&#21518;&#19968;&#20010;&#23646;&#24615;&#36127;&#36733;&#32467;&#26463;&#65292;&#19981;&#21253;&#21547;&#26368;&#21518;&#19968;&#20010;&#23646;&#24615;&#36127;&#36733;&#20043;&#21518;&#30340;&#22635;&#20805;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447254355055" FOLDED="true" ID="ID_1096038784" MODIFIED="1447311876097">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#19968;&#27493;&#35299;&#26512;&#22810;&#20010;&#23646;&#24615;&#65306;
    </p>
    <p>
      int nlmsg_parse(struct nlmsghdr *hdr, int hdrlen, struct nlattr **attrs, int maxtype, struct nla_policy *policy)
    </p>
    <p>
      &#32473;&#23450;netlink&#28040;&#24687;&#21644;&#21327;&#35758;&#22836;&#37096;&#38271;&#24230;&#65292;&#35299;&#26512;&#20043;&#21518;&#30340;&#27599;&#19968;&#20010;&#23646;&#24615;&#65292;
    </p>
    <p>
      &#25152;&#26377;&#23646;&#24615;&#22836;&#37096;&#36890;&#36807;&#25968;&#32452;attrs&#36820;&#22238;&#65292;maxtype&#25351;&#23450;&#20102;&#36825;&#20010;&#25968;&#32452;&#30340;&#26368;&#22823;&#23481;&#37327;&#65292;&#25968;&#32452;policy&#25351;&#23450;&#26159;&#21542;&#35299;&#26512;&#26576;&#20123;&#23646;&#24615;&#30340;&#31574;&#30053;&#65292;policy&#25968;&#32452;&#30340;&#19979;&#26631;&#19982;&#23646;&#24615;&#31867;&#22411;&#23545;&#24212;&#12290;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447258257618" ID="ID_1573246092" MODIFIED="1447258266540">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct nla_policy {
    </p>
    <p>
      &#160;&#160;&#160;&#160;uint16_t type;
    </p>
    <p>
      &#160;&#160;&#160;&#160;uint16_t minlen;
    </p>
    <p>
      &#160;&#160;&#160;&#160;uint16_t maxlen;
    </p>
    <p>
      };
    </p>
  </body>
</html></richcontent>
<node CREATED="1447258467092" ID="ID_1693971248" MODIFIED="1447311820920">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      type &#65306;
    </p>
    <p>
      NLA_UNSPEC
    </p>
    <p>
      NLA_U8
    </p>
    <p>
      NLA_U16
    </p>
    <p>
      NLA_U32
    </p>
    <p>
      NLA_U64
    </p>
    <p>
      NLA_STRING
    </p>
    <p>
      NLA_FLAG
    </p>
    <p>
      NLA_MSECS
    </p>
    <p>
      NLA_NESTED
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447258551635" ID="ID_1128588725" MODIFIED="1447258581506" TEXT="minlen&#x548c;maxlen&#x6307;&#x5c5e;&#x6027;&#x8d1f;&#x8f7d;&#x7684;&#x6700;&#x5c0f;&#x548c;&#x6700;&#x5927;&#x957f;&#x5ea6;"/>
<node CREATED="1447258893537" ID="ID_1433965909" MODIFIED="1447258901094">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      static struct nla_policy my_policy[MY_ATTR_MAX+1] = {
    </p>
    <p>
      &#160;&#160;&#160;&#160;[MY_ATTR_FOO] = { .type = NLA_U32 },
    </p>
    <p>
      &#160;&#160;&#160;&#160;[MY_ATTR_BAR] = { .type = NLA_STRING, .maxlen = 16 },
    </p>
    <p>
      };
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1447257979891" FOLDED="true" ID="ID_937357382" MODIFIED="1447569434393" TEXT="&#x8bbf;&#x95ee;&#x5c5e;&#x6027;">
<node CREATED="1447258003885" ID="ID_1271951914" MODIFIED="1447258007695" TEXT="int nla_len(const struct nlattr *hdr)"/>
<node CREATED="1447258017762" ID="ID_640115464" MODIFIED="1447258020667" TEXT="int nla_type(const struct nlattr *hdr)"/>
<node CREATED="1447258040421" ID="ID_1371966008" MODIFIED="1447258042829" TEXT="void *nla_data(const struct nlattr *hdr)"/>
<node CREATED="1447311935928" FOLDED="true" ID="ID_1007888959" MODIFIED="1447569433538" TEXT="&#x83b7;&#x53d6;&#x5c5e;&#x6027;&#x503c;">
<node CREATED="1447311966360" ID="ID_1416602178" MODIFIED="1447311969278" TEXT=" uint8_t  nla_get_u8(struct nlattr *hdr)"/>
<node CREATED="1447311980007" ID="ID_1606988070" MODIFIED="1447311982751" TEXT=" uint16_t nla_get_u16(struct nlattr *hdr)"/>
<node CREATED="1447311993337" ID="ID_437331824" MODIFIED="1447311995704" TEXT=" uint32_t nla_get_u32(struct nlattr *hdr)"/>
<node CREATED="1447312007302" ID="ID_871063528" MODIFIED="1447312009613" TEXT=" uint64_t nla_get_u64(struct nlattr *hdr)"/>
<node CREATED="1447312076262" ID="ID_447463652" MODIFIED="1447312078526" TEXT="char* nla_get_string(struct nlattr *nla)"/>
</node>
</node>
<node CREATED="1447259002057" FOLDED="true" ID="ID_896631331" MODIFIED="1447569436464" TEXT="&#x67e5;&#x627e;&#x7279;&#x5b9a;&#x5c5e;&#x6027;">
<node CREATED="1447259023628" ID="ID_447185524" MODIFIED="1447259102848">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct nlattr *nlmsg_find_attr(struct nlmsghdr *hdr, int hdrlen, int attrtype)
    </p>
    <p>
      &#32473;&#23450;netlink&#28040;&#24687;&#22836;&#37096;&#21644;&#21327;&#35758;&#22836;&#37096;&#38271;&#24230;&#65292;&#25214;&#20986;&#29305;&#23450;&#31867;&#22411;&#30340;&#23646;&#24615;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447259036885" ID="ID_1567493354" MODIFIED="1447259195361">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct nlattr *nla_find(struct nlattr *head, int len, int attrtype)
    </p>
    <p>
      &#32473;&#23450;&#31532;&#19968;&#20010;&#23646;&#24615;&#22836;&#37096;&#21644;&#25152;&#26377;&#23646;&#24615;&#24635;&#38271;&#24230;&#65292;&#25214;&#20986;&#29305;&#23450;&#31867;&#22411;&#30340;&#23646;&#24615;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447259381730" FOLDED="true" ID="ID_1037191377" MODIFIED="1447569438651" TEXT="&#x904d;&#x5386;&#x6240;&#x6709;&#x5c5e;&#x6027;">
<node CREATED="1447259392911" ID="ID_801391687" MODIFIED="1447259445897">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      nla_for_each_attr(attr, head, len, remaining) {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/*code block*/
    </p>
    <p>
      }
    </p>
  </body>
</html></richcontent>
<node CREATED="1447259492637" ID="ID_1727815638" MODIFIED="1447259515255" TEXT="attr&#xff1a;&#x53d6;&#x5230;&#x7684;&#x4e0b;&#x4e00;&#x4e2a;&#x5c5e;&#x6027;"/>
<node CREATED="1447259516678" ID="ID_617920795" MODIFIED="1447259526558" TEXT="head&#xff1a;&#x7b2c;&#x4e00;&#x4e2a;&#x5c5e;&#x6027;"/>
<node CREATED="1447259532159" ID="ID_442861608" MODIFIED="1447259550974" TEXT="len&#xff1a;&#x6240;&#x6709;&#x5c5e;&#x6027;&#x603b;&#x957f;&#x5ea6;"/>
<node CREATED="1447259553033" ID="ID_832320973" MODIFIED="1447259601829" TEXT="remaining&#xff1a;&#x4e34;&#x65f6;&#x53d8;&#x91cf;&#xff0c;&#x7528;&#x4e8e;&#x8ba1;&#x7b97;&#x5269;&#x4f59;&#x957f;&#x5ea6;"/>
</node>
</node>
<node CREATED="1447259908909" FOLDED="true" ID="ID_834843527" MODIFIED="1447569445986" TEXT="&#x6784;&#x9020;&#x5c5e;&#x6027;">
<node CREATED="1447259950888" ID="ID_381598248" MODIFIED="1447259996352" TEXT="&#x4ee5;&#x4e0b;&#x63a5;&#x53e3;&#x5747;&#x5047;&#x8bbe;netlink&#x6d88;&#x606f;&#x5934;&#x90e8;&#x548c;&#x534f;&#x8bae;&#x5934;&#x90e8;&#x5df2;&#x7ecf;&#x88ab;&#x52a0;&#x5165;&#x5230;netlink&#x6d88;&#x606f;&#x4e2d;"/>
<node CREATED="1447259928821" ID="ID_1933753504" MODIFIED="1447260078566">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct nlattr *nla_reserve(struct nl_msg *msg, int attrtype, int len)
    </p>
    <p>
      &#22312;netlink&#28040;&#24687;&#20013;&#39044;&#30041;&#19968;&#20010;&#25351;&#23450;&#31867;&#22411;&#23646;&#24615;&#30340;&#31354;&#38388;&#65292;&#36820;&#22238;&#23646;&#24615;&#22836;&#37096;&#65292;&#36825;&#26679;&#29992;&#25143;&#23601;&#21487;&#20197;&#22635;&#20805;&#23646;&#24615;&#20102;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447260095520" ID="ID_1039038374" MODIFIED="1447260165091">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      int nla_put(struct nl_msg *msg, int attrtype, int attrlen, const void *data)
    </p>
    <p>
      &#22312;netlink&#28040;&#24687;&#20013;&#22635;&#20805;&#19968;&#20010;&#25351;&#23450;&#31867;&#22411;&#30340;&#23646;&#24615;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447260846871" ID="ID_1903989414" MODIFIED="1447315976358" TEXT="&#x7528;&#x5b8f;&#x586b;&#x5145;&#x5c5e;&#x6027;">
<node CREATED="1447260879111" ID="ID_72221775" MODIFIED="1447260960775">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      {
    </p>
    <p>
      &#160;&#160;&#160;&#160;NLA_PUT_U32(msg, MY_ATTR_FOO1, 0x1010);
    </p>
    <p>
      &#160;&#160;&#160;&#160;NLA_PUT_FLAG(msg, MY_ATTR_FOO3, 1);
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;return 0;
    </p>
    <p>
      
    </p>
    <p>
      nla_put_failure:
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* NLA_PUT* macros jump here in case of an error */
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return -EMSGSIZE;
    </p>
    <p>
      }
    </p>
  </body>
</html></richcontent>
<node CREATED="1447260969828" ID="ID_52232064" MODIFIED="1447260992846" TEXT="&#x987b;&#x5b9a;&#x4e49;&#x4e00;&#x4e2a;nla_put_failure&#x6807;&#x7b7e;"/>
<node CREATED="1447261013037" ID="ID_1663968557" MODIFIED="1447261013692" TEXT="NLA_PUT_U8(msg, attrtype, value)"/>
<node CREATED="1447261024960" ID="ID_638560588" MODIFIED="1447261025718" TEXT="NLA_PUT_U16(msg, attrtype, value)"/>
<node CREATED="1447261038595" ID="ID_617346375" MODIFIED="1447261039293" TEXT="NLA_PUT_U32(msg, attrtype, value)"/>
<node CREATED="1447261051242" ID="ID_983718266" MODIFIED="1447261051823" TEXT="NLA_PUT_U64(msg, attrtype, value)"/>
<node CREATED="1447261063206" ID="ID_1132035146" MODIFIED="1447261063860" TEXT="NLA_PUT_STRING(msg, attrtype, value)"/>
<node CREATED="1447261074898" FOLDED="true" ID="ID_1379286924" MODIFIED="1447261119305" TEXT="NLA_PUT_FLAG(msg, attrtype)">
<node CREATED="1447261077004" ID="ID_103757722" MODIFIED="1447261104959" TEXT="&#x8fd9;&#x662f;&#x6307;&#x90a3;&#x79cd;&#x53ea;&#x6709;&#x5c5e;&#x6027;&#x5934;&#x90e8;&#xff0c;&#x6ca1;&#x6709;&#x5c5e;&#x6027;&#x8d1f;&#x8f7d;&#x7684;&#x5c5e;&#x6027;"/>
</node>
<node CREATED="1447261120605" ID="ID_561824291" MODIFIED="1447261121269" TEXT="NLA_PUT_ADDR(msg, attrtype, addr)">
<node CREATED="1447261329934" ID="ID_1237692467" MODIFIED="1447261764118">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      addr&#25351;&#21521;&#19968;&#20010;struct nl_addr&#32467;&#26500;
    </p>
    <p>
      &#19968;&#33324;&#29992;API&#65306;
    </p>
    <p>
      struct nl_addr* nl_addr_build(int&#160;family, void *buf, size_t&#160;size)
    </p>
    <p>
      &#26469;&#26500;&#36896;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
</node>
</node>
<node CREATED="1447254843270" ID="ID_1368523303" MODIFIED="1447572901837" TEXT="&#x6784;&#x9020;netlink&#x6d88;&#x606f;">
<node CREATED="1447254903799" ID="ID_1423042553" MODIFIED="1447254989493" TEXT="netlink&#x6d88;&#x606f;&#x5b58;&#x653e;&#x5728;struct nl_msg&#x4e2d;&#xff0c;&#x8fd9;&#x4e2a;&#x7ed3;&#x6784;&#x7684;&#x6307;&#x9488;&#x5e76;&#x4e0d;&#x6307;&#x5411;netlink&#x6d88;&#x606f;&#x7684;&#x5934;&#x90e8;&#xff0c;&#x9700;&#x8981;&#x4f7f;&#x7528;nlmsg_hdr()&#x6765;&#x5f97;&#x5230;"/>
<node CREATED="1447255113130" FOLDED="true" ID="ID_1613841635" MODIFIED="1447256047184">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct nl_msg *nlmsg_alloc(void)
    </p>
    <p>
      &#20998;&#37197;&#19968;&#20010;netlink&#28040;&#24687;&#65292;&#31995;&#32479;&#20250;&#20026;&#20854;&#20998;&#37197;&#19968;&#20010;PAGE_SIZE&#30340;&#20869;&#23384;&#29992;&#20110;&#23384;&#25918;&#28040;&#24687;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447255402294" ID="ID_1880195123" MODIFIED="1447255504806">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      void nlmsg_set_default_size(size_t)
    </p>
    <p>
      &#26032;&#20998;&#37197;netlink&#28040;&#24687;&#26102;&#40664;&#35748;&#20998;&#37197;PAGE_SIZE&#22823;&#23567;&#30340;&#20869;&#23384;&#65292;&#20294;&#36825;&#20010;&#40664;&#35748;&#22823;&#23567;&#21487;&#20197;&#36890;&#36807;&#26412;&#20989;&#25968;&#25913;&#21464;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447255540080" ID="ID_78079156" MODIFIED="1447255569075">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct nl_msg *nlmsg_alloc_size(size_t max)
    </p>
    <p>
      &#20998;&#37197;netlink&#28040;&#24687;&#26102;&#25351;&#23450;&#20854;&#22823;&#23567;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447255660835" ID="ID_1691703888" MODIFIED="1447255851816">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct nl_msg *nlmsg_inherit(struct nlmsghdr *hdr)
    </p>
    <p>
      &#26377;&#30340;&#26102;&#20505;&#20998;&#37197;netlink&#28040;&#24687;&#26102;netlink&#28040;&#24687;&#22836;&#37096;&#24050;&#30693;&#65292;&#22240;&#27492;&#24076;&#26395;&#20998;&#37197;netlink&#28040;&#24687;&#26102;&#21516;&#26102;&#22635;&#20805;&#22909;netlink&#28040;&#24687;&#22836;&#37096;
    </p>
    <p>
      &#26412;&#20989;&#25968;&#22312;&#20998;&#37197;&#19968;&#20010;netlink&#28040;&#24687;&#21518;&#20250;&#22797;&#21046;&#24050;&#26377;&#30340;netlink&#28040;&#24687;&#22836;&#37096;&#21040;&#26032;&#30340;netlink&#28040;&#24687;&#20013;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447255947434" ID="ID_1988598856" MODIFIED="1447256030712">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct nl_msg *nlmsg_alloc_simple(int nlmsg_type, int flags)
    </p>
    <p>
      &#20998;&#37197;netlink&#28040;&#24687;&#21518;&#21033;&#29992;&#20256;&#20154;&#30340;&#21442;&#25968;&#22635;&#20805;&#22909;netlink&#28040;&#24687;&#22836;&#37096;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447255211241" ID="ID_1518531370" MODIFIED="1447255336432">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct nlmsghdr* nlmsg_hdr(struct nl_msg *n)
    </p>
    <p>
      struct nl_msg&#32467;&#26500;&#20307;&#26412;&#36523;&#24182;&#19981;&#25351;&#21521;netlink&#28040;&#24687;&#22836;&#37096;&#65292;&#38656;&#35201;&#29992;&#26412;&#20989;&#25968;&#21462;&#20986;netlink&#28040;&#24687;&#22836;&#37096;&#25351;&#38024;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447256242748" ID="ID_1961694040" MODIFIED="1447256796134" TEXT="struct nlmsghdr *nlmsg_put(struct nl_msg *msg, uint32_t port, uint32_t seqnr, int nlmsg_type, int payload, int nlmsg_flags)&#xa;&#x6784;&#x9020;netlink&#x6d88;&#x606f;&#x5934;&#x90e8;&#xa;port&#x53ef;&#x4ee5;&#x4f20;&#x5165;NL_AUTO_PORT&#xff0c;&#x8868;&#x793a;&#x7528;socket&#x7684;local port&#x4f5c;&#x4e3a;source port&#x3002;&#xa;seqnr&#x53ef;&#x4ee5;&#x4f20;&#x5165;NL_AUTO_SEQ&#xff0c;&#x8868;&#x793a;&#x81ea;&#x52a8;&#x8ba1;&#x7b97;&#x5e8f;&#x5217;&#x53f7;&#xff0c;&#x6b64;&#x65f6;&#x5e94;&#x7528;&#x51fd;&#x6570;nl_send_auto()&#x6765;&#x53d1;&#x9001;&#x6d88;&#x606f;&#xa;payload&#x7528;&#x4e8e;&#x5728;netlink&#x6d88;&#x606f;&#x5934;&#x90e8;&#x4e4b;&#x540e;&#x9884;&#x7559;&#x4e00;&#x5b9a;&#x957f;&#x5ea6;&#x7528;&#x4f5c;&#x534f;&#x8bae;&#x5934;&#x90e8;&#xff0c;&#x6548;&#x679c;&#x4e0e;nlmsg_reserve(msg, payload, NLMSG_ALIGNTO)&#x76f8;&#x540c;"/>
<node CREATED="1447256644467" ID="ID_538626234" MODIFIED="1447256983989">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      void* nlmsg_reserve(struct nl_msg *n, size_t len, int pad)
    </p>
    <p>
      &#22312;netlink&#28040;&#24687;&#22836;&#37096;&#20043;&#21518;&#39044;&#30041;&#19968;&#23450;&#38271;&#24230;&#29992;&#20316;&#21327;&#35758;&#22836;&#37096;&#65292;pad&#20026;&#23545;&#40784;&#38271;&#24230;&#65292;&#19968;&#33324;&#35774;&#20026;<code>NLMSG_ALIGNTO&#21363;4&#23383;&#33410;&#12290;</code>
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447257071073" ID="ID_1944045019" MODIFIED="1447257221215">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      void* nlmsg_data(const struct nlmsghdr *nlh)
    </p>
    <p>
      &#21069;&#38754;&#30340;nlmsg_hdr()&#21644;nlmsg_put()&#37117;&#21487;&#20197;&#24471;&#21040;netlink&#28040;&#24687;&#22836;&#37096;&#65292;
    </p>
    <p>
      &#26412;&#20989;&#25968;&#26681;&#25454;&#22836;&#37096;&#24471;&#21040;netlink&#28040;&#24687;&#36127;&#36733;&#24320;&#22987;&#20301;&#32622;&#65292;&#19968;&#33324;&#20026;&#21327;&#35758;&#22836;&#37096;&#20301;&#32622;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447257303529" ID="ID_390534034" MODIFIED="1447257434362">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      int nlmsg_append(struct nl_msg *msg, void *data, size_t len, int pad)
    </p>
    <p>
      &#38468;&#21152;&#19968;&#27573;&#25968;&#25454;&#21040;netlink&#28040;&#24687;&#23614;&#37096;&#65292;pad&#20026;&#23545;&#40784;&#38271;&#24230;&#65292;&#19968;&#33324;&#35774;&#20026;<code>NLMSG_ALIGNTO&#21363;4&#23383;&#33410;&#12290;</code>
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node CREATED="1447317399823" FOLDED="true" ID="ID_1778507389" MODIFIED="1447661814465" TEXT="generic netlink">
<node CREATED="1447399317965" FOLDED="true" ID="ID_166215625" MODIFIED="1447661813233" TEXT="&#x6570;&#x636e;&#x7ed3;&#x6784;">
<node CREATED="1447482956310" ID="ID_506145479" MODIFIED="1447482970848" TEXT="&#x7528;&#x6237;&#x7a7a;&#x95f4;&#x6570;&#x636e;&#x7ed3;&#x6784;">
<node CREATED="1447483005684" ID="ID_700502494" LINK="#ID_863637129" MODIFIED="1447483016463" TEXT="struct nlmsghdr"/>
<node CREATED="1447483069879" FOLDED="true" ID="ID_794208307" MODIFIED="1447567524151" TEXT="struct genlmsghdr">
<node CREATED="1447483198369" ID="ID_573366038" MODIFIED="1447483311445">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      __u8 cmd
    </p>
    <p>
      &#23545;&#24212;&#20110;generic netlink family&#20013;&#30340;operation&#65292;&#21363;&#19968;&#20010;&#26381;&#21153;&#25509;&#21475;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447483323483" ID="ID_1759340592" MODIFIED="1447483385606">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      __u8 version
    </p>
    <p>
      &#26381;&#21153;&#25509;&#21475;&#30340;&#29256;&#26412;&#65292;&#19968;&#33324;&#37117;&#20026;1
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447483338052" ID="ID_182148937" MODIFIED="1447483346553" TEXT="__u16 reserved"/>
</node>
</node>
<node CREATED="1447482944326" ID="ID_1712696871" MODIFIED="1447482954207" TEXT="&#x5185;&#x6838;&#x6570;&#x636e;&#x7ed3;&#x6784;">
<node CREATED="1447573516793" FOLDED="true" ID="ID_1951190297" MODIFIED="1447661806026" TEXT="struct genl_family">
<node CREATED="1447573986727" MODIFIED="1447573986727" TEXT=" unsigned int id"/>
<node CREATED="1447573986727" MODIFIED="1447573986727" TEXT=" unsigned int hdrsize"/>
<node CREATED="1447573986727" MODIFIED="1447573986727" TEXT=" char name[GENL_NAMSIZ]"/>
<node CREATED="1447573986727" MODIFIED="1447573986727" TEXT=" unsigned int version"/>
<node CREATED="1447573986727" MODIFIED="1447573986727" TEXT=" unsigned int maxattr"/>
<node CREATED="1447573986727" MODIFIED="1447573986727" TEXT=" bool netnsok"/>
<node CREATED="1447573986728" MODIFIED="1447573986728" TEXT=" bool parallel_ops"/>
<node CREATED="1447573986728" MODIFIED="1447573986728" TEXT=" int (*pre_doit)(const struct genl_ops *ops, struct sk_buff *skb, struct genl_info *info)"/>
<node CREATED="1447573986728" MODIFIED="1447573986728" TEXT=" void (*post_doit)(const struct genl_ops *ops, struct sk_buff *skb, struct genl_info *info)"/>
<node COLOR="#3333ff" CREATED="1447573986728" ID="ID_1566693281" MODIFIED="1447574231956">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#34013;&#33394;&#23383;&#27573;&#20026;&#20869;&#26680;&#31169;&#26377;&#25968;&#25454;&#65292;&#20869;&#26680;&#27169;&#22359;&#19981;&#24212;&#35775;&#38382;&#36825;&#20123;&#23383;&#27573;
    </p>
    <p>
      &#160;struct nlattr ** attrbuf
    </p>
  </body>
</html></richcontent>
</node>
<node COLOR="#3333ff" CREATED="1447573986728" ID="ID_633823073" MODIFIED="1447574160445" TEXT=" const struct genl_ops * ops"/>
<node COLOR="#3333ff" CREATED="1447573986728" ID="ID_855029363" MODIFIED="1447574160445" TEXT=" const struct genl_multicast_group *mcgrps"/>
<node COLOR="#3333ff" CREATED="1447573986728" ID="ID_1422376396" MODIFIED="1447574160445" TEXT=" unsigned int n_ops"/>
<node COLOR="#3333ff" CREATED="1447573986728" ID="ID_846152753" MODIFIED="1447574160445" TEXT=" unsigned int n_mcgrps"/>
<node COLOR="#3333ff" CREATED="1447573986728" ID="ID_1816654314" MODIFIED="1447574160445" TEXT=" unsigned int mcgrp_offset"/>
<node COLOR="#3333ff" CREATED="1447573986728" ID="ID_322016999" MODIFIED="1447574160445" TEXT=" struct list_head family_list"/>
<node CREATED="1447573986728" MODIFIED="1447573986728" TEXT=" struct module *module"/>
</node>
<node CREATED="1447573700326" FOLDED="true" ID="ID_1697635195" MODIFIED="1447574253692" TEXT="struct genl_ops">
<node CREATED="1447573986728" MODIFIED="1447573986728" TEXT=" const struct nla_policy *policy"/>
<node CREATED="1447573986728" MODIFIED="1447573986728" TEXT=" int (*doit)(struct sk_buff *skb, struct genl_info *info)"/>
<node CREATED="1447573986728" MODIFIED="1447573986728" TEXT=" int (*dumpit)(struct sk_buff *skb, struct netlink_callback *cb)"/>
<node CREATED="1447573986728" MODIFIED="1447573986728" TEXT=" int (*done)(struct netlink_callback *cb)"/>
<node CREATED="1447573986728" MODIFIED="1447573986728" TEXT=" u8 cmd"/>
<node CREATED="1447573986728" MODIFIED="1447573986728" TEXT=" u8 internal_flags"/>
<node CREATED="1447573986728" MODIFIED="1447573986728" TEXT=" u8 flags"/>
</node>
<node CREATED="1447573723119" FOLDED="true" ID="ID_1312598735" MODIFIED="1447573996443" TEXT="struct genl_multicast_group">
<node CREATED="1447573740962" ID="ID_386413721" MODIFIED="1447573747474" TEXT="char name[GENL_NAMSIZ]"/>
</node>
<node CREATED="1447574009642" FOLDED="true" ID="ID_250074306" MODIFIED="1447661810888" TEXT="struct genl_info">
<node CREATED="1447574099649" MODIFIED="1447574099649" TEXT=" u32 snd_seq"/>
<node CREATED="1447574099649" ID="ID_1500148181" MODIFIED="1447574099649" TEXT=" u32 snd_portid"/>
<node CREATED="1447574099649" ID="ID_1548737669" MODIFIED="1447574099649" TEXT=" struct nlmsghdr * nlhdr"/>
<node CREATED="1447574099649" MODIFIED="1447574099649" TEXT=" struct genlmsghdr * genlhdr"/>
<node CREATED="1447574099649" MODIFIED="1447574099649" TEXT=" void * userhdr"/>
<node CREATED="1447574099650" MODIFIED="1447574099650" TEXT=" struct nlattr ** attrs"/>
<node CREATED="1447574099650" MODIFIED="1447574099650" TEXT=" struct net * _net"/>
<node CREATED="1447574099650" MODIFIED="1447574099650" TEXT=" void * user_ptr[2]"/>
<node CREATED="1447574099650" MODIFIED="1447574099650" TEXT=" struct sock * dst_sk"/>
</node>
</node>
</node>
<node CREATED="1447399261654" FOLDED="true" ID="ID_825988116" MODIFIED="1447569699891" TEXT="generic netlink&#x5bfb;&#x5740;">
<node CREATED="1447400871595" ID="ID_468399644" MODIFIED="1447400909426">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_generic_addressing_1.JPG" />
  </body>
</html></richcontent>
<node CREATED="1447403869063" FOLDED="true" ID="ID_1124639099" MODIFIED="1447569689103" TEXT="netlink addressing">
<node CREATED="1447403913395" ID="ID_509590153" MODIFIED="1447404703582">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#29992;&#20160;&#20040;&#23547;&#22336;
    </p>
    <p>
      &#26080;&#35770;&#26159;&#29992;&#25143;&#31354;&#38388;&#31243;&#24207;&#21457;&#20986;&#30340;&#36890;&#29992;netlink&#28040;&#24687;&#36824;&#26159;&#20869;&#26680;&#27169;&#22359;&#21457;&#20986;&#30340;&#36890;&#29992;netlink&#28040;&#24687;&#65292;&#37117;&#25658;&#24102;&#20102;peer port&#21644;peer groups&#36825;2&#20010;&#20449;&#24687;&#12290;&#36825;2&#20010;&#20449;&#24687;&#26159;&#20197;&#24102;&#22806;&#30340;&#24418;&#24335;&#25658;&#24102;&#30340;&#65292;&#21363;&#23427;&#20204;&#24182;&#19981;&#22312;&#28040;&#24687;&#20869;&#65292;&#32780;&#26159;&#22312;netlink&#22320;&#22336;&#20869;&#65292;netlink&#22320;&#22336;&#38543;&#28040;&#24687;&#19968;&#36215;&#21457;&#36865;&#65292;&#20294;&#20854;&#26412;&#36523;&#24182;&#19981;&#26159;&#28040;&#24687;&#30340;&#19968;&#37096;&#20998;&#12290;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447404309853" ID="ID_821871601" MODIFIED="1447404366098" TEXT="&#x5f53;&#x5e0c;&#x671b;&#x4ee5;&#x7ec4;&#x64ad;&#x5f62;&#x5f0f;&#x53d1;&#x9001;&#x6d88;&#x606f;&#x65f6;&#xff0c;&#x9700;&#x8981;&#x6307;&#x5b9a;peer group&#x800c;&#x4e0d;&#x6307;&#x5b9a;peer port&#x3002;">
<node CREATED="1447404409659" ID="ID_332580938" MODIFIED="1447404442067" TEXT="&#x5185;&#x6838;&#x6a21;&#x5757;&#x53d1;&#x9001;&#x901a;&#x7528;netlink&#x6d88;&#x606f;&#x65f6;&#x4e00;&#x822c;&#x4ee5;&#x7ec4;&#x64ad;&#x5f62;&#x5f0f;&#x53d1;&#x9001;"/>
</node>
<node CREATED="1447404309853" ID="ID_1398607781" MODIFIED="1447404617047">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#24403;&#24076;&#26395;&#20197;&#21333;&#25773;&#24418;&#24335;&#21457;&#36865;&#28040;&#24687;&#26102;&#65292;&#38656;&#35201;&#25351;&#23450;peer port&#32780;&#19981;&#25351;&#23450;peer group&#12290;
    </p>
    <p>
      &#19981;&#25351;&#23450;peer port&#26102;&#20854;&#40664;&#35748;&#20026;0&#65292;&#20063;&#23601;&#26159;&#25351;&#21521;&#19982;&#20869;&#26680;&#20851;&#32852;&#30340;netlink socket&#12290;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447404409659" ID="ID_946347414" MODIFIED="1447404641056" TEXT="&#x7528;&#x6237;&#x7a7a;&#x95f4;&#x7a0b;&#x5e8f;&#x53d1;&#x9001;&#x901a;&#x7528;netlink&#x6d88;&#x606f;&#x65f6;&#x4e00;&#x822c;&#x4ee5;&#x5355;&#x64ad;&#x5f62;&#x5f0f;&#x53d1;&#x9001;"/>
</node>
</node>
<node CREATED="1447404736351" ID="ID_547851298" MODIFIED="1447405087836">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#24590;&#20040;&#23547;&#22336;
    </p>
    <p>
      &#22914;&#26524;peer groups&#19981;&#20026;&#31354;&#65292;&#21017;&#23558;&#28040;&#24687;&#21457;&#36865;&#32473;&#30456;&#21516;family&#30340;&#36825;&#20010;&#32452;&#20869;&#30340;&#25152;&#26377;netlink socket&#65292;&#33258;&#36523;&#38500;&#22806;
    </p>
    <p>
      &#22914;&#26524;peer groups&#20026;&#31354;&#65292;&#21017;&#23558;&#28040;&#24687;&#21457;&#36865;&#32473;&#30456;&#21516;family&#30340;peer port&#25351;&#23450;&#30340;netlink socket&#65292;&#33258;&#36523;&#38500;&#22806;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447404409659" ID="ID_1297766856" MODIFIED="1447405305331">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#29992;&#25143;&#31354;&#38388;&#31243;&#24207;&#19968;&#33324;&#20197;&#21333;&#25773;&#24418;&#24335;&#21457;&#36865;&#36890;&#29992;netlink&#28040;&#24687;&#65292;&#24182;&#19988;&#19981;&#25351;&#23450;peer port&#65292;&#25152;&#20197;peer port&#40664;&#35748;&#20026;0&#65292;&#25152;&#20197;&#28040;&#24687;&#26368;&#32456;&#21457;&#32473;&#20102;&#19982;&#20869;&#26680;&#20851;&#32852;&#30340;netlink socket&#12290;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447404409659" ID="ID_146981447" MODIFIED="1447405422362">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#20869;&#26680;&#27169;&#22359;&#19968;&#33324;&#20197;&#32452;&#25773;&#24418;&#24335;&#21457;&#36865;&#36890;&#29992;netlink&#28040;&#24687;&#65292;&#25152;&#20197;&#28040;&#24687;&#26368;&#32456;&#21457;&#32473;&#20102;&#21152;&#20837;&#20102;peer groups&#32452;&#30340;&#29992;&#25143;&#31354;&#38388;&#31243;&#24207;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1447403869063" FOLDED="true" ID="ID_222203413" MODIFIED="1447569693622" TEXT="generic netlink addressing">
<node CREATED="1447405509145" ID="ID_710132218" MODIFIED="1447405722592">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#20160;&#20040;&#26102;&#20505;&#21457;&#29983;generic netlink addressing&#23547;&#22336;
    </p>
    <p>
      &#21482;&#26377;&#24403;&#28040;&#24687;&#21457;&#36865;&#32473;&#19982;&#20869;&#26680;&#20851;&#32852;&#30340;generic netlink socket&#26102;&#25165;&#21457;&#29983;generic netlink addressing&#23547;&#22336;
    </p>
    <p>
      &#24403;&#28040;&#24687;&#21457;&#36865;&#32473;&#19982;&#29992;&#25143;&#31354;&#38388;&#31243;&#24207;&#20851;&#32852;&#30340;generic netlink socket&#26102;&#26080;&#38656;generic netlink addressing&#23547;&#22336;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447403913395" FOLDED="true" ID="ID_143225165" MODIFIED="1447569661315">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#29992;&#20160;&#20040;&#23547;&#22336;
    </p>
    <p>
      netlink&#28040;&#24687;&#22836;&#37096;&#20013;&#30340;type&#21644;&#36890;&#29992;netlink&#28040;&#24687;&#22836;&#37096;&#20013;&#30340;cmd&#29992;&#20110;generic netlink addressing&#12290;&#26080;&#35770;&#26159;&#29992;&#25143;&#31354;&#38388;&#31243;&#24207;&#21457;&#20986;&#30340;&#36890;&#29992;netlink&#28040;&#24687;&#36824;&#26159;&#20869;&#26680;&#27169;&#22359;&#21457;&#20986;&#30340;&#36890;&#29992;netlink&#28040;&#24687;&#65292;&#20063;&#26080;&#35770;&#26159;&#20197;&#32452;&#25773;&#24418;&#24335;&#21457;&#36865;&#36824;&#26159;&#21333;&#25773;&#24418;&#24335;&#21457;&#36865;&#65292;&#36825;2&#20010;&#20449;&#24687;&#37117;&#24212;&#35813;&#34987;&#27491;&#30830;&#22635;&#20805;&#12290;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447404309853" ID="ID_1747624264" MODIFIED="1447407440755">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      netlink&#20449;&#24687;&#22836;&#37096;&#20013;&#30340;type&#23454;&#38469;&#19978;&#23545;&#24212;&#20102;generic netlink family&#65288;&#25110;&#32773;&#31216;&#20043;&#20026;channel&#65289;&#65292;&#27599;&#20010;&#24819;&#35201;&#20351;&#29992;&#36890;&#29992;netlink&#28040;&#24687;&#36890;&#20449;&#30340;&#20869;&#26680;&#27169;&#22359;&#37117;&#20250;&#27880;&#20876;&#19968;&#20010;generic netlink family&#65288;&#25110;&#32773;&#31216;&#20043;&#20026;channel&#65289;&#12290;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447404409659" ID="ID_1931472938" MODIFIED="1447406952790">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#23545;&#20110;&#29992;&#25143;&#31354;&#38388;&#31243;&#24207;&#32780;&#35328;&#65292;generic netlink family&#65288;&#25110;&#32773;&#31216;&#20043;&#20026;channel&#65289;&#19981;&#26159;&#23427;&#33258;&#24049;&#27880;&#20876;&#30340;&#65292;&#25152;&#20197;&#38656;&#35201;&#20351;&#29992;family&#30340;&#21517;&#23383;&#21435;&#26597;&#35810;&#20869;&#26680;&#20197;&#35299;&#26512;&#24471;&#21040;generic netlink family&#65288;&#25110;&#32773;&#31216;&#20043;&#20026;channel&#65289;&#12290;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447406987923" ID="ID_1434987217" MODIFIED="1447406990192" TEXT="int genl_ctrl_resolve(struct nl_sock *sk, const char *name)"/>
</node>
</node>
<node CREATED="1447404309853" ID="ID_1755304351" MODIFIED="1447407204198">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#36890;&#29992;&#28040;&#24687;&#22836;&#37096;&#20013;&#30340;cmd&#23454;&#38469;&#19978;&#23545;&#24212;&#20102;&#19968;&#20010;generic netlink operation&#65292;&#27599;&#20010;&#24819;&#35201;&#20351;&#29992;&#36890;&#29992;netlink&#28040;&#24687;&#36890;&#20449;&#30340;&#20869;&#26680;&#27169;&#22359;&#37117;&#20250;&#22312;&#33258;&#24049;&#30340;generic netlink family&#65288;&#25110;&#32773;&#31216;&#20043;&#20026;channel&#65289;&#20043;&#20869;&#27880;&#20876;&#19968;&#20123;operation&#12290;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447404409659" ID="ID_1912086994" MODIFIED="1447407340285">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      cmd&#25110;&#32773;operation&#21487;&#20197;&#35748;&#20026;&#26159;&#19968;&#20123;&#26381;&#21153;&#25509;&#21475;&#65292;&#36890;&#20449;&#21452;&#26041;&#37117;&#38656;&#35201;&#23545;&#36825;&#20123;&#26381;&#21153;&#25509;&#21475;&#30340;&#23450;&#20041;&#26377;&#19968;&#33268;&#30340;&#35748;&#35782;&#25165;&#33021;&#36890;&#20449;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1447404736351" ID="ID_1894682452" MODIFIED="1447407609790">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#24590;&#20040;&#23547;&#22336;
    </p>
    <p>
      &#20351;&#29992;netlink&#28040;&#24687;&#22836;&#37096;&#20013;&#30340;type&#25214;&#21040;&#23545;&#24212;&#30340;generic netlink family&#65288;&#25110;&#32773;&#31216;&#20043;&#20026;channel&#65289;&#65292;&#20877;&#29992;&#36890;&#29992;netlink&#28040;&#24687;&#22836;&#37096;&#20013;&#30340;cmd&#22312;generic netlink family&#20013;&#26597;&#25214;generic netlink operation&#65292;&#25214;&#21040;&#21518;&#35843;&#29992;&#20854;&#22788;&#29702;&#20989;&#25968;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node CREATED="1447399243781" FOLDED="true" ID="ID_1577801283" MODIFIED="1447573452777" TEXT="&#x5305;&#x7684;&#x5c01;&#x88c5;&#x4e0e;&#x89e3;&#x6790;">
<node CREATED="1447569584102" ID="ID_724874176" MODIFIED="1447569608978">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_generic_message_1.JPG" />
  </body>
</html></richcontent>
<node CREATED="1447569715921" ID="ID_1017977385" MODIFIED="1447570771569" TEXT="&#x4e0e;netlink&#x6d88;&#x606f;&#x76f8;&#x6bd4;&#xff0c;&#x4e0d;&#x540c;&#x7684;&#x5730;&#x65b9;&#x5728;&#x4e8e;protocol header&#x53d8;&#x6210;&#x4e86;generic netlink header&#xff0c;&#x53e6;&#x5916;&#x7528;&#x6237;&#x53ef;&#x4ee5;&#x5728;&#x901a;&#x7528;&#x6d88;&#x606f;&#x5934;&#x90e8;&#x7684;&#x57fa;&#x7840;&#x4e0a;&#x518d;&#x5b9a;&#x4e49;&#x4e00;&#x4e2a;&#x7528;&#x6237;&#x5934;&#x90e8;&#xff0c;&#x9664;&#x6b64;&#x4e4b;&#x5916;&#x90fd;&#x76f8;&#x540c;&#xff0c;&#x6d89;&#x53ca;&#x5230;&#x89e3;&#x6790;&#x4e0e;&#x5c01;&#x88c5;&#x64cd;&#x4f5c;&#x4e5f;&#x76f8;&#x540c;"/>
<node CREATED="1447569871754" FOLDED="true" ID="ID_915088842" MODIFIED="1447570779098">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#22914;&#20309;&#33719;&#21462;&#36890;&#29992;netlink&#28040;&#24687;&#22836;&#37096;
    </p>
    <p>
      1&#65292; &#39318;&#20808;&#33719;&#21462;netlink&#28040;&#24687;&#22836;&#37096;&#65306;struct nlmsghdr *nlh = nlmsg_hdr(msg);
    </p>
    <p>
      2&#65292;&#32780;netlink&#28040;&#24687;data&#24320;&#22987;&#30340;&#20301;&#32622;&#23601;&#26159;&#36890;&#29992;netlink&#28040;&#24687;&#22836;&#37096;&#65306;struct genlmsghdr *gnlh = nlmsg_data(nlh);
    </p>
  </body>
</html></richcontent>
<node CREATED="1447570193874" ID="ID_358235292" MODIFIED="1447570221073">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#23545;&#20110;&#31532;2&#27493;&#65292;&#20063;&#21487;&#20197;&#35843;&#29992;&#65306;
    </p>
    <p>
      struct genlmsghdr *genlmsg_hdr(struct nlmsghdr *nlh)
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447570978158" FOLDED="true" ID="ID_1194056023" MODIFIED="1447572945528" TEXT="&#x7528;&#x6237;&#x5934;&#x90e8;">
<node CREATED="1447571027931" ID="ID_1033122793" MODIFIED="1447571857423">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#26080;&#35770;&#26159;&#25509;&#25910;&#36824;&#26159;&#21457;&#36865;&#65292;&#29992;&#25143;&#37117;&#38656;&#35201;&#28165;&#26970;&#29992;&#25143;&#22836;&#37096;&#30340;&#38271;&#24230;
    </p>
    <p>
      &#29992;&#25143;&#22836;&#37096;&#20043;&#21518;&#21487;&#20197;&#26159;&#23646;&#24615;&#21015;&#34920;&#65292;&#20063;&#21487;&#20197;&#26159;&#29992;&#25143;&#25968;&#25454;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447571788644" ID="ID_191547265" MODIFIED="1447571893787">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#33719;&#21462;&#29992;&#25143;&#22836;&#37096;
    </p>
    <p>
      void *genlmsg_user_hdr(const struct genlmsghdr *gnlh)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447571802679" ID="ID_1284480262" MODIFIED="1447571914393">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#33719;&#21462;&#29992;&#25143;&#25968;&#25454;
    </p>
    <p>
      void *genlmsg_user_data(const struct genlmsghdr *gnlh, const int hdrlen)
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447571947588" FOLDED="true" ID="ID_423252726" MODIFIED="1447572946592" TEXT="&#x5c5e;&#x6027;">
<node CREATED="1447571986199" ID="ID_199929916" MODIFIED="1447572436301">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#35299;&#26512;&#23646;&#24615;
    </p>
    <p>
      int genlmsg_parse(struct nlmsghdr *nlh, int hdrlen, struct nlattr *tb[], int maxtype, struct nla_policy *policy)
    </p>
    <p>
      &#36825;&#20010;&#20989;&#25968;&#19982;nlmsg_parse&#31867;&#20284;&#65292;&#19981;&#21516;&#30340;&#26159;hdrlen&#30340;&#21547;&#20041;&#19981;&#21516;&#65306;
    </p>
    <p>
      &#22312;nlmsg_parse&#20013;hdrlen&#34920;&#31034;&#21327;&#35758;&#22836;&#37096;&#30340;&#38271;&#24230;
    </p>
    <p>
      &#22312;genlmsg_parse&#20013;hdrlen&#34920;&#31034;&#29992;&#25143;&#22836;&#37096;&#30340;&#38271;&#24230;&#65292;&#23427;&#21152;&#19978;&#36890;&#29992;&#28040;&#24687;&#22836;&#37096;&#30340;&#38271;&#24230;&#23601;&#26159;nlmsg_parse&#20013;hdrlen&#30340;&#21547;&#20041;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1447572441841" ID="ID_202346011" LINK="#ID_834843527" MODIFIED="1447572541866">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#23553;&#35013;&#23646;&#24615;
    </p>
    <p>
      &#19982;netlink&#28040;&#24687;&#19968;&#26679;&#65292;&#20063;&#26159;&#29992;nla_put()&#23553;&#35013;&#23646;&#24615;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1447572948938" FOLDED="true" ID="ID_1932284362" MODIFIED="1447573413211" TEXT="&#x6784;&#x9020;&#x901a;&#x7528;netlink&#x6d88;&#x606f;">
<node CREATED="1447256242748" ID="ID_112629588" MODIFIED="1447573399449" TEXT="                               &#x7c7b;&#x4f3c;&#x4e8e;nlmsg_put()&#xff0c;&#x6784;&#x9020;&#x901a;&#x7528;netlink&#x6d88;&#x606f;&#x4f7f;&#x7528;genlmsg_put&#xa;void *genlmsg_put(struct nl_msg *msg, uint32_t port, uint32_t seq, int family,&#xa;&#x9;&#x9;  int hdrlen, int flags, uint8_t cmd, uint8_t version)&#xa;&#x6784;&#x9020;netlink&#x6d88;&#x606f;&#x5934;&#x90e8;&#xa;port&#x53ef;&#x4ee5;&#x4f20;&#x5165;NL_AUTO_PORT&#xff0c;&#x8868;&#x793a;&#x7528;socket&#x7684;local port&#x4f5c;&#x4e3a;source port&#x3002;&#xa;seqnr&#x53ef;&#x4ee5;&#x4f20;&#x5165;NL_AUTO_SEQ&#xff0c;&#x8868;&#x793a;&#x81ea;&#x52a8;&#x8ba1;&#x7b97;&#x5e8f;&#x5217;&#x53f7;&#xff0c;&#x6b64;&#x65f6;&#x5e94;&#x7528;&#x51fd;&#x6570;nl_send_auto()&#x6765;&#x53d1;&#x9001;&#x6d88;&#x606f;&#xa;family&#x5373;generic netlink family(or channel)&#xff0c;&#x5b83;&#x88ab;&#x586b;&#x5165;netlink&#x6d88;&#x606f;&#x5934;&#x90e8;&#x7684;type&#x5b57;&#x6bb5;&#xa;hdrlen&#x4e3a;&#x7528;&#x6237;&#x5934;&#x90e8;&#x957f;&#x5ea6;&#xa;cmd&#x4e3a;generic netlink operation&#xff0c;&#x5373;&#x670d;&#x52a1;&#x63a5;&#x53e3;&#xff0c;&#x5b83;&#x88ab;&#x586b;&#x5165;&#x901a;&#x7528;netlink&#x6d88;&#x606f;&#x5934;&#x90e8;&#x7684;cmd&#x5b57;&#x6bb5;&#xa;version&#x8868;&#x660e;&#x4e86;&#x4e0a;&#x9762;cmd&#x7684;&#x7248;&#x672c;&#x53f7;"/>
</node>
<node CREATED="1447573425282" ID="ID_1069963992" MODIFIED="1447573445418" TEXT="&#x901a;&#x7528;netlink&#x6d88;&#x606f;&#x7684;&#x6536;&#x53d1;&#x4e0e;netlink&#x6d88;&#x606f;&#x76f8;&#x540c;"/>
</node>
</node>
<node CREATED="1447399288165" FOLDED="true" ID="ID_841740372" MODIFIED="1447658997422" TEXT="&#x7528;&#x6237;&#x7a7a;&#x95f4;&#x7f16;&#x7a0b;&#x6a21;&#x578b;">
<node CREATED="1447575680757" ID="ID_82257658" MODIFIED="1447575706737">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_generic_program_mode_1.JPG" />
  </body>
</html></richcontent>
</node>
<node CREATED="1447575724939" FOLDED="true" ID="ID_616566483" MODIFIED="1447658995244">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#25910;&#21253;&#32534;&#31243;&#27169;&#22411;
    </p>
    <p>
      &#21363;&#29992;&#25143;&#36890;&#36807;
    </p>
    <p>
      int nl_socket_modify_cb(struct nl_sock *sk, enum nl_cb_type type, enum nl_cb_kind kind, nl_recvmsg_msg_cb_t func, void *arg)
    </p>
    <p>
      &#35774;&#32622;&#30340;&#22238;&#35843;&#20989;&#25968; int nl_recvmsg_msg_cb(struct nl_msg *msg, void *arg) &#30340;&#32534;&#31243;&#27169;&#22411;
    </p>
  </body>
</html></richcontent>
<node CREATED="1447576152396" ID="ID_262799766" MODIFIED="1447576168762">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_generic_program_mode_2.JPG" />
  </body>
</html></richcontent>
<node CREATED="1447314631369" ID="ID_1784088384" MODIFIED="1447314638453">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      typedef struct {
    </p>
    <p>
      int field_1;
    </p>
    <p>
      int field_n;
    </p>
    <p>
      } my_second_struct;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1447576240347" FOLDED="true" ID="ID_624559919" MODIFIED="1447576748104" TEXT="&#x53d1;&#x5305;&#x7f16;&#x7a0b;&#x6a21;&#x578b;">
<node CREATED="1447576663881" ID="ID_1588475735" MODIFIED="1447576675824">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_generic_program_mode_3.JPG" />
  </body>
</html></richcontent>
<node CREATED="1447317272184" FOLDED="true" ID="ID_454511157" MODIFIED="1447576723834" TEXT="my_user_header">
<node CREATED="1447317278307" ID="ID_408116888" MODIFIED="1447317284159" TEXT="field_1"/>
<node CREATED="1447317284898" ID="ID_1399803910" MODIFIED="1447317291218" TEXT="field_2"/>
</node>
<node CREATED="1447314631369" ID="ID_392807364" MODIFIED="1447314638453">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      typedef struct {
    </p>
    <p>
      int field_1;
    </p>
    <p>
      int field_n;
    </p>
    <p>
      } my_second_struct;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node CREATED="1447399289541" FOLDED="true" ID="ID_1552869256" MODIFIED="1447661794881" TEXT="&#x5185;&#x6838;&#x7a7a;&#x95f4;&#x7f16;&#x7a0b;&#x6a21;&#x578b;">
<node CREATED="1447658128678" ID="ID_756735499" MODIFIED="1447658155325">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_generic_program_mode_4.JPG" />
  </body>
</html>
</richcontent>
</node>
<node CREATED="1447655836712" FOLDED="true" ID="ID_1272263363" MODIFIED="1447661083572">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#25910;&#21253;&#32534;&#31243;&#27169;&#22411;
    </p>
    <p>
      &#21363;&#29992;&#25143;&#22312;my_nl_genl_ops&#25968;&#32452;&#20013;&#25351;&#23450;&#30340;&#21508;&#20010;&#26381;&#21153;&#25509;&#21475;&#20989;&#25968;&#65306;
    </p>
    <p>
      int my_cmd_1(struct sk_buff *skb, struct genl_info *info)
    </p>
    <p>
      int my_cmd_2(struct sk_buff *skb, struct genl_info *info)
    </p>
  </body>
</html>
</richcontent>
<node CREATED="1447658627666" ID="ID_608214071" MODIFIED="1447658714862">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      netlink&#28040;&#24687;&#22836;&#37096;&#24050;&#34987;&#35299;&#26512;&#65292;&#23384;&#25918;&#20110;info-&gt;nlhdr&#65292;&#19968;&#33324;&#26469;&#35828;&#29992;&#25143;&#19981;&#38656;&#35201;&#27492;&#20449;&#24687;
    </p>
    <p>
      struct nlmsghdr *nlh = info-&gt;nlhdr
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1447658627666" ID="ID_1792385750" MODIFIED="1447658763612">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#36890;&#29992;netlink&#28040;&#24687;&#22836;&#37096;&#24050;&#34987;&#35299;&#26512;&#65292;&#23384;&#25918;&#20110;info-&gt;genlhdr&#65292;&#19968;&#33324;&#26469;&#35828;&#29992;&#25143;&#19981;&#38656;&#35201;&#27492;&#20449;&#24687;
    </p>
    <p>
      struct genlmsghdr *gnlh = info-&gt;genlhdr
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1447658627666" ID="ID_150527981" MODIFIED="1447659065718">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#23646;&#24615;&#22836;&#37096;&#24050;&#34987;&#35299;&#26512;&#65292;&#23384;&#25918;&#20110;info-&gt;attrs&#65292;
    </p>
    <p>
      struct nlattr *na = info-&gt;attrs[MY_FIRST_ATTR]&#65307;
    </p>
    <p>
      my_first_attr_t *my_first_attr_p = nla_data(na)&#65307;
    </p>
  </body>
</html>
</richcontent>
<node CREATED="1447659067961" ID="ID_63905004" MODIFIED="1447659121440">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      typedef struct {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;int field_1;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;int field_2;
    </p>
    <p>
      } my_first_attr_t ;
    </p>
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node CREATED="1447655846242" FOLDED="true" ID="ID_1277594236" MODIFIED="1447661792567" TEXT="&#x53d1;&#x5305;&#x7f16;&#x7a0b;&#x6a21;&#x578b;">
<node CREATED="1447661086295" ID="ID_1317070325" MODIFIED="1447661102994">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="pic/netlink_generic_program_mode_5.JPG" />
  </body>
</html>
</richcontent>
<node CREATED="1447661111146" ID="ID_1015528810" MODIFIED="1447661246354">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      genlmsg_new()&#30340;&#31532;&#19968;&#20010;&#21442;&#25968;&#26159;payload&#30340;&#38271;&#24230;&#65292;&#23427;&#26159;&#25351;&#36890;&#29992;netlink&#28040;&#24687;&#22836;&#37096;&#21518;&#38754;&#30340;&#25152;&#26377;&#37096;&#20998;&#30340;&#38271;&#24230;&#12290;
    </p>
    <p>
      &#36890;&#29992;netlink&#28040;&#24687;&#22836;&#37096;&#21518;&#38754;&#21487;&#20197;&#26159;&#29992;&#25143;&#22836;&#37096;&#21152;&#29992;&#25143;&#25968;&#25454;&#65292;&#20063;&#21487;&#20197;&#26159;&#23646;&#24615;&#21015;&#34920;&#12290;
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1447661381346" ID="ID_172970315" MODIFIED="1447661584596">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      void *genlmsg_put(struct sk_buff *skb, u32 portid, u32 seq,
    </p>
    <p>
      &#160;&#160;struct genl_family *family, int flags, u8 cmd);
    </p>
    <p>
      portid&#25351;&#33258;&#24049;socket&#30340;port&#65292;&#20869;&#26680;&#20013;&#36890;&#29992;netlink socket&#30340;port&#20026;0&#65292;
    </p>
    <p>
      &#22914;&#26524;&#20851;&#38381;&#24207;&#21015;&#21495;&#21017;&#24207;&#21015;&#21495;&#20026;0
    </p>
    <p>
      flags&#19968;&#33324;&#35774;&#20026;0
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1447661601648" ID="ID_371781519" MODIFIED="1447661771004">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      genlmsg_multicast()&#20013;&#30340;group&#21442;&#25968;&#22312;&#20869;&#26680;&#29256;&#26412;3.13.0&#20043;&#21069;&#21644;&#20043;&#21518;&#26377;&#25152;&#19981;&#21516;&#65306;
    </p>
    <p>
      &#22312;3.13.0&#20043;&#21069;&#65292;&#23427;&#26159;&#19968;&#20010;&#30001;&#20869;&#26680;&#21160;&#24577;&#29983;&#25104;&#30340;&#25968;&#23383;&#65292;&#21363;&#20855;&#20307;&#30340;&#32452;
    </p>
    <p>
      &#22312;3.13.0&#20043;&#21518;&#65292;&#23427;&#26159;&#19968;&#20010;&#32452;&#20559;&#31227;&#65292;&#21363;&#29992;&#25143;&#23450;&#20041;&#30340;&#25968;&#32452;<font size="12.0pt" face="Calibri" color="black">struct&#160; genl_multicast_group&#160;my_nl_genl_mcgrp[]&#30340;&#19979;&#26631;</font>
    </p>
  </body>
</html>
</richcontent>
</node>
</node>
</node>
</node>
</node>
</node>
<node CREATED="1321703197962" FOLDED="true" ID="ID_1390056068" MODIFIED="1447184584042" POSITION="right" TEXT="&#x7528;&#x6237;&#x5c42;&#x63a5;&#x53e3;">
<node CREATED="1321707564390" FOLDED="true" ID="ID_169216312" MODIFIED="1387853488694" TEXT="int socket(int domain, int type, int protocol)">
<node CREATED="1321710114863" ID="ID_1405660554" MODIFIED="1321710248417" TEXT="type&#x9664;&#x4e86;&#x8868;&#x793a;&#x7c7b;&#x578b;&#x5916;&#xff0c;&#x8fd8;&#x53ef;&#x4ee5;&#x6216;&#x4e0a;&#xa;SOCK_NONBLOCK&#xff0c;SOCK_CLOEXEC"/>
</node>
<node CREATED="1333182810819" FOLDED="true" ID="ID_423183904" MODIFIED="1333249246109" TEXT="ssize_t send(int sockfd, const void *buf, size_t len, int flags)">
<node CREATED="1333182483892" ID="ID_639460213" MODIFIED="1333182527020" TEXT="sockfd : &#x5e94;&#x4e3a;&#x4e0a;&#x9762;socket&#x51fd;&#x6570;&#x7684;&#x8fd4;&#x56de;&#x503c;"/>
<node CREATED="1333184003444" ID="ID_759764998" MODIFIED="1333184020134" TEXT="buf : &#x6d88;&#x606f;&#x7f13;&#x51b2;&#x533a;"/>
<node CREATED="1333184020714" ID="ID_942026444" MODIFIED="1333184033115" TEXT="len : &#x6d88;&#x606f;&#x957f;&#x5ea6;"/>
<node CREATED="1333185239482" ID="ID_1399642493" LINK="#ID_182507179" MODIFIED="1333185250814" TEXT="flags"/>
<node CREATED="1333183006909" FOLDED="true" ID="ID_68324234" MODIFIED="1333185224951" TEXT="&#x4f7f;&#x7528;&#x6307;&#x5357;">
<node CREATED="1333183029840" ID="ID_251930598" MODIFIED="1333183040080" TEXT="&#x6b64;&#x51fd;&#x6570;&#x987b;&#x5728;socket&#x5df2;&#x5904;&#x4e8e;connected&#x72b6;&#x6001;&#x65f6;&#x4f7f;&#x7528;,&#x8fd9;&#x6837;&#x6d88;&#x606f;&#x7684;&#x63a5;&#x53d7;&#x8005;&#x624d;&#x662f;&#x786e;&#x5b9a;&#x7684;"/>
</node>
</node>
<node CREATED="1333183150376" FOLDED="true" ID="ID_348871247" MODIFIED="1333192144731" TEXT="ssize_t sendto(int sockfd, const void *buf, size_t len, int flags,&#xa;                       const struct sockaddr *dest_addr, socklen_t addrlen)">
<node CREATED="1333182483892" ID="ID_1935029144" MODIFIED="1333182527020" TEXT="sockfd : &#x5e94;&#x4e3a;&#x4e0a;&#x9762;socket&#x51fd;&#x6570;&#x7684;&#x8fd4;&#x56de;&#x503c;"/>
<node CREATED="1333184003444" ID="ID_599021779" MODIFIED="1333184020134" TEXT="buf : &#x6d88;&#x606f;&#x7f13;&#x51b2;&#x533a;"/>
<node CREATED="1333184020714" ID="ID_700251160" MODIFIED="1333184033115" TEXT="len : &#x6d88;&#x606f;&#x957f;&#x5ea6;"/>
<node CREATED="1333184353881" FOLDED="true" ID="ID_182507179" MODIFIED="1333192142185" TEXT="flags">
<node CREATED="1333184366366" ID="ID_1727075636" MODIFIED="1333184415068" TEXT="MSG_CONFIRM : &#x89e6;&#x53d1;&#x94fe;&#x8def;&#x5c42;&#x7684;arp"/>
<node CREATED="1333184468123" ID="ID_1749198447" MODIFIED="1333184567880" TEXT="MSG_DONTROUTE : &#x4e0d;&#x8981;&#x7528;&#x8def;&#x7531;&#x6b64;&#x5305;,&#x4ec5;&#x5c06;&#x5305;&#x53d1;&#x9001;&#x5230;linklocal&#x76f4;&#x8fde;&#x7f51;&#x7edc;&#x4e0a;"/>
<node CREATED="1333184601408" ID="ID_1952294687" MODIFIED="1333184628692" TEXT="MSG_DONTWAIT : &#x9488;&#x5bf9;&#x6b64;&#x5305;&#x542f;&#x7528;&#x975e;&#x963b;&#x585e;&#x6a21;&#x5f0f;"/>
<node CREATED="1333184734781" ID="ID_1457530582" MODIFIED="1333184872548" TEXT="MSG_MORE : &#x544a;&#x8bc9;&#x5185;&#x6838;,&#x81ea;&#x5df1;&#x8fd8;&#x6709;&#x5305;&#x9700;&#x8981;&#x53d1;&#x9001;,&#x8bf7;&#x5c06;&#x6b64;&#x6d88;&#x606f;&#x53ca;&#xa;&#x540e;&#x7eed;&#x5e26;&#x6709;MSG_MORE&#x6807;&#x5fd7;&#x7684;&#x6d88;&#x606f;&#x7ec4;&#x5408;&#x4e3a;&#x4e00;&#x4e2a;&#x62a5;&#x6587;&#x5728;&#x7f51;&#x7edc;&#x4e0a;&#x53d1;&#x9001;"/>
<node CREATED="1333184910645" ID="ID_1225600211" MODIFIED="1333184933740" TEXT="MSG_NOSIGNAL : &#x6709;&#x9519;&#x8bef;&#x65f6;&#x8bf7;&#x4e0d;&#x8981;&#x53d1;&#x9001;&#x4fe1;&#x53f7;&#x4e2d;&#x65ad;&#x6211;"/>
<node CREATED="1333184960601" ID="ID_1392459" MODIFIED="1333185008249" TEXT="MSG_OOB : &#x6b64;&#x6d88;&#x606f;&#x4e3a;&#x5e26;&#x5916;&#x6570;&#x636e;&#x5373;&#x7d27;&#x6025;&#x6570;&#x636e;"/>
</node>
<node CREATED="1333183770449" ID="ID_1276860390" LINK="#ID_220239598" MODIFIED="1333183982448" TEXT="struct sockaddr *dest_addr : &#x76ee;&#x7684;&#x5730;&#x5740;"/>
<node CREATED="1333183797690" ID="ID_1654931619" MODIFIED="1333183814388" TEXT="addrlen : &#x76ee;&#x7684;&#x5730;&#x5740;&#x7684;&#x957f;&#x5ea6;"/>
<node CREATED="1333183006909" FOLDED="true" ID="ID_244686721" MODIFIED="1333184042307" TEXT="&#x4f7f;&#x7528;&#x6307;&#x5357;">
<node CREATED="1333183029840" ID="ID_1906900321" MODIFIED="1333183730787" TEXT="&#x5f53;socket&#x5df2;&#x5904;&#x4e8e;connected&#x72b6;&#x6001;&#x65f6;,&#x53c2;&#x6570;dest_addr&#x548c;addrlen&#x5c06;&#x88ab;&#x5ffd;&#x7565;,&#x56e0;&#x4e3a;&#xa;socket&#x5904;&#x4e8e;connected&#x72b6;&#x6001;&#x65f6;&#x76ee;&#x7684;&#x5730;&#x5740;&#x5df2;&#x77e5;.&#x540c;&#x7406;, &#x5f53;socket&#x4e0d;&#x4e3a;connected&#x65f6;,&#xa;&#x53c2;&#x6570;dest_addr&#x548c;addrlen&#x5fc5;&#x987b;&#x6307;&#x5b9a;"/>
</node>
</node>
<node CREATED="1333182456453" FOLDED="true" ID="ID_709053698" MODIFIED="1333192736276" TEXT="ssize_t sendmsg(int sockfd, const struct msghdr *msg, int flags)">
<node CREATED="1333182483892" ID="ID_1148588169" MODIFIED="1333182527020" TEXT="sockfd : &#x5e94;&#x4e3a;&#x4e0a;&#x9762;socket&#x51fd;&#x6570;&#x7684;&#x8fd4;&#x56de;&#x503c;"/>
<node CREATED="1333182535272" FOLDED="true" ID="ID_393084825" MODIFIED="1359869954923" TEXT="struct msghdr *msg">
<node CREATED="1333182592375" FOLDED="true" ID="ID_251049420" MODIFIED="1359869954923" TEXT="void *msg_name : &#x76ee;&#x7684;&#x5730;&#x5740;">
<node CREATED="1333188285433" ID="ID_122450555" LINK="#ID_964361784" MODIFIED="1333188331783" TEXT="&#x5f53;socket&#x4e3a;AF_NETLINK&#x65f6;,&#x6b64;&#x5904;&#x5e94;&#x4e3a;struct sockaddr_nl"/>
</node>
<node CREATED="1333182613839" ID="ID_25104311" MODIFIED="1333184136504" TEXT="int msg_namelen : &#x76ee;&#x7684;&#x5730;&#x5740;&#x7684;&#x957f;&#x5ea6;"/>
<node CREATED="1333182631736" FOLDED="true" ID="ID_1930800054" MODIFIED="1359869954923" TEXT="struct iovec *msg_iov : &#x6d88;&#x606f;&#x7247;&#x6bb5;&#x6570;&#x7ec4;,&#x6bcf;&#x4e2a;&#x6d88;&#x606f;&#x7247;&#x6bb5;&#x7531;&#x4e00;&#x4e2a;struct iovec&#x8868;&#x793a;">
<node CREATED="1333185407234" FOLDED="true" ID="ID_608371399" MODIFIED="1359869954923" TEXT="void *iov_base : &#x6307;&#x5411;&#x6d88;&#x606f;&#x7247;&#x6bb5;&#x5185;&#x5bb9;&#x7684;&#x6307;&#x9488;">
<node CREATED="1333188680853" ID="ID_1285940069" MODIFIED="1333188809283" TEXT="&#x5f53;socket&#x4e3a;AF_NETLINK&#x65f6;,&#x6d88;&#x606f;&#x7247;&#x6bb5;&#x5305;&#x542b;2&#x90e8;&#x5206;:&#xa;struct nlmsghdr : netlink&#x6d88;&#x606f;&#x56fa;&#x6709;&#x5934;&#x90e8;&#xa;struct user_data_struct : &#x7528;&#x6237;&#x81ea;&#x5b9a;&#x4e49;&#x6d88;&#x606f;&#x683c;&#x5f0f;"/>
</node>
<node CREATED="1333185413681" ID="ID_541072446" MODIFIED="1333186268886" TEXT="int iov_len : &#x6d88;&#x606f;&#x7247;&#x6bb5;&#x5185;&#x5bb9;&#x7684;&#x957f;&#x5ea6;"/>
</node>
<node CREATED="1333182645908" ID="ID_460940863" MODIFIED="1333186247397" TEXT="int msg_iovlen : &#x6d88;&#x606f;&#x7247;&#x6bb5;&#x4e2a;&#x6570;"/>
<node CREATED="1333182667900" FOLDED="true" ID="ID_1536353208" MODIFIED="1359869954923" TEXT="void *msg_control">
<node CREATED="1333192149238" FOLDED="true" ID="ID_6701658" MODIFIED="1359869954923" TEXT="struct cmsghdr">
<node CREATED="1333192168012" ID="ID_600497039" MODIFIED="1333192175182" TEXT="socklen_t cmsg_len"/>
<node CREATED="1333192184547" ID="ID_58842830" MODIFIED="1333192188707" TEXT="int cmsg_level"/>
<node CREATED="1333192196002" ID="ID_184747503" MODIFIED="1333192198133" TEXT="int cmsg_type"/>
<node CREATED="1333192207235" ID="ID_1893576461" MODIFIED="1333192208885" TEXT="unsigned char cmsg_data[]"/>
<node CREATED="1333192416092" FOLDED="true" ID="ID_885475281" MODIFIED="1359869954923" TEXT="&#x64cd;&#x4f5c;&#x5b8f;">
<node CREATED="1333192452869" ID="ID_1368835747" MODIFIED="1333192481557" TEXT="struct cmsghdr *CMSG_FIRSTHDR(struct msghdr *msgh)&#xa;&#x83b7;&#x53d6;&#x7b2c;&#x4e00;&#x4e2a;&#x63a7;&#x5236;&#x6d88;&#x606f;"/>
<node CREATED="1333192501624" ID="ID_501241367" MODIFIED="1333192533661" TEXT="struct cmsghdr *CMSG_NXTHDR(struct msghdr *msgh, struct cmsghdr *cmsg)&#xa;&#x83b7;&#x53d6;msgh&#x4e2d;cmsg&#x7684;&#x4e0b;&#x4e00;&#x4e2a;&#x63a7;&#x5236;&#x6d88;&#x606f;"/>
<node CREATED="1333192592355" ID="ID_49497293" MODIFIED="1333192612284" TEXT="unsigned char *CMSG_DATA(struct cmsghdr *cmsg)&#xa;&#x63a7;&#x5236;&#x6d88;&#x606f;&#x7684;&#x5185;&#x5bb9;"/>
</node>
</node>
</node>
<node CREATED="1333182695067" ID="ID_563046963" MODIFIED="1333192696099" TEXT="int msg_controllen : &#x63a7;&#x5236;&#x6d88;&#x606f;&#x7684;&#x957f;&#x5ea6;"/>
<node CREATED="1333182706683" ID="ID_307603569" MODIFIED="1333185141831" TEXT="unsigned int msg_flags : &#x53d1;&#x9001;&#x6d88;&#x606f;&#x65f6;&#x4e0d;&#x4f7f;&#x7528;&#x6b64;&#x5b57;&#x6bb5;"/>
</node>
<node CREATED="1333185177985" ID="ID_1207431119" LINK="#ID_182507179" MODIFIED="1333185189687" TEXT="flags"/>
</node>
<node CREATED="1333189981064" FOLDED="true" ID="ID_1447021629" MODIFIED="1333191807767" TEXT="ssize_t recv(int sockfd, void *buf, size_t len, int flags)">
<node CREATED="1333182483892" ID="ID_180578736" MODIFIED="1333182527020" TEXT="sockfd : &#x5e94;&#x4e3a;&#x4e0a;&#x9762;socket&#x51fd;&#x6570;&#x7684;&#x8fd4;&#x56de;&#x503c;"/>
<node CREATED="1333184003444" ID="ID_1288011872" MODIFIED="1333184020134" TEXT="buf : &#x6d88;&#x606f;&#x7f13;&#x51b2;&#x533a;"/>
<node CREATED="1333184020714" ID="ID_1179264955" MODIFIED="1333190042057" TEXT="len : &#x53ef;&#x5bb9;&#x7eb3;&#x7684;&#x6d88;&#x606f;&#x957f;&#x5ea6;"/>
<node CREATED="1333190052699" ID="ID_999170975" LINK="#ID_232163984" MODIFIED="1333191790983" TEXT="flags"/>
<node CREATED="1333183006909" FOLDED="true" ID="ID_1961984414" MODIFIED="1333191102892" TEXT="&#x4f7f;&#x7528;&#x6307;&#x5357;">
<node CREATED="1333183029840" ID="ID_1201190778" MODIFIED="1333191062117" TEXT="&#x6b64;&#x51fd;&#x6570;&#x987b;&#x5728;socket&#x5df2;&#x5904;&#x4e8e;connected&#x72b6;&#x6001;&#x6216;binded&#x72b6;&#x6001;&#x65f6;&#x4f7f;&#x7528;"/>
</node>
</node>
<node CREATED="1333189947140" FOLDED="true" ID="ID_1010995267" MODIFIED="1333191806120" TEXT="ssize_t recvfrom(int sockfd, void *buf, size_t len, int flags,&#xa;                          struct sockaddr *src_addr, socklen_t *addrlen)">
<node CREATED="1333182483892" ID="ID_884282875" MODIFIED="1333182527020" TEXT="sockfd : &#x5e94;&#x4e3a;&#x4e0a;&#x9762;socket&#x51fd;&#x6570;&#x7684;&#x8fd4;&#x56de;&#x503c;"/>
<node CREATED="1333184003444" ID="ID_292296857" MODIFIED="1333184020134" TEXT="buf : &#x6d88;&#x606f;&#x7f13;&#x51b2;&#x533a;"/>
<node CREATED="1333184020714" ID="ID_1979912527" MODIFIED="1333190042057" TEXT="len : &#x53ef;&#x5bb9;&#x7eb3;&#x7684;&#x6d88;&#x606f;&#x957f;&#x5ea6;"/>
<node CREATED="1333190052699" FOLDED="true" ID="ID_232163984" MODIFIED="1359869954923" TEXT="flags">
<node CREATED="1333184601408" ID="ID_1682524817" MODIFIED="1333184628692" TEXT="MSG_DONTWAIT : &#x9488;&#x5bf9;&#x6b64;&#x5305;&#x542f;&#x7528;&#x975e;&#x963b;&#x585e;&#x6a21;&#x5f0f;"/>
<node CREATED="1333184960601" ID="ID_644334345" MODIFIED="1333191408939" TEXT="MSG_OOB : &#x8bf7;&#x6c42;&#x63a5;&#x6536;&#x5e26;&#x5916;&#x6570;&#x636e;&#x5373;&#x7d27;&#x6025;&#x6570;&#x636e;"/>
<node CREATED="1333191440787" ID="ID_562915517" MODIFIED="1333191511895" TEXT="MSG_PEEK : &#x63a5;&#x6536;&#x4e00;&#x4e2a;&#x6d88;&#x606f;,&#x4f46;&#x4e0d;&#x8981;&#x4ece;socket&#x7684;receive queue&#x4e2d;&#x5220;&#x9664;&#x5b83;,&#x8fd9;&#x6837;&#x4e0b;&#x6b21;&#x8fd8;&#x80fd;&#x53d6;&#x5230;&#x6b64;&#x6d88;&#x606f;"/>
<node CREATED="1333191585535" ID="ID_1666838433" MODIFIED="1333191673750" TEXT="MSG_WAITALL : &#x4e00;&#x5b9a;&#x8981;&#x5728;&#x63a5;&#x6536;&#x5230;&#x6240;&#x9700;&#x8981;&#x957f;&#x5ea6;&#x7684;&#x6570;&#x636e;&#x540e;&#x518d;&#x8fd4;&#x56de;,&#x5426;&#x5219;&#x8bf7;&#x7b49;&#x5f85;"/>
<node CREATED="1333191690073" ID="ID_978497892" MODIFIED="1333191770971" TEXT="MSG_TRUNC : &#x82e5;&#x6d88;&#x606f;&#x957f;&#x5ea6;&#x5927;&#x4e8e;&#x7f13;&#x51b2;&#x533a;,&#x5219;&#x622a;&#x65ad;&#x5b83;, &#x4f46;&#x8bf7;&#x8fd4;&#x56de;&#x5b9e;&#x9645;&#x6d88;&#x606f;&#x7684;&#x957f;&#x5ea6;,&#x800c;&#x4e0d;&#x662f;&#x622a;&#x65ad;&#x540e;&#x7684;&#x957f;&#x5ea6;"/>
</node>
<node CREATED="1333190210142" ID="ID_756554725" MODIFIED="1333190400752" TEXT="src_addr :&#x5f53;&#x6b64;&#x6307;&#x9488;&#x4e0d;&#x4e3a;NULL&#x65f6;,&#x6b64;&#x5904;&#x5b58;&#x653e;&#x6240;&#x6536;&#x5230;&#x6d88;&#x606f;&#x7684;&#x6e90;&#x5730;&#x5740;,&#x5373;&#x53d1;&#x9001;&#x6b64;&#x6d88;&#x606f;&#x7684;&#x5bf9;&#x7aef;&#x5730;&#x5740;&#xa;                &#x5f53;&#x6b64;&#x6307;&#x9488;&#x4e3a;NULL&#x65f6;,&#x8868;&#x793a;&#x4e0d;&#x60f3;&#x77e5;&#x9053;&#x6d88;&#x606f;&#x7684;&#x6e90;&#x5730;&#x5740;,&#x6b64;&#x65f6;addrlen&#x5c06;&#x88ab;&#x5ffd;&#x7565;"/>
<node CREATED="1333190217520" ID="ID_120535460" MODIFIED="1333190464220" TEXT="addrlen : &#x4f20;&#x5165;&#x65f6;&#x4e3a;src_addr&#x7684;&#x53ef;&#x5bb9;&#x7eb3;&#x5927;&#x5c0f;,&#x4f20;&#x56de;&#x65f6;&#x4e3a;src_addr&#x7684;&#x5b9e;&#x9645;&#x5927;&#x5c0f;"/>
<node CREATED="1333183006909" FOLDED="true" ID="ID_1733583504" MODIFIED="1333191104251" TEXT="&#x4f7f;&#x7528;&#x6307;&#x5357;">
<node CREATED="1333183029840" ID="ID_1274232724" MODIFIED="1333191062117" TEXT="&#x6b64;&#x51fd;&#x6570;&#x987b;&#x5728;socket&#x5df2;&#x5904;&#x4e8e;connected&#x72b6;&#x6001;&#x6216;binded&#x72b6;&#x6001;&#x65f6;&#x4f7f;&#x7528;"/>
</node>
</node>
<node CREATED="1333189933692" FOLDED="true" ID="ID_1679983036" MODIFIED="1333192733016" TEXT="ssize_t recvmsg(int sockfd, struct msghdr *msg, int flags);">
<node CREATED="1333182483892" ID="ID_101187988" MODIFIED="1333182527020" TEXT="sockfd : &#x5e94;&#x4e3a;&#x4e0a;&#x9762;socket&#x51fd;&#x6570;&#x7684;&#x8fd4;&#x56de;&#x503c;"/>
<node CREATED="1333182535272" FOLDED="true" ID="ID_869428082" MODIFIED="1359869954923" TEXT="struct msghdr *msg">
<node CREATED="1333182592375" FOLDED="true" ID="ID_929617802" MODIFIED="1359869954923" TEXT="void *msg_name : &#x6e90;&#x5730;&#x5740;">
<node CREATED="1333188285433" ID="ID_182833233" LINK="#ID_964361784" MODIFIED="1333188331783" TEXT="&#x5f53;socket&#x4e3a;AF_NETLINK&#x65f6;,&#x6b64;&#x5904;&#x5e94;&#x4e3a;struct sockaddr_nl"/>
</node>
<node CREATED="1333182613839" ID="ID_1615201305" MODIFIED="1333191217487" TEXT="int msg_namelen : &#x6e90;&#x5730;&#x5740;&#x7684;&#x957f;&#x5ea6;"/>
<node CREATED="1333182631736" FOLDED="true" ID="ID_1858450328" MODIFIED="1359869954923" TEXT="struct iovec *msg_iov : &#x6d88;&#x606f;&#x7247;&#x6bb5;&#x6570;&#x7ec4;,&#x6bcf;&#x4e2a;&#x6d88;&#x606f;&#x7247;&#x6bb5;&#x7531;&#x4e00;&#x4e2a;struct iovec&#x8868;&#x793a;">
<node CREATED="1333185407234" FOLDED="true" ID="ID_990902917" MODIFIED="1359869954923" TEXT="void *iov_base : &#x6307;&#x5411;&#x6d88;&#x606f;&#x7247;&#x6bb5;&#x5185;&#x5bb9;&#x7684;&#x6307;&#x9488;">
<node CREATED="1333188680853" ID="ID_175148129" MODIFIED="1333188809283" TEXT="&#x5f53;socket&#x4e3a;AF_NETLINK&#x65f6;,&#x6d88;&#x606f;&#x7247;&#x6bb5;&#x5305;&#x542b;2&#x90e8;&#x5206;:&#xa;struct nlmsghdr : netlink&#x6d88;&#x606f;&#x56fa;&#x6709;&#x5934;&#x90e8;&#xa;struct user_data_struct : &#x7528;&#x6237;&#x81ea;&#x5b9a;&#x4e49;&#x6d88;&#x606f;&#x683c;&#x5f0f;"/>
</node>
<node CREATED="1333185413681" ID="ID_1754373114" MODIFIED="1333186268886" TEXT="int iov_len : &#x6d88;&#x606f;&#x7247;&#x6bb5;&#x5185;&#x5bb9;&#x7684;&#x957f;&#x5ea6;"/>
</node>
<node CREATED="1333182645908" ID="ID_159911509" MODIFIED="1333186247397" TEXT="int msg_iovlen : &#x6d88;&#x606f;&#x7247;&#x6bb5;&#x4e2a;&#x6570;"/>
<node CREATED="1333182667900" ID="ID_7644999" LINK="#ID_1536353208" MODIFIED="1333192674720" TEXT="void *msg_control"/>
<node CREATED="1333182695067" ID="ID_1624966896" MODIFIED="1333192700906" TEXT="int msg_controllen : &#x63a7;&#x5236;&#x6d88;&#x606f;&#x7684;&#x957f;&#x5ea6;"/>
<node CREATED="1333182706683" FOLDED="true" ID="ID_649044432" MODIFIED="1333192096104" TEXT="unsigned int msg_flags">
<node CREATED="1333191956949" ID="ID_24100645" MODIFIED="1333191967904" TEXT="MSG_EOR : &#x8bb0;&#x5f55;&#x7ed3;&#x675f;"/>
<node CREATED="1333191977036" ID="ID_1001652291" MODIFIED="1333191987259" TEXT="MSG_TRUNC : &#x6d88;&#x606f;&#x88ab;&#x622a;&#x65ad;"/>
<node CREATED="1333191995258" ID="ID_1073757101" MODIFIED="1333192005998" TEXT="MSG_CTRUNC : &#x63a7;&#x5236;&#x6d88;&#x606f;&#x88ab;&#x622a;&#x65ad;"/>
<node CREATED="1333192019318" ID="ID_1783678338" MODIFIED="1333192043755" TEXT="MSG_OOB : &#x6709;&#x8fd8;&#x672a;&#x8bfb;&#x53d6;&#x7684;&#x5e26;&#x5916;&#x6570;&#x636e;"/>
<node CREATED="1333192057519" ID="ID_484967976" MODIFIED="1333192092647" TEXT="MSG_ERRQUEUE : receive queue&#x6709;&#x9519;&#x8bef;&#x53d1;&#x751f;"/>
</node>
</node>
<node CREATED="1333190052699" ID="ID_97277002" LINK="#ID_232163984" MODIFIED="1333191798897" TEXT="flags"/>
</node>
<node CREATED="1333192811875" ID="ID_1740671768" MODIFIED="1405577889154" TEXT="int bind(int sockfd, const struct sockaddr *addr, socklen_t addrlen)">
<node CREATED="1333182483892" ID="ID_1602676598" MODIFIED="1333182527020" TEXT="sockfd : &#x5e94;&#x4e3a;&#x4e0a;&#x9762;socket&#x51fd;&#x6570;&#x7684;&#x8fd4;&#x56de;&#x503c;"/>
<node CREATED="1333192842958" FOLDED="true" ID="ID_1569817958" LINK="#ID_220239598" MODIFIED="1333193035716" TEXT="addr">
<node CREATED="1333192981849" ID="ID_574866734" LINK="#ID_964361784" MODIFIED="1333193018334" TEXT="&#x82e5;socket&#x4e3a;AF_NETLINK&#x5219;&#x6b64;&#x5904;&#x5e94;&#x4e3a;struct sockaddr_nl"/>
</node>
<node CREATED="1333192849029" ID="ID_1502540123" MODIFIED="1333193049454" TEXT="addrlen : addr&#x7684;&#x957f;&#x5ea6;"/>
</node>
<node CREATED="1405577838116" ID="ID_580643672" MODIFIED="1405577881974" TEXT="int ioctl(int fd, int request, struct ifreq *ifr)">
<node CREATED="1333182483892" ID="ID_958190550" MODIFIED="1333182527020" TEXT="sockfd : &#x5e94;&#x4e3a;&#x4e0a;&#x9762;socket&#x51fd;&#x6570;&#x7684;&#x8fd4;&#x56de;&#x503c;"/>
<node CREATED="1405577906945" ID="ID_823049723" MODIFIED="1405577911205" TEXT="request"/>
<node CREATED="1405577913616" ID="ID_1601333093" MODIFIED="1405577916867" TEXT="ifr"/>
</node>
<node CREATED="1333183865812" FOLDED="true" ID="ID_1926664402" MODIFIED="1447184582092" TEXT="&#x6570;&#x636e;&#x7ed3;&#x6784;">
<node CREATED="1333183893870" FOLDED="true" ID="ID_220239598" MODIFIED="1359869954923" TEXT="struct sockaddr">
<node CREATED="1333183948427" ID="ID_769728463" MODIFIED="1333183954188" TEXT="sa_family_t sa_family"/>
<node CREATED="1333183963092" ID="ID_702386525" MODIFIED="1333183970120" TEXT="char sa_data[14]"/>
</node>
<node CREATED="1405577940464" ID="ID_1907115122" MODIFIED="1405577942359" TEXT="struct ifreq">
<node CREATED="1405577953264" FOLDED="true" ID="ID_1269512282" MODIFIED="1405578431662" TEXT="union ifr_ifrn">
<node CREATED="1405577988815" ID="ID_1367682483" MODIFIED="1405577997196" TEXT="char ifrn_name[IFNAMSIZ]"/>
</node>
<node CREATED="1405578014944" FOLDED="true" ID="ID_493099530" MODIFIED="1405578430422" TEXT="union ifr_ifru">
<node CREATED="1405578037600" ID="ID_1862736007" MODIFIED="1405578042616" TEXT="struct sockaddr ifru_addr"/>
<node CREATED="1405578053264" ID="ID_1876582599" MODIFIED="1405578092878" TEXT="struct sockaddr ifru_dstaddr"/>
<node CREATED="1405578096255" ID="ID_1999138648" MODIFIED="1405578102767" TEXT="struct sockaddr ifru_broadaddr"/>
<node CREATED="1405578114575" ID="ID_1525837600" MODIFIED="1405578122189" TEXT="struct sockaddr ifru_netmask"/>
<node CREATED="1405578132976" ID="ID_1554641582" MODIFIED="1405578141409" TEXT="struct sockaddr ifru_hwaddr"/>
<node CREATED="1405578160882" ID="ID_1692325907" MODIFIED="1405578166312" TEXT="short ifru_flags"/>
<node CREATED="1405578177136" ID="ID_1245924691" MODIFIED="1405578182177" TEXT="int ifru_ivalue"/>
<node CREATED="1405578192848" ID="ID_1462482366" MODIFIED="1405578197318" TEXT="int ifru_mtu"/>
<node CREATED="1405578210736" ID="ID_1000682154" MODIFIED="1405578221296" TEXT="struct ifmap ifru_map"/>
<node CREATED="1405578234399" ID="ID_1698091946" MODIFIED="1405578239955" TEXT="char ifru_slave[IFNAMSIZ]"/>
<node CREATED="1405578256783" ID="ID_1515035534" MODIFIED="1405578266719" TEXT="char ifru_newname[IFNAMSIZ]"/>
<node CREATED="1405578280464" ID="ID_991346932" MODIFIED="1405578294521" TEXT="void user *ifru_data"/>
<node CREATED="1405578311200" ID="ID_278958250" MODIFIED="1405578318771" TEXT="struct if_settings ifru_settings"/>
</node>
<node CREATED="1405579376720" FOLDED="true" ID="ID_924457837" MODIFIED="1405579445895" TEXT="access macro">
<node CREATED="1405578433871" ID="ID_819513665" MODIFIED="1405579369109" TEXT="#define ifr_name         ifr_ifrn.ifrn_name    /* interface name &#x9;*/"/>
<node CREATED="1405578450208" ID="ID_1585683474" MODIFIED="1405579356069" TEXT="#define ifr_hwaddr      ifr_ifru.ifru_hwaddr    /* MAC address &#x9;&#x9;*/"/>
<node CREATED="1405578462848" ID="ID_480576194" MODIFIED="1405579344952" TEXT="#define ifr_addr          ifr_ifru.ifru_addr    /* address&#x9;&#x9;*/"/>
<node CREATED="1405578476000" ID="ID_1304772272" MODIFIED="1405579322743" TEXT="#define ifr_dstaddr     ifr_ifru.ifru_dstaddr    /* other end of p-p lnk&#x9;*/"/>
<node CREATED="1405578488320" ID="ID_1457066952" MODIFIED="1405579043901" TEXT="#define ifr_broadaddr ifr_ifru.ifru_broadaddr    /* broadcast address&#x9;*/"/>
<node CREATED="1405578501056" ID="ID_1769759225" MODIFIED="1405579085838" TEXT="#define ifr_netmask    ifr_ifru.ifru_netmask    /* interface net mask&#x9;*/"/>
<node CREATED="1405578514224" ID="ID_1190789772" MODIFIED="1405579137967" TEXT="#define ifr_flags          ifr_ifru.ifru_flags    /* flags&#x9;&#x9;*/"/>
<node CREATED="1405578525601" ID="ID_1330956181" MODIFIED="1405579154843" TEXT="#define ifr_metric        ifr_ifru.ifru_ivalue    /* metric&#x9;&#x9;*/"/>
<node CREATED="1405578536914" ID="ID_439898075" MODIFIED="1405579213401" TEXT="#define ifr_mtu            ifr_ifru.ifru_mtu    /* mtu&#x9;&#x9;&#x9;*/"/>
<node CREATED="1405578549519" ID="ID_1719570702" MODIFIED="1405579237190" TEXT="#define ifr_map           ifr_ifru.ifru_map    /* device map&#x9;&#x9;*/"/>
<node CREATED="1405578561456" ID="ID_538031929" MODIFIED="1405579249670" TEXT="#define ifr_slave          ifr_ifru.ifru_slave    /* slave device&#x9;&#x9;*/"/>
<node CREATED="1405578574144" ID="ID_801302423" MODIFIED="1405579256061" TEXT="#define ifr_data           ifr_ifru.ifru_data    /* for use by interface&#x9;*/"/>
<node CREATED="1405578586208" ID="ID_155440869" MODIFIED="1405579261311" TEXT="#define ifr_ifindex        ifr_ifru.ifru_ivalue    /* interface index&#x9;*/"/>
<node CREATED="1405578598896" ID="ID_705195082" MODIFIED="1405579270450" TEXT="#define ifr_bandwidth  ifr_ifru.ifru_ivalue    /* link bandwidth&#x9;*/"/>
<node CREATED="1405578612514" ID="ID_378107448" MODIFIED="1405579283777" TEXT="#define ifr_qlen            ifr_ifru.ifru_ivalue    /* Queue length &#x9;*/"/>
<node CREATED="1405578626193" ID="ID_1572181704" MODIFIED="1405579305394" TEXT="#define ifr_newname    ifr_ifru.ifru_newname    /* New name&#x9;&#x9;*/"/>
<node CREATED="1405578637888" ID="ID_454150948" MODIFIED="1405579313798" TEXT="#define ifr_settings      ifr_ifru.ifru_settings    /* Device/proto settings*/"/>
</node>
</node>
</node>
</node>
<node CREATED="1321709738877" FOLDED="true" ID="ID_1894967144" MODIFIED="1447184575618" POSITION="right" TEXT="&#x5185;&#x6838;&#x63a5;&#x53e3;">
<node CREATED="1321709750388" FOLDED="true" ID="ID_1669556970" MODIFIED="1387853663329" TEXT="&#x7cfb;&#x7edf;&#x8c03;&#x7528;socket&#xa;net/socket.c">
<node CREATED="1321709875686" ID="ID_920934578" MODIFIED="1321709908215" TEXT="1, &#x4ece;&#x4f20;&#x5165;&#x7684;type&#x4e2d;&#x5206;&#x79bb;&#x51fa;type&#x548c;flags"/>
<node CREATED="1321709919044" FOLDED="true" ID="ID_31082771" MODIFIED="1359869954927" TEXT="2, sock_create">
<node CREATED="1321711745492" ID="ID_1200091778" MODIFIED="1321711751227" TEXT="1, security_socket_create"/>
<node CREATED="1321711817374" ID="ID_1445138444" MODIFIED="1321711876942" TEXT="2, &#x8c03;&#x7528;sock_alloc&#x5206;&#x914d;&#x4e00;&#x4e2a;struct socket&#x7ed3;&#x6784;&#xff0c;&#x5b83;&#x5df2;&#x8ddf;inode&#x7ed1;&#x5b9a;&#x5728;&#x4e00;&#x8d77;"/>
<node CREATED="1321712239940" ID="ID_1034312783" MODIFIED="1321712352173" TEXT="3, &#x5982;&#x679c;&#x5728;net_families&#x4e2d;&#x627e;&#x4e0d;&#x5230;&#x5bf9;&#x5e94;&#x7684;family&#xa;&#x5219;&#x8c03;&#x7528;request_module&#x52a0;&#x8f7d;&#x5bf9;&#x5e94;&#x7684;&#x5185;&#x6838;&#x6a21;&#x5757;"/>
<node CREATED="1321712505610" ID="ID_1903727616" MODIFIED="1321712518653" TEXT="4, &#x8c03;&#x7528;struct net_proto_family&#x7684;create&#x51fd;&#x6570;"/>
<node CREATED="1321712546089" ID="ID_1672956393" MODIFIED="1321712550091" TEXT="5, security_socket_post_create"/>
</node>
<node CREATED="1321709933007" FOLDED="true" ID="ID_274085640" MODIFIED="1321711416157" TEXT="3, &#x8c03;&#x7528;sock_map_fd&#x5efa;&#x7acb;&#x6587;&#x4ef6;&#x4e0e;socket&#x4e4b;&#x95f4;&#x7684;&#x6620;&#x5c04;">
<node CREATED="1321710405352" ID="ID_1610275435" MODIFIED="1321710428479" TEXT="1, &#x8c03;&#x7528;sock_alloc_fd&#x5206;&#x914d;&#x6587;&#x4ef6;&#x63cf;&#x8ff0;&#x7b26;"/>
<node CREATED="1321710600516" FOLDED="true" ID="ID_868248272" MODIFIED="1321711416156" TEXT="2, &#x8c03;&#x7528;sock_attach_fd&#x5c06;&#x6587;&#x4ef6;&#x548c;socket&#x76f8;&#x4e92;&#x5173;&#x8054;&#x8d77;&#x6765;">
<node CREATED="1321710664094" ID="ID_1195821097" MODIFIED="1321710667566" TEXT="sock-&gt;file = file"/>
<node CREATED="1321710803597" ID="ID_556985216" LINK="#ID_1996083594" MODIFIED="1321710930102" TEXT="file-&gt;f_op = &amp;socket_file_ops"/>
</node>
<node CREATED="1321711368116" ID="ID_926279704" MODIFIED="1321711381736" TEXT="3, &#x8c03;&#x7528;fd_install&#x5b89;&#x88c5;&#x6587;&#x4ef6;"/>
</node>
<node CREATED="1321711433242" ID="ID_1353812429" MODIFIED="1321711447599" TEXT="4, &#x8fd4;&#x56de;&#x6587;&#x4ef6;&#x63cf;&#x8ff0;&#x7b26;"/>
</node>
</node>
<node CREATED="1321710851621" FOLDED="true" ID="ID_1982401970" MODIFIED="1447184573481" POSITION="right" TEXT="&#x91cd;&#x8981;&#x5168;&#x5c40;&#x53d8;&#x91cf;">
<node CREATED="1321710919229" FOLDED="true" ID="ID_1996083594" MODIFIED="1321712583016" TEXT="struct file_operations socket_file_ops&#xa;net/socket.c">
<node CREATED="1321711013941" ID="ID_931293661" MODIFIED="1321711027969" TEXT=".aio_read = sock_aio_read"/>
<node CREATED="1321711044014" ID="ID_900632285" MODIFIED="1321711049134" TEXT=".aio_write = sock_aio_write"/>
<node CREATED="1321711062781" ID="ID_984904626" MODIFIED="1321711069208" TEXT=".poll = sock_poll"/>
<node CREATED="1321711086572" ID="ID_944569048" MODIFIED="1321711088456" TEXT=".unlocked_ioctl = sock_ioctl"/>
<node CREATED="1321711100516" ID="ID_1484640890" MODIFIED="1321711102885" TEXT=".compat_ioctl = compat_sock_ioctl"/>
<node CREATED="1321711117792" ID="ID_1853283311" MODIFIED="1321711123288" TEXT=".mmap = sock_mmap"/>
<node CREATED="1321711143990" ID="ID_936687064" MODIFIED="1321711149440" TEXT=".release = sock_close"/>
<node CREATED="1321711162998" ID="ID_1532759411" MODIFIED="1321711167804" TEXT=".fasync = sock_fasync"/>
<node CREATED="1321711181975" ID="ID_1774150356" MODIFIED="1321711187916" TEXT=".sendpage = sock_sendpage"/>
<node CREATED="1321711203781" ID="ID_309712406" MODIFIED="1321711211121" TEXT=".splice_read = sock_splice_read"/>
</node>
<node CREATED="1321712584807" FOLDED="true" ID="ID_1847983297" MODIFIED="1359869954932" TEXT="struct net_proto_family *net_families&#xa;&#x6b64;&#x53d8;&#x91cf;&#x7531;&#x5404;&#x6a21;&#x5757;&#x8c03;&#x7528;sock_register&#x6ce8;&#x518c;&#x5f62;&#x6210;">
<node CREATED="1321712619020" ID="ID_751406328" MODIFIED="1321712640486" TEXT="family &#xff1a;&#x534f;&#x8bae;&#x65cf;"/>
<node CREATED="1321712653178" ID="ID_1565174652" MODIFIED="1321712671902" TEXT="create &#xff1a;socket&#x521b;&#x5efa;&#x51fd;&#x6570;"/>
<node CREATED="1321712680964" ID="ID_1117333728" MODIFIED="1321712690327" TEXT="owner &#xff1a; &#x6240;&#x5c5e;&#x6a21;&#x5757;"/>
</node>
</node>
</node>
</map>
